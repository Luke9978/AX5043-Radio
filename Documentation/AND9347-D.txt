AND9347/D
AX5043 Programming
Manual
Advances High Performance ASK and
FSK Narrow-Band Transceiver for
                                                                                            www.onsemi.com
27−1050 MHz Range
OVERVIEW                                                                              APPLICATION NOTE
   AX5043 is a true single chip low-power CMOS
transceiver for narrow band applications. A fully integrated
VCO supports carrier frequencies in the 433 MHz,
868 MHz and 915 MHz ISM band. An external VCO
inductor enables carrier frequencies from 27 MHz to
1050 MHz. The on-chip transceiver consists of a fully            An on-chip low power oscillator as well as Wake-on-radio
integrated RF front-end with modulator, and demodulator.         enable very low power standby applications. The AX5043
Base band data processing is implemented in an advanced          is also available with the AX8052F100 microcontroller in
and flexible communication controller that enables user          a single integrated circuit as the AX8052F143. Figure 1
friendly communication via the SPI interface.                    shows the block diagram of the AX5043.
                                                  Figure 1. Block Diagram
 © Semiconductor Components Industries, LLC, 2017             1                                     Publication Order Number:
 February, 2017 − Rev. 4                                                                                          AND9347/D
                                                                              AND9347/D
TABLE OF CONTENTS
Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
FIFO Operation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
Programming the Chip . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
Register Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
Register Details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
                                                                          www.onsemi.com
                                                                                         2
                                                                                                   AND9347/D
Connecting the AX5043 to an AX8052F100 or other                                                                    In frame mode, the internal communication controller
Microcontroller                                                                                                 performs frame delimiting, and data is received and
   The AX5043 can easily be connected to an AX8052F100                                                          transmitted via a 256 Byte FIFO, accessible via the register
or any other microcontroller. The microcontroller                                                               file. The FIFO is shared between receive and transmit.
communicates with the AX5043 via a register file that is                                                        Figure 2 shows the corresponding diagram. Connecting the
implemented in the AX5043 and that can be accessed                                                              interrupt line is highly recommended, though not strictly
serially via an industry standard Serial Peripheral Interface                                                   required. With the AX8052F100, it is also recommended to
(SPI) protocol.                                                                                                 connect the SYSCLK line. This allows the Microcontroller
   Reset is performed by the integrated power-on-reset                                                          to run from the precise crystal clock of the AX5043, or to
(POR) block and can be performed manually via the register                                                      calibrate its internal oscillators from against this clock.
file.
   The AX5043 sends and receives data via the SPI port in
frames. This standard operation mode is called frame mode.
                                                                                                                      PA5/ADC5/IC0/U1TX/COMPI10   PA4/ADC4/T1CLK/COMPO0/LPXTA                            PA2/ADC2/OC0/U1RX/COMPI00   PA1/ADC1/T0CLK/OC1/XTALP
                                                                                                                                                                                PA3/ADC3/T1OUT/LPXTALP                                                          PA0/ADC0/T0OUT/IC1/XTALN
               CLK16P   CLK16N   GPADC2   GPADC1          VDD_IO
                                                   NC              NC
                                                                                                                                                                                                                                                                                           VDD_IO
               28       27 26             25 24 23                 22
                                                                                   ANTSEL
 VDD_ANA 1                                                                    21
                                                                                                                     28                           27 26                                                  25 24 23                                                                          22
                                                                                   PWRAMP
     GND   2                                                                  20
    ANTP   3                                                                  19
                                                                                   IRQ      IRQ      RIRQ/PR5    1                                                                                                                                                                                         21 RESET_N
                                                                                   NC               VDD_CORE
    ANTN   4             AX5043                                               18                                 2                                                                                                                                                                                         20 DBG_EN
   ANTP1   5                                                                  17
                                                                                   MOSI MOSI RMOSI/PR4           3   AX8052F100                                                                                                                                                                            19 PB7/DBG_CLK
                                                                                   MISO MISO
     GND   6                                                                  16                RMISO/PR3        4        or                                                                                                                                                                               18 PB6/DBG_DATA
                                                                                        CLK
                                                                                                                       other mC
                                                                                   CLK           RCLK/PR2        5                                                                                                                                                                                         17 PB5/U0RX/T1OUT
 VDD_ANA 7                                                                    15
                                                                                        SEL      RSEL/PR0        6                                                                                                                                                                                         16 PB4/U0TX/T1CLK
                8       9        10       11 12 13                 14                  SYSCLK RSYSCLK/PR1        7                                                                                                                                                                                         15 PB3/OC0/T2CLK/EXTIRQ1/DSWAKE
                                                   DCLK
                                                          SYSCLK
               FILT
                        L2
                                                                        SEL
                                 L1
                                          DATA
                                                                                                                         8                           9                          10                       11 12 13                                                                          14
                                                                                                                      OMPO0/U0RX/SMISO/PC3                                                               XTIRQ0/T0OUT/SSEL/PC0
                                                                                                                                                  U0TX/SMOSI/PC2
                                                                                                                                                                                                                                     EXTIRQ0/IC1/U1TX/PB0
                                                                                                                                                                                OMPO1/T0CLK/SSCK/PC1
                                                                                                                                                                                                                                                                 OC1/U1RX/PB1              T2OUT/IC0/PB2
                                                                   Figure 2. Connecting AX5043 to AX8052F100 or other mC
                                                                                                  www.onsemi.com
                                                                                                          3
                                            AND9347/D
Pin Function Descriptions
Table 1. PIN FUNCTION DESCRIPTION
       Symbol                Pin(s)   Type                                     Description
      VDD_ANA                  1        P    Analog power output, decouple to neighboring GND
         GND                   2        P    Ground, decouple to neighboring VDD_ANA
        ANTP                   3        A    Differential antenna input/output
        ANTN                   4        A    Differential antenna input/output
        ANTP1                  5        A    Single-ended antenna output
         GND                   6        P    Ground, decouple to neighboring VDD_ANA
      VDD_ANA                  7        P    Analog power output, decouple to neighboring GND
         FILT                  8        A    Optional synthesizer filter
           L2                  9        A    Optional synthesizer inductor
           L1                  10       A    Optional synthesizer inductor
         DATA                  11      I/O   In wire mode: Data in-out/output
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
        DCLK                   12      I/O   In wire mode: Clock output
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
       SYSCLK                  13      I/O   Default functionality: Crystal oscillator (or divided) clock output
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
         SEL                   14        I   Serial peripheral interface select
         CLK                   15        I   Serial peripheral interface clock
        MISO                   16       O    Serial peripheral interface data output
        MOSI                   17        I   Serial peripheral interface data input
           NC                  18       N    Must be left unconnected
          IRQ                  19       O    Default functionality: Transmit and receive interrupt
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
      PWRAMP                   20      I/O   Default functionality: Power amplifier control output
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
       ANTSEL                  21      I/O   Default functionality: Diversity antenna selection output
                                             Can be programmed to be used as a general purpose I/O pin
                                             Selectable internal 65 kΩ pull-up resistor
           NC                  22       N    Must be left unconnected
       VDD_IO                  23       P    Power supply 1.8 V – 3.6 V
           NC                  24       N    Must be left unconnected
       GPADC1                  25       A    GPADC input
       GPADC2                  26       A    GPADC input
       CLK16N                  27       A    Crystal oscillator input/output
       CLK16P                  28       A    Crystal oscillator input/output
         GND               Center Pad   P    Ground on center pad of QFN, must be connected
  A = analog signal                                         All digital inputs are Schmitt trigger inputs, digital input
  I = digital input signal                               and output levels are LVCMOS/LVTTL compatible and 5 V
  O = digital output signal                              tolerant.
  I/O = digital input/output signal
  N = not to be connected
  P = power or ground
                                           www.onsemi.com
                                                    4
                                                                AND9347/D
SPI Register Access                                                        waveforms are compatible to most hardware SPI master
  Registers are accessed via a synchronous Serial Peripheral               controllers, and can easily be generated in software. MISO
Interface (SPI). Most Registers are 8 bits wide and accessed               changes on the falling edge of CLK, while MOSI is latched
using the waveforms as detailed in Figure 3. These                         on the rising edge of CLK.
        SS
       SCK
      MOSI   R/W    1    1     1  A11   A10  A9    A8  A7   A6    A5  A4   A3    A2    A1   A0    D7   D6  D5  D4   D3   D2  D1  D0
      MISO         S14  S13   S12  S11  S10   S9   S8   S7   S6   S5  S4    S3   S2    S1   S0    D7   D6  D5  D4    D3  D2  D1  D0
                                        Figure 3. SPI 8bit Long Address Read/Write Access
  The most important registers are at the beginning of the                 registers can be accessed more efficiently using the short
address space, i.e. at addresses less than 0x70. These                     address form, which is detailed in Figure 4.
                                                 Figure 4. SPI 8bit Read/Write Access
  Some registers are longer than 8 bits. These registers can               bytes can be continued as long as desired. After each byte,
be accessed more quickly than by reading and writing                       the address counter is incremented by one. Also, this access
individual 8 bit parts. This is illustrated in Figure 5. Accesses          form also works with long addresses.
are not limited by 16 bits either, reading and writing data
       SS
      SCK
     MOSI   R/W   A6   A5     A4  A3    A2   A1   A0   D7   D6   D5   D4   D3    D2    D1   D0    D7   D6  D5  D4    D3   D2  D1  D0
     MISO         S14  S13   S12  S11   S10  S9    S8  D7   D6    D5  D4   D3    D2    D1    D0    D7   D6  D5  D4    D3  D2  D1  D0
                                                                         A                                        A+1
                                                 Figure 5. SPI 16bit Read/Write Access
  During the address phase of the access, the chip outputs                 handler. The table below shows which register bit is
the most important status bits. This feature is designed to                transmitted during the status timeslots.
speed up software decision on what to do in an interrupt
 Table 2. SPI STATUS BITS
   SPI Bit Cell        Status                                                       Register Bit
         0                 −          1 (when transitioning out of deep sleep, this bit transitions from 0→1 when the power becomes ready)
         1               S14          PLL LOCK
         2               S13          FIFO OVER
         3               S12          FIFO UNDER
         4               S11          THRESHOLD FREE ( FIFO Free > FIFO threshold)
         5               S10          THRESHOLD COUNT (FIFO count > FIFO threshold)
         6                 S9         FIFO FULL
         7                 S8         FIFO EMPTY
         8                 S7         PWRGOOD (not BROWNOUT)
         9                 S6         PWR INTERRUPT PENDING
        10                 S5         RADIO EVENT PENDING
        11                 S4         XTAL OSCILLATOR RUNNING
                                                             www.onsemi.com
                                                                       5
                                                            AND9347/D
 Table 2. SPI STATUS BITS (continued)
   SPI Bit Cell         Status                                            Register Bit
        12                S3       WAKEUP INTERRUPT PENDING
        13                S2       LPOSC INTERRUPT PENDING
        14                S1       GPADC INTERRUPT PENDING
        15                S0       undefined
   Note that bit cells 8−15 (S7...S0) are only available in two      Address Space
address byte SPI access formats.                                      The address space has been allocated as follows.
                                                                   Addresses from 0x000 to 0x06F are reserved for “dynamic
Deep Sleep                                                         registers”, i.e. registers that are expected to be frequently
   The chip can be programmed into deep sleep mode. In             accessed during normal operation, as they can be efficiently
deep sleep mode, the chip is completely switched off, which        accessed using single address byte SPI accesses. Addresses
results in very low leakage power. All registers loose their       from 0x070 to 0x0FF have been left unused (they could only
programming.                                                       be accessed using the two address byte SPI format).
   To enter deep sleep mode, write the deep sleep encoding         Addresses from 0x100 to 0x1FF have been reserved for
into bits 3:0 of PWRMODE. At the rising edge of the SEL            physical layer parameter registers, for example receiver,
line, the chip will enter deep sleep mode.                         transmitter, PLL, crystal oscillator. Adresses from 0x200 to
   To exit deep sleep mode, lower the SEL line. This will          0x2FF have been reserved for medium access parameters,
initiate startup and reset of the chip. Then poll the MISO         such as framing, packet handling. Addresses from 0x300 to
line. The MISO line will be held low during initialization,        0x3FF have been reserved for special functions, such as
and will rise to high at the end of the initialization, when the   GPADC.
chip becomes ready for further operation.
                                                         www.onsemi.com
                                                                 6
                                                            AND9347/D
FIFO OPERATION
   The AX5043 features a 256 Byte FIFO. The same FIFO                receiver. Writing the ROLLBACK command to the
is used for both reception and transmission. During transmit,        FIFOSTAT register sets the write ahead pointer to the write
only the write port is accessible by the microcontroller.            pointer, thus discarding data written to the FIFO. During
During receive, only the read port is accessible by the              transmit, this means that the transmitter will only consider
microcontroller. Otherwise, both ports are accessible                data written to the FIFO after the commit command. During
through the register file.                                           receive, this feature is used by the receiver to store packet
   In order to prevent transmitting premature data, the FIFO         data before it is known whether the CRC check passes.
contains three pointers. Data is read at the read pointer, up        FIFOCOUNT reports the number of bytes that can be read
to the write pointer. Data is written to the write ahead pointer.    without causing an underflow. FIFOFREE reports the
The write pointer is not updated when data is written,               number of bytes that can be written without causing an
therefore, new data is not immediately visible to the                overflow. FIFOCOUNT and FIFOFREE do not add up to
consumer. Writing the COMMIT command to the                          256 Bytes whenever there are uncommitted bytes in the
FIFOSTAT register copies the write ahead pointer to the              FIFO. Figure 6 illustrates this.
write pointer, thus making the written data visible to the
                        Write ahead pointer
                               Write pointer
                                                                                      256−FIFOFREE
                                    FIFOCOUNT
                                                                                          Read pointer
                                                       Figure 6. FIFO Pointer
FIFO Chunk Encoding                                                                    7   6   5   4   3   2   1  0
   In order to distinguish meta-data (such as RSSI) from
receive or transmit data, FIFO contents are organized as
chunks. Chunks consist of a header that encodes the chunk
length as well as the payload data format.                                               Chunk           Chunk
                                                                                        payload         payload
   Each chunk starts with a single byte header. The header                                size        data format
encodes the length of a chunk, and indicates the data it
contains. The top 3 bits encode the length (or optionally refer                  Figure 7. FIFO Header byte Format
to an additional length byte after the header byte), and the
bottom 5 bits indicate what payload data the chunk contains.            The following table lists the chunk payload size encoding:
The following table lists the encoding of the length bits (top
3 bits of the first chunk header byte). Figure 7 shows the
chunk header byte encoding.
 Table 3. CHUNK PAYLOAD SIZE ENCODING
            Top Bits                                                    Chunk Payload Size
               000                 No payload
               001                 Single byte payload
               010                 Two byte payload
               011                 Three byte payload
                                                          www.onsemi.com
                                                                  7
                                                          AND9347/D
 Table 3. CHUNK PAYLOAD SIZE ENCODING (continued)
            Top Bits                                                     Chunk Payload Size
              100              Invalid
              101              Invalid
              110              Invalid
              111              Variable length payload; payload size is encoded in the following length byte the length byte is part of
                               the header (and not included in length), everything after the length byte is included in the length
  The following table lists the chunk types and their                 RSSI Command
encodings. The Hdr Byte column lists the complete FIFO                 Table 6. RSSI COMMAND
Chunk Header Byte, consisting of the length and data format
                                                                          7       6        5        4         3       2        1      0
encodings.
                                                                          0       0        0        0         0       0        0      0
 Table 4. CHUNK TYPES AND THEIR ENCODINGS                                                             RSSI
     Name          Dir  Hdr. Byte          Description
                                                                         The RSSI command will only be generated by the receiver
                           7−0
                                                                      at the end of a packet if bit STRSSI is set in register
 No Payload Commands
                                                                      PKTSTOREFLAGS. The encoding is the same as that of the
 NOP             T     00000000     No Operation                      RSSI register.
 One Byte Payload Commands
 RSSI            R     00110001     RSSI                              TXCTRL Command
 TXCTRL          T     00111100     Transmit Control                   Table 7. TXCTRL COMMAND
                                    (Antenna, Power Amp)
                                                                          7       6        5        4         3       2        1      0
 Two Byte Payload Commands
                                                                          0       0        1        1         1       1        0      0
 FREQOFFS        R     01010010     Frequency Offset
                                                                          0     SETT     TXSE     TXDI     SETA    ANTS      SETP  PAST
 ANTRSSI2        R     01010101     Background Noise                              X                FF        NT    TATE        A    ATE
                                    Calculation RSSI
 Three Byte Payload Commands                                             The TXCTRL command allows certain aspects of the
 REPEATDATA T          01100010     Repeat Data                       transmitter to be changed on the fly. If SETTX is set, TXSE
 TIMER           R     01110000     Timer                             and TXDIFF are copied into the register MODCFGA. If
 RFFREQOFFS R          01110011     RF Frequency Offset
                                                                      SETANT is set, ANTSTATE is copied into register
                                                                      DIVERSITY. If SETPA is set, PASTATE is copied into
 DATARATE        R     01110100     Datarate
                                                                      register PWRAMP.
 ANTRSSI3        R     01110101     Antenna Selection RSSI
 Variable Length Payload Commands                                     FREQOFFS Command
 DATA            TR    11100001     Data
                                                                       Table 8. FREQOFFS COMMAND
 TXPWR           T     11111101     Transmit Power
                                                                          7       6        5        4         3       2        1      0
  Direction: T = Transmit, R = Receive                                    0       1        0        1         0       0        1      0
                                                                                                  FREQOFFS1
NOP Command                                                                                       FREQOFFS0
 Table 5. NOP COMMAND
                                                                         The FREQOFFS command will only be generated by the
   7       6       5     4       3        2      1        0
                                                                      receiver at the end of a packet if bit STFOFFS is set in
   0       0       0     0       0        0      0        0           register PKTSTOREFLAGS. The encoding is the same as
                                                                      that of the TRKFREQ register.
  The NOP command will be discarded without effect by
the transmitter. The receiver will not generate NOP
commands.
                                                       www.onsemi.com
                                                                  8
                                                         AND9347/D
ANTRSSI2 Command
 Table 9. ANTRSSI2 COMMAND
    7      6       5       4      3         2   1       0             The ANTRSSI2 command will be generated by the
    0      1       0       1      0         1   0       1
                                                                   receiver when it is idle if bit STANTRSSI is set in register
                                                                   PKTSTOREFLAGS. If DIVENA is set in register
                             RSSI
                                                                   DIVERSITY, the ANTRSSI3 command is generated
                         BGNDNOISE                                 instead. The encoding of the RSSI field is the same as that
                                                                   of the RSSI register. The BGNDNOISE field contains an
                                                                   estimate of the background noise.
REPEATDATA Command
 Table 10. REPEATDATA COMMAND
        7               6                 5            4                3               2                1              0
        0               1                 1            0                0               0                1              0
        0               0             UNENC          RAW            NOCRC           RESIDUE          PKTEND        PKTSTART
                                                          REPEATCNT
                                                              DATA
   The REPEATDATA command allows the efficient                     DATARATE Command
transmission of repetitive data bytes. The DATA byte given          Table 13. DATARATE COMMAND
in the payload is repeated REPEATCNT times. See DATA
                                                                       7       6      5       4       3      2       1      0
command for a description of the flag byte. This command
is especially handy for constructing preambles.                        0       1     1        1       0      1       0      0
                                                                                            DATARATE2
TIMER Command
                                                                                            DATARATE1
 Table 11. TIMER COMMAND
                                                                                            DATARATE0
    7      6       5       4      3         2   1       0
    0      1       1       1      0         0   0       0             The DATARATE command will only be generated by the
                            TIMER2                                 receiver at the end of a packet if bit STDR is set in register
                            TIMER1
                                                                   PKTSTOREFLAGS. The encoding is the same as that of the
                                                                   TRKDATARATE register.
                            TIMER0
                                                                   ANTRSSI3 Command
   The TIMER command will only be generated by the                  Table 14. ANTRSSI3 COMMAND
receiver at the start of a packet if bit STTIMER is set in
                                                                       7       6      5       4       3      2       1      0
register PKTSTOREFLAGS. The payload is a copy of the
                                                                       0       1     1        1       0      1       0      1
μs timer TIMER register. This command enables exact
packet timing for example for frequency hopping systems.                                    ANTORSSI2
                                                                                            ANTORSSI1
RFFREQOFFS Command
                                                                                            ANTORSSI0
 Table 12. RFFREQOFFS COMMAND
    7      6       5       4      3         2   1       0             The ANTRSSI3 command will be generated by the
    0      1       1       1      0         0   1       1          receiver when it is idle if bit STANTRSSI is set in register
                        RFFREQOFFS2                                PKTSTOREFLAGS. If DIVENA is not set in register
                        RFFREQOFFS1
                                                                   DIVERSITY, the ANTRSSI2 command is generated
                                                                   instead. The encoding of the ANT0RSSI and ANT1RSSI
                        RFFREQOFFS0
                                                                   fields are the same as that of the RSSI register.
                                                                   The BGNDNOISE field contains an estimate of the
   The RFFREQOFFS command will only be generated by                background noise.
the receiver at the end of a packet if bit STRFOFFS is set in
register PKTSTOREFLAGS. The encoding is the same as                DATA Command
that of the TRKRFFREQ register.                                       The DATA command transports actual transmit and
                                                                   receive data. While the basic format is the same for transmit
                                                                   and receive, the semantics of the flag byte differs.
                                                     www.onsemi.com
                                                               9
                                                               AND9347/D
 Table 15. TRANSMIT DATA FORMAT
        7                6                5                  4                  3                2                1              0
        1                1                1                  0                  0                0                0              1
                                                                   LENGTH
        0                0             UNENC               RAW              NOCRC            RESIDUE         PKTEND         PKTSTART
                                                                     DATA
   LENGTH includes the flags byte as well as all DATA                      is reversed, i.e. the lowest bit set is considered the stop bit
bytes.                                                                     and bits above the stop bit are transmitted.
   Setting RAW to one causes the DATA to bypass the                           PKTSTART and PKTEND bits enable the transmission of
framing mode, but still pass through the encoder.                          packets that are larger than the FIFO size. If PKTSTART is
   Setting UNENC to one causes the DATA to bypass the                      set, the radio packet starts at the beginning of the DATA
framing mode, as well as the encoder, except for inversion.                command payload. If PKTEND is set, the radio packet ends
UNENC has priority over RAW.                                               at the end of the DATA command payload. If PKTSTART is
   Setting NOCRC suppresses the generation of the CRC                      not set, this command is the continuation of a previous
bytes.                                                                     DATA command. If PKTEND is not set, the packet is
   Setting RESIDUE allows the transmission of a number of                  continued with the next DATA command.
data bits that is not a multiple of eight. All but the last data              PKTSTART in RAW mode causes the DATA bytes to be
byte are transmitted as if RESIDUE was not set. The last                   aligned to DiBit boundaries in 4−FSK mode.
byte however contains only 7 bits or less. The transmitter                    For example, to transmit 20 bits of an alternating 0−1
looks for the highest bit set. This is considered the stop bit.            pattern as a preamble, the following bytes should be written
Only bits below the stop bit are transmitted. If the                       to the FIFO (MSBFIRST = 0 in register PKTADDRCFG is
MSBFIRST in register PKTADDRCFG is set, the algorithm                      assumed):
 Table 16. FIFO COMMAND
              0xE1                FIFO Command
              0x04                Length Byte
              0x24                Flag Byte: Unencoded, to ensure 0−1 remains 0−1, and Residue set, because the number of bits
                                  transmitted is not a multiple of 8
              0xAA                Alternating 0−1 bits
              0xAA                Alternating 0−1 bits
              0x1A                Alternating 0−1 bits; Bit 4 is the “Stop” bit
 Table 17. RECEIVE DATA FORMAT
        7                6                5                  4                  3                2                1              0
        1                1                1                  0                  0                0                0              1
                                                                   LENGTH
        0             ABORT           SIZEFAIL         ADDRFAIL             CRCFAIL          RESIDUE         PKTEND         PKTSTART
                                                                     DATA
   ABORT is set if the packet has been aborted. An ABORT                   PKTADDRCFG, PKTADDR and PKTADDRMASK
sequence is a sequence of seven or more consecutive one bits               registers. Note that if ACCPTADDRF is not set in register
when HDLC [1] framing is used. Note that if ACCPTABRT                      PKTACCEPTFLAGS, then packets which do not match the
is not set in register PKTACCEPTFLAGS, then aborted                        programmed address are silently dropped.
packets are silently dropped.                                                 CRCFAIL is set if the packet does not pass the CRC check.
   SIZEFAIL is set if the packet does not pass the size                    Note that if ACCPTCRCF is not set in register
checks. Size checks are implemented using the                              PKTACCEPTFLAGS, then packets which fail the CRC
PKTLENCFG, PKTLENOFFSET and PKTMAXLEN                                      check are silently dropped.
registers. Note that if ACCPTSZF is not set in register                       RESIDUE, PKTEND and PKTSTART work identical as
PKTACCEPTFLAGS, then packets with an invalid size are                      in transmit mode, see above.
silently dropped.                                                             The receiver generates chunks up to PKTCHUNKSIZE
   ADDRFAIL is set if the packet does not pass the address                 bytes. If PKTMAXLEN is larger than PKTCHUNKSIZE,
checks. Address checks are implemented using the                           multiple chunks may be generated for one packet. Since
                                                            www.onsemi.com
                                                                      10
                                                         AND9347/D
CRC and size checks may only be performed at the end of            The TXPWR command allows the transmit power to be
the packet, only the last chunk can be dropped at failure of     changed on the fly. This command updates the
one of those tests. It is therefore important that the           TXPWRCOEFFA, TXPWRCOEFFB, TXPWRCOEFFC,
microcontroller receiver routine clears its receive buffer at    TXPWRCOEFFD and TXPWRCOEFFE registers.
the beginning of DATA commands whose PKTSTART bit
is set, as the buffer may still contain bytes from erroneous
packets.
TXPWR Command
 Table 18. TXPWR COMMAND
    7       6       5      4       3      2      1      0
    1       1       1      1       0      0      1      0
                         LENGTH = 10
                      TXPWRCOEFFA (7:0)
                      TXPWRCOEFFA (15:8)
                      TXPWRCOEFFB (7:0)
                     TXPWRCOEFFB (15:8)
                      TXPWRCOEFFC (7:0)
                     TXPWRCOEFFC (15:8)
                      TXPWRCOEFFD (7:0)
                     TXPWRCOEFFD (15:8)
                      TXPWRCOEFFE (7:0)
                     TXPWRCOEFFE (15:8)
                                                      www.onsemi.com
                                                              11
                                                          AND9347/D
PROGRAMMING THE CHIP
Power Modes                                                           when not needed. This is controlled by the PWRMODE
  To enable the lowest possible application power                     register. Idd values are typical; for exact values, please refer
consumption, the AX5043 allows to shut down its circuits              to the AX5043 datasheet [2].
 Table 19. PWRMODE REGISTER STATES
   PWRMODE register               Name                                        Description                               Typical Idd
          0000               POWERDOWN          Powerdown; all circuits powered down except for the register file          400 nA
          0001                 DEEPSLEEP        Deep Sleep Mode; Chip is fully powered down until SEL is lowered            50 nA
                                                again; looses all register contents
          0101                  STANDBY         Crystal Oscillator enabled                                                 230 μA
          0111                   FIFOON         FIFO and Crystal Oscillator enabled                                        310 μA
          1000                  SYNTHRX         Synthesizer running, Receive Mode                                           5 mA
          1001                   FULLRX         Receiver Running                                                          7-11 mA
          1011                   WORRX          Receiver Wake-on-Radio Mode                                                500 nA
          1100                  SYNTHTX         Synthesizer running, Transmit Mode                                          5 mA
          1101                   FULLTX         Transmitter Running                                                       6−70 mA
  The following list explains the typical programming flow.           mode, the FIFO is automatically kept powered until it is
  Preparation:                                                        emptied by the microprocessor.
     1. Reset the Chip. Set SEL to high for at least 1μs,                In the transmit case, PWRMODE should first be set to
        then low. Wait until MISO goes high. Set, and then            FULLTX. Before writing to the FIFO, the microprocessor
        clear, the RST bit of register PWRMODE.                       must ensure that the SVMODEM bit is high in Register
     2. Set the PWRMODE register to POWERDOWN.                        POWSTAT, to ensure that the on-chip voltage regulator
     3. Program parameters. It is recommended that                    supplying the FIFO has finished starting up. The transmitter
        suitable parameters are calculated using the                  remains idle until the contents of the FIFO are committed
        AX_RadioLab tool available from Axsem.                        (unless the FIFO AUTO COMMIT bit is set in Register
     4. Perform auto-ranging, to ensure the correct VCO               FIFOSTAT).
        range setting.
  The chip is now ready for transmit and receive operations.          Autoranging
                                                                         Whenever the frequency changes, the synthesizer VCO
FIFO Power Management                                                 should be set to the correct range using the built-in auto-
  The FIFO is powered down during POWERDOWN and                       ranging. A re-ranging of the VCO is required if the
DEEPSLEEP modes (Register PWRMODE). The FIFO                          frequency change required is larger than 5 MHz in the
EMPTY and FIFO FULL bits (Register FIFOSTAT), as well                 868/915 MHz band or 2.5 MHz in the 433 MHz band. Each
as the FIFOCOUNT and FIFOFREE registers read zero.                    individual chip must be auto-ranged. If both frequency
Reads from the FIFO will return undefined data, and writes            register sets FREQA and FREQB are used, then both
to the FIFO will be lost.                                             frequencies must be auto-ranged by first starting
  In the receive case, the FIFO is automatically powered on           auto-ranging in PLLRANGINGA, waiting for its
when the chip PWRMODE is set to FULLRX. The FIFO                      completion, followed by starting auto-ranging in
should be emptied before the PWRMODE is set to                        PLLRANGINGB and waiting for its completion.
POWERDOWN. In Wake-on-radio or POWERDOWN
                                                      www.onsemi.com
                                                                 12
                                                               AND9347/D
  Figure 8 shows the flow chart of the auto-ranging process.                 Before starting the auto-ranging, the appropriate
                                                                          frequency registers (FREQA3, FREQA2, FREQA1 and
                                                                          FREQA0 or FREQB3, FREQB2, FREQB1 and FREQB0)
                                                                          need to be programmed. Auto-ranging starts at the VCOR
                                                                          (register PLLRANGINGA or PLLRANGINGB) setting;
                 Set PWRMODE to STANDBY                                   if you already know the approximately correct synthesizer
                     Enable TCXO if used                                  VCO range, you should set VCORA/VCORB to this value
                                                                          prior to starting auto-ranging; this can speed up the ranging
                  Wait until crystal oscillator                           process considerably. If you have no prior knowledge about
                           is ready                                       the correct range, set VCORA/VCORB to 8. Starting with
                                                                          VCORA/VCORB < 6 should be avoided, as the initial
                                                                          synthesizer frequency can exceed the maximum frequency
             Set RNGSTART of PLLRANGINGA/B
                                                                          specification.
                                                                             Hardware clears the RNG START bit automatically as
                                                    yes                   soon as the ranging is finished; the device may be
                       RNGSTART = 1?                                      programmed to deliver an interrupt on resetting of the RNG
                                                                          START bit.
                                  no                                         Waiting until auto-ranging terminates can be performed
                                                yes                       by either polling the register PLLRANGINGA or
                       RNGERR = 1?                    Error               PLLRANGINGB for RNG START to go low, or by enabling
                                                                          the IRQMPLLRNGDONE interrupt in register
                                  no                                      IRQMASK1.
              Set PWRMODE to POWERDOWN
                    Disable TCXO if used                                  Choosing the Fundamental Communication
                                                                          Characteristics
                                                                             The following table lists the fundamental communication
                                                                          characteristics that need to be chosen before the device can
            Figure 8. Autoranging Flow Chart                              be programmed.
 Table 20. FUNDAMENTAL COMMUNICATION CHARACTERISTIC
          Parameter                                                               Description
 fXTAL                            Frequency of the connected crystal in Hz
 modulation                       FSK, MSK, OQPSK, 4−FSK or AFSK (for recommendations see below)
 fCARRIER                         Carrier frequency (i.e. center frequency of the signal) in Hz
 BITRATE                          Desired bit rate in bit/s
 h                                Modulation index, determines the frequency deviation for FSK
                                  32 > h ≥ 0.5 for FSK, 4−FSK or AFSK, fdeviation = 0.5 * h * BITRATE
                                  h = 0.5 for MSK and OQPSK
                                  (For AFSK, fdeviation is usually set according to the FM channel specification. For 25 kHz channels, it is
                                  often approximately 3 kHz)
 encoding                         Inversion, differential, manchester, scrambled, for recommendations see the description of the register
                                  ENCODING.
  The following table gives an overview of the trade-offs
between the different modulations that AX5043 offers, they
should be considered when making a choice.
 Table 21. TRADE-OFFS BETWEEN THE DIFFERENT MODULATION
          Modulation                                                               Trade-offs
 fXTAL                            Frequency of the connected crystal in Hz
 FSK                              For bit rates up to 125 kbit/s
                                  Frequency deviation is a free parameter
                                                            www.onsemi.com
                                                                     13
                                                             AND9347/D
 Table 21. TRADE-OFFS BETWEEN THE DIFFERENT MODULATION (continued)
           Modulation                                                              Trade-offs
  MSK                           For bit rates up to 125 kbit/s
                                Robust and spectrally efficient form of FSK (Modulation is the same as FSK with h = 0.5)
                                Frequency deviation given by bit rate
                                The advantage of MSK over FSK is that it can be demodulated with higher sensitivity.
                                Slightly longer preambles required than for FSK
  OQPSK                         For bit rates up to 125 kbit/s
                                Very similar to MSK, with added precoding / postdecoding
                                For new designs, use MSK instead
  PSK                           For bit rates up to 125 kBit/s
                                Spectrally efficient and high sensitivity
                                Very accurate frequency reference (maximum carrier frequency deviation ±1/4 ⋅ BITRATE) and long
                                preambles required
  4−FSK                         For bit rates up to 100 kSymbols/s, or 200 kbit/s
                                Similar to FSK, but four frequencies are used to transmit 2 bits simultaneously
                                Very slightly more spectrally efficient compared to FSK
                                ((1 + 3 h/2) ⋅ BITRATE versus (1 + h) ⋅ BITRATE) for small h.
                                Longer preambles required as frequency offset estimation needs to be more precise to successfully
                                demodulate
                                For new designs, use FSK instead
  AFSK                          For bit rates up to 25 kbit/s
                                Bits are FSK modulated in the audio band, then frequency modulated on the carrier frequency.
                                For legacy compatibility applications only.
   Given these fundamental physical layer parameters,                    • CRC-32 (32bit):
AX_RadioLab should be used to compute the register                              32    26      23   22    16   12   11    10   8    7    5
                                                                              x +x +x +x +x + x +x +x + x +x +
settings of the AX5043.
                                                                              x 5 + x 4 + x 2 + x + 1 (hexadecimal: 0x04C11DB7)
Framing                                                                    The CRC is always transmitted MSB first regardless of
   Figure 1 shows the block diagram of the AX5043. After                 the MSB first setting of register PKTADDRCFG, to enable
the user writes a transmit packet into the FIFO, the Radio               the receiver to process CRC bits as they arrive (otherwise,
Controller sequences the transmitter start-up, and signals the           they would have to be stored and reordered). For an in-depth
Packet Controller to read the packet from the FIFO and add               guide on how CRC’s are computed, see [3].
framing bits, allowing the receiver to lock to the transmit                Finally, the encoder is able to perform certain bit-wise
waveform, and to detect packet and byte boundaries. If MSB               operations on the bit-stream:
first is selected (register PKTADDRCFG), then the bits                   • Manchester:
within each byte are swapped when the data is read out from
                                                                            Manchester transmits a one bit as 10 and a zero bit as
the FIFO.
                                                                            01, i.e. it doubles the data rate on the radio channel. Its
   The Packet Controller also (optionally) adds cyclic
                                                                            advantage is that the resulting bit-stream has many
redundancy check bits at the end of the packet, to enable the
                                                                            transitions and thus simplifies synchronizing to the
receiver to detect transmission errors. Both 16 and 32 Bit
                                                                            transmission on the receiver side. The downside is that
CRC can be selected, as well as different generator
                                                                            it now requires twice the amount of energy for the
polynomials. The CRC polynomial can be selected in
                                                                            transmission. Manchester is not recommended, except
register FRAMING. The following polynomials are
                                                                            for compatibility with legacy systems.
supported:
• CRC-CCITT (16bit):                                                     • Scrambler:
                                                                            The scrambler ensures that even highly regular transmit
    x 16+ x 12+ x 5 +1 (hexadecimal: 0x1021)                                data results in a seemingly random transmitted
• CRC-16 (16bit):                                                           bit-stream. This avoids discrete tones in the spectrum.
      16    15    2
    x + x + x + 1 (hexadecimal: 0x8005)                                     Do not confuse the scrambler with encryption – it does
•  CRC-DNP (16bit):                                                         not provide any secrecy, its actions are easily reversed.
      16    13    12   11    10   8     6     5    2                        Its use is recommended.
     x + x + x + x + x + x + x + x + x +1
    (hexadecimal: 0x3D65)                                                • Differential:
   This polynomial is used for Wireless M-Bus.                              Differential transmits zero bits as constant level, and
                                                                            one bits as level change. This allows to accomodate
                                                         www.onsemi.com
                                                                    14
                                                           AND9347/D
   modulations that can invert the bit-stream, such as PSK.                Waiting for the crystal oscillator to start up may be
   It is available for compatibility with other Axsem                   performed by polling the register XTALSTATUS, or by
   transceivers, but usually not used on the AX5043.                    enabling the IRQMXTALREADY interrupt in register
•  Inversion:                                                           IRQMASK1.
   If on, the bit-stream is inverted. Useful for example for               After the FIFO contents are committed (writing the
   compatibility with legacy systems, such as POCSAG,                   Commit command to the FIFOSTAT register), the
   which differ from the usual convention that the higher               transmitter notices that the FIFO is no longer empty. It then
   FSK frequency signifies a one.                                       powers up the synthesizer and settles it (registers
                                                                        TMGTXBOOST and TMGTXSETTLE determine the
   The encoder is controlled using the register ENCODING.               timing). The Preamble and the Packet(s) are then
It may be temporarily bypassed except for the inversion by              transmitted, followed by the transmitter and synthesizer
setting the UNENC bit of the FIFO chunks DATA or                        shut-down.
REPEATDATA. This is useful for synthesizing preambles.                     The transmitter is automatically ramped up and down
   The receiver performs these tasks in reverse order.                  smoothly, to prevent unwanted spurious emissions. The
Transmitter                                                             ramp time is normally one bit time, but may be longer by
   Figure 9 shows the transmitter flow chart. The                       changing the SLOWRAMP field of register MODCFGA.
microprocessor first places the chip into FULLTX mode.                     The PWRMODE register should stay at FULLTX until
This prepares the chip for a future transmission, enables the           the transmission is fully completed. The end of the
FIFO in transmit direction, but does not yet power-up the               transmission may be determined by polling the register
synthesizer or any other transmit circuitry.                            RADIOSTATE until it indicates idle, or by enabling the
   The microprocessor can now write the preamble and the                radio controller interrupt (bit IRQMRADIOCTRL) in
actual packet to the FIFO. The preamble is programmable to              register IRQMASK0 and setting the radio controller to
allow standards to be implemented that specify a specific               signal an interrupt at the end of transmission (bit
preamble to be used. Otherwise, the recommendations for                 REVMDONE of register RADIOEVENTMASK0).
preambles can be found below.
                                                     Set PWRMODE to FULLTX
                                                       Enable TCXO if used
                                                      Write Preamble to FIFO
                                                       Write Packet to FIFO
                                                    Wait until crystal oscillator
                                                               is running
                                                            Commit FIFO
                                                   Wait until transmission is done
                                                 Set PWRMODE to POWERDOWN
                                                       Disable TCXO if used
                                               Figure 9. Transmitter Flow Chart
                                                        www.onsemi.com
                                                                    15
                                                          AND9347/D
Recommended Preamble                                                  MAXDROFFSET0, MAXDROFFSET1 and
   The main purpose of the preamble is to allow for the               MAXDROFFSET2 to zero). The AX5043 is able to
receiver to acquire vital transmission parameters before the          track the remaining small offset without the data rate
actual packet data starts. The minimum duration of the                offset loop. All Axsem transmitters derive the bit rate
preamble is dependent on how much time the receiver needs             timing from the crystal reference and can therefore
to acquire these parameters to sufficient precision. More             easily meet this requirement.
specifically, it depends on:                                       •  Use an FSK frequency deviation that is larger than the
• The time needed for the receiver adaptive gain control              maximum frequency offset between transmitter and
   (AGC) to acquire the signal strength.                              receiver. In this case, receiver frequency offset
• The time needed for the receiver to acquire the                     acquisition is not needed. Do not use 4−FSK.
   maximum possible frequency offset (registers                    •  Use the AX5043 receiver parameter set feature, below.
   MAXRFOFFSET0, MAXRFOFFSET1 and
                                                                      Finally, the frame synchronization word achieves byte
   MAXRFOFFSET2).
                                                                   synchronization.
• The time needed for the receiver to acquire the                     The recommended preamble bit pattern is now discussed.
   maximum possible data rate offset (registers                       If the standard to be implemented requires a specific
   MAXDROFFSET0, MAXDROFFSET1 and                                  preample, use it.
   MAXDROFFSET2).                                                     In FEC mode, HDLC [1] flags (pattern 01111110) must be
• The time needed for the receiver to acquire the exact bit        transmitted. The convolutional encoder ensures enough bit
   sampling time (registers TIMEGAIN0, TIMEGAIN1,                  transitions, and the AX5043 receiver needs flags to
   TIMEGAIN2 and TIMEGAIN3).                                       synchronize its interleaver.
• The time needed to acquire the actual frequency                     If the scrambler or manchester is enabled, send RAW
   deviation in 4−FSK mode (registers FSKDMAX0,                    bytes 00010001. The scrambler or manchester encoder
   FSKDMAX1, FSKDMIN0 and FSKDMAX0).                               ensure enough transitions to acquire the bit timing.
                                                                      In 4−FSK mode, send UNENCODED bytes 00010001.
   On the AX5043, these loops run in parallel. An AGC that
                                                                   This ensures that the preamble toggles between the highest
is significantly off however causes the received signal to fall
                                                                   and the lowest frequency. The frequent transitions ensure the
outside the IF strip dynamic range, and thus prevents the
                                                                   bit timing is acquired as quickly as possible, and the
other loops from working. And a frequency offset that is
                                                                   maximum and minimum frequencies allow the deviation to
compensated insufficiently causes the received signal to fall
                                                                   be acquired.
(partially) outside the IF filter, thus also preventing the
                                                                      Otherwise, use UNENCODED 01010101. This preamble
timing and 4−FSK loops from working.
                                                                   ensures the maximum number of transitions for bit timing
   The minimum possible preamble duration can be
                                                                   synchronization. This preamble could also be used with the
achieved under the following conditions:
                                                                   scrambler enabled; the main purpose of the scrambler is
• Use a transmitter with a sufficiently precise bit timing.        however to ensure no spectral lines (tones), this would be
   If the maximum deviation of the transmitter data rate           defeated by this preamble.
   from the receiver data rate is less than approximately             If MSBFIRST in register PKTADDRCFG is set, then the
   0.1%, then the data rate acquisition loop should be             preamble sequences should be reversed.
   switched off completely (setting registers
                                                       www.onsemi.com
                                                                16
                                                          AND9347/D
Receiver                                                           (registers TMGRXBOOST and TMGRXSETTLE
  Figure 10 shows the receiver flow chart. When the                determine the timing) and starts receiving. The reception
microprocessor places the chip into FULLRX mode, the               continues until the microprocessor changes the PWRMODE
AX5043 immediately powers up the synthesizer, settles it           register.
                       Set PWRMODE to FULLRX
                          Enable TCXO if used                                   Set PWRMODE to WORRX
                                                                             TCXO controlled by PWRAMP or
                                                                                      ANTSEL if used
                yes
                                Timeout?
                                                                                                             no
                                       no                                           Packet Received?
                                                                                     (FIFO not empty)
                                                    no
                           Packet Received?
                            (FIFO not empty)                                                     yes
                                       yes                                        Read Packet from FIFO
                         Read Packet from FIFO
                                                                                                             yes
                                                                                         Continue
                                                    yes                                 Reception?
                                Continue
                               Reception?
                                                                                                 no
                                       no
                                                                             Set PWRMODE to POWERDOWN
                    Set PWRMODE to POWERDOWN                                       Disable TCXO if used
                          Disable TCXO if used
                   Figure 10. Receiver Flow Chart                  Figure 11. Wake-on-Radio Receiver Flow Chart
  If antenna diversity is enabled, the AX5043 continuously         chart. The AX5043 periodically wakes up. The wake-up is
switches between the antennas (controlled by the ANTSEL            controlled by the on-chip low-power 640 Hz/10 kHz RC
pin) to find the antenna with the better signal strength, until    oscillator and the period is programmed using the
a valid preamble is detected. Antenna scanning is resumed          WAKEUPFREQ1 and WAKEUPFREQ0 registers.
after a packet is completed.                                          After waking up, the AX5043 quickly settles the AGC and
  Actual packet data in the FIFO may be preceded and               computes the channel RSSI. If it is below an absolute
followed by meta-data. Meta-data may be a time stamp at the        threshold (register RSSIABSTHR) and a dynamic threshold
beginning of the packet, and signal strength, frequency            (register BGNDRSSITHR), it is switched off immediately.
offset and data rate offset at the end of the packet. Which        Otherwise, it looks for a valid preamble. If none is found
meta-data is written to the FIFO is controlled by the register     within a preprogrammed time (registers TMGRXPREAM-
PKTSTOREFLAGS.                                                     BLE1 and TMGRXPREAMBLE2), the receiver is powered
  Wake-on-Radio mode allows the AX5043 to periodically             down. Otherwise, it continues to receive the packet.
poll the radio channel for a transmission while using only
very little power. Figure 11 shows the wake-on-radio flow
                                                        www.onsemi.com
                                                                17
                                                         AND9347/D
   If a packet is successfully received, the receiver may             SYNTHBOOST and SYNTHSETTLE form the two
either be shut down again, or continue to run if                   stage procedure to settle the synthesizer on the first LO
WORMULTIPKT is set in register PKTMISCFLAGS.                       frequency. During SYNTHBOOST, the synthesizer is
   In Wake-on-Radio mode, the AX5043 is completely                 operated at a higher loop bandwidth (register
autonomous until a packet is received. The microprocessor          PLLLOOPBOOST), while during SYNTHSETTLE, the
may be shut down and only wake up once the FIFO is no              final settling is done at the nominal, lower noise, loop
longer empty (IRQMFIFONOTEMPTY interrupt in                        bandwidth (register PLLLOOP).
register IRQMASK0).                                                   IFINIT settles the IF strip. COARSEAGC uses a fast AGC
                                                                   time constant to quickly settle the AGC to a value close to
Receiver State Machine                                             the correct one. This is especially important during
   Figure 12 shows the receiver timing diagram. The actions        wake-on-radio, as it is desirable to keep the receiver
in the first two lines are time controlled. The arrows below       powered the shortest possible time to save power. AGC
indicate which register controls the timing. The actions           settles the AGC using a slower time constant. RSSI
colored in a darker shade of blue are only performed when          measures the received signal strength. This value is then
diversity mode is enabled (DIVENA is set in register               used to determine whether the receiver should be kept
DIVERSITY). The actions in the last line are detailed in the       running in wake-on-radio, or to select the antenna with the
state diagram Figure 13.                                           stronger signal in diversity mode.
                                                                                Antenna #0
          SYNTHBOOST             SYNTHSETTLE              IFINIT          COARSEAGC              AGC         RSSI
         TMGRXBOOST             TMGRXSETTLE         TMGRXOFFSACQ TMGRXCOARSEAGC TMGRXAGC                 TMGRXRSSI
                                              Antenna #1                               Selected Antenna
                         IFINIT          COARSEAGC           AGC           RSSI              IFINIT
                  TMGRXOFFSACQ TMGRXCOARSEAGC TMGRXAGC                  TMGRXRSSI      TMGRXOFFSACQ
                     PREAMBLE1           PREAMBLE2            PREAMBLE3           PACKET                    Antenna
                                                                                                         Diversity only
                                     MATCH1              MATCH0              SFD detected
                                              Figure 12. Transmitter Flow Chart
   Once the receiver is initialized, PREAMBLE1,                    noisiness of the parameter estimates. In order to allow both
PREAMBLE2, PREAMBLE3, and PACKET coordinate                        fast acquisition to enable short preambles and low steady
the reception of packets. The receiver contains several loops      state noise performance to enable high receiver sensitivity,
that acquire and track transmission parameters the receiver        the receiver supports multiple acquisition and tracking loop
needs to know in order to correctly receive a packet.              parameter sets. When the receiver searches for a
• The AGC acquires and tracks the signal strength                  transmission signal, it uses wide loop bandwidths. Once it
• The frequency tracking loop acquires and tracks the              detects a preamble with sufficient probability, it switches to
   frequency offset                                                a lower loop bandwidth. Once a frame start is detected, it
                                                                   switches to an even lower loop bandwidth. Figure 13 shows
• The timing and data rate tracking loop acquires and
                                                                   the state diagram that controls which receiver parameter set
   tracks the sampling time and the data rate offset
                                                                   is used.
   The bandwidth of these loops is programmable. The
bandwidth controls the acquisition time as well as the
                                                       www.onsemi.com
                                                                18
                                                         AND9347/D
                                             Figure 13. Receiver State Diagram
   Conditions are evaluated in priority order. The priority      order to increase the precision of the wake-up frequency,
number is given in parentheses at the beginning of arrow         calibration logic allows the low power oscillator to be
labels.                                                          calibrated against the crystal oscillator or TCXO.
   In order to reduce the number of registers that need to be       Figure 14 shows a block diagram of the calibration logic.
programmed if not all parameter sets are different, the          It works similarly to a PLL. The reference frequency from
parameter set number of Figure 13 is not directly used to        the crystal or TCXO is divided by the value of the
address the parameter set. Instead, it indexes into register     LPOSCREF register. This signal is then compared to the
RXPARAMSETS, where the actual parameter set number is            actual frequency of the Low Power Oscillator. The
read out.                                                        frequency difference is then low pass filtered
                                                                 (LPOSCKFILT register) and used to adjust the Low Power
Low Power Oscillator Calibration                                 Oscillator frequency (LPOSCFREQ register).
   The low power oscillator is used to control the wake-up
frequency, or polling period, during wake-on-radio mode. In
                    Crystal
                    or TCXO         LPOSCREF                         LPOSCKFILT       LPOSCFREQ
                                                         FD
                                    Figure 14. Low Power Oscillator Calibration Logic
   When enabled (LPOSCCALIBR or LPOSCCALIBF                      enabled as well. This allows “opportunistic” calibration –
enabled in register LPOSCCONFIG), the calibration logic          the Low Power Oscillator is calibrated whenever the
is only activated when the crystal oscillator or TCXO is         reference frequency is enabled.
                                                      www.onsemi.com
                                                              19
                                                               AND9347/D
Auxiliary DAC                                                                                             R
  The AX5043 contains an auxiliary DAC. It can be used to               PWRAMP
                                                                                                                                   V o lt a g e
output various receiver signals, such as RSSI or Frequency              or ANTSEL
Offset, or just a value under program control. The DAC
signal can be output either on the PWRAMP or ANTSEL
                                                                                                                               C
pad.
  The DAC may be operated in two modes. ΣΔ mode
                                                                                                                                   D A C
employs a digital modulator to output a high resolution
signal. Its output voltage range is 1⁄4 VDDIO to 3⁄4 VDDIO                       GND
for a DACVALUE range from *2048 to 2047.
  PWM mode outputs a pulse width modulated signal. It is                                    Figure 15. DAC RC Filter
only suitable for low frequency signals. Its output voltage
range is 0 to VDDIO for a DACVALUE range from *2048                       A low pass filter, such as a simple R-C filter as shown in
to 2047.                                                                Figure 15, must be used to obtain the analog voltage.
                DACINPUT       23 22 21 20 19 18 17 16 15 14 13 12 11 10 9              8    7    6   5    4   3   2   1   0
                   0001        15          TRK_AMPLITUDE + 0x8000                       0    0 0 0 0 0 0 0 0
                   0010        19                     TRK_RFFREQUENCY                                      0   0 0 0 0
                   0011        15                TRK_FREQUENCY                          0    0 0 0 0 0 0 0 0
                   0100        13            TRK_FSKDEMOD                         0   0 0 0 0 0 0 0 0 0 0
                   0110         7         RSSI             0   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                   0111        13                SOFTDATA                         0   0 0 0 0 0 0 0 0 0 0
                   1000        13                      I                          0   0 0 0 0 0 0 0 0 0 0
                   1001        13                     Q                           0   0 0 0 0 0 0 0 0 0 0
                   1100         9          GPADC13                0    0 0 0 0 0 0 0 0 0 0 0 0 0 0
                                                                        Shifter
                                                                            11                   Limiter                   0
                   0000                                                     11               DACVALUE                      0
                                                                                                 to DAC
                                                   Figure 16. DAC Signal Scaling
  Figure 16 shows the DAC Signal scaling. DACINPUT in                   value range of *211...211*1. This signal is then sent to the
register DACCONFIG selects the source signal. The input                 DAC core. Note that if DACVALUE is selected as input, the
signals are left aligned to 24 bits and padded with zeros. A            register value is directly sent to the DAC, the shifter is not
signed shifter then shifts the selected value to the right by 0         used. In fact, DACVALUE and DACSHIFT share the same
to 15 digits as selected by the lower four bits of the                  register bits.
DACVALUE register. The signal is then limited to the DAC
                                                       www.onsemi.com
                                                                  20
                                                                 AND9347/D
REGISTER OVERVIEW
 Table 22. CONTROL REGISTER MAP
 Addr                                                                              Bit
  Hex          Name            Dir  R   Reset      7           6         5      4         3          2      1    0        Description
 Revision & Interface Probing
 000     REVISION             R    R  01010001 SILICONREV(7:0)                                                         Silicon Revision
 001     SCRATCH              RW   R  11000101 SCRATCH(7:0)                                                            Scratch Register
 Operating Mode
 002     PWRMODE              RW   R  011−0000 RST        REFEN      XOEN   WDS        PWRMODE(3:0)                    Power Mode
 Voltage Regulator
 003     POWSTAT              R    R  −−−−−−−− SSUM       SREF       SVREF  SVANA      SV       SBE     SBEV  SVIO     Power
                                                                                       MODEM    VANA    MODEM          Management
                                                                                                                       Status
 004     POWSTICKYSTAT        R    R  −−−−−−−− SSSUM      SSREF      SSVREF SSVANA     SSV      SS      SSBEV SSVIO    Power
                                                                                       MODEM    BEVANA  MODEM          Management
                                                                                                                       Sticky Status
 005     POWIRQMASK           RW   R  00000000 MPWR       MSREF      MSVREF MS VANA    MSV      MS      MSBEV MSVIO    Power
                                               GOOD                                    MODEM    BE VANA MODEM          Management
                                                                                                                       Interrupt Mask
 Interrupt Control
 006     IRQMASK1             RW   R  −−−00000 −          −          −      IRQMASK(12:8)                              IRQ Mask
 007     IRQMASK0             RW   R  00000000 IRQMASK(7:0)                                                            IRQ Mask
 008     RADIOEVENTMAS        RW   R  −−−−−−−0 −          −          −      −          −        −       −     RADIO    Radio Event
         K1                                                                                                   EVENT    Mask
                                                                                                              MASK (8)
 009     RADIOEVENTMAS        RW   R  00000000 RADIO EVENT MASK (7:0)                                                  Radio Event
         K0                                                                                                            Mask
 00A     IRQINVERSION1        RW   R  −−−00000 −          −          −      IRQINVERSION (12:8)                        IRQ Inversion
 00B     IRQINVERSION0        RW   R  00000000 IRQINVERSION (7:0)                                                      IRQ Inversion
 00C     IRQREQUEST1          R    R  −−−−−−−− −          −          −      IRQREQUEST (12:8)                          IRQ Request
 00D     IRQREQUEST0          R    R  −−−−−−−− IRQREQUEST (7:0)                                                        IRQ Request
 00E     RADIOEVENTREQ        R       −−−−−−−− −          −          −      −          −        −       −     RADIO    Radio Event
         1                                                                                                    EVENT    Request
                                                                                                              REQ(8)
 00F     RADIOEVENTREQ        R       −−−−−−−− RADIO EVENT REQ (7:0)                                                   Radio Event
         0                                                                                                             Request
 Modulation & Framing
 010     MODULATION           RW   R  −−−01000 −          −          −      RX HALF    MODULATION(3:0)                 Modulation
                                                                            SPEED
 011     ENCODING             RW   R  −−−00010 −          −          −      ENC        ENC      ENC     ENC   ENC INV  Encoder/Decoder
                                                                            NOSYNC     MANCH    SCRAM   DIFF           Settings
 012     FRAMING              RW   R  −0000000 FRMRX      CRCMODE (2:0)                FRMMODE (2:0)          FABORT   Framing settings
 014     CRCINIT3             RW   R  11111111 CRCINIT (31:24)                                                         CRC Initialisation
                                                                                                                       Data
 015     CRCINIT2             RW   R  11111111 CRCINIT (23:16)                                                         CRC Initialisation
                                                                                                                       Data
 016     CRCINIT1             RW   R  11111111 CRCINIT (15:8)                                                          CRC Initialisation
                                                                                                                       Data
 017     CRCINIT0             RW   R  11111111 CRCINIT (7:0)                                                           CRC Initialisation
                                                                                                                       Data
                                                               www.onsemi.com
                                                                        21
                                                             AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                             Bit
 Hex          Name        Dir  R   Reset      7           6         5         4          3         2          1        0      Description
Forward Error Correction
018    FEC               RW   R  00000000 SHORT      RSTVI    FEC NEG     FEC POS    FECINPSHIFT (2:0)             FEC ENA FEC (Viterbi)
                                          MEM        TERBI                                                                 Configuration
019    FECSYNC           RW   R  01100010 FECSYNC (7:0)                                                                    Interleaver
                                                                                                                           Synchronisation
                                                                                                                           Threshold
01A    FECSTATUS         R    R  −−−−−−−− FEC INV    MAXMETRIC (6:0)                                                       FEC Status
Status
01C    RADIOSTATE        R    −  −−−−0000 −          −        −           −          RADIOSTATE (3:0)                      Radio Controller
                                                                                                                           State
01D    XTALSTATUS        R    R  −−−−−−−− −          −        −           −          −         −           −       XTAL    Crystal Oscillator
                                                                                                                   RUN     Status
Pin Configuration
020    PINSTATE          R    R  −−−−−−−− −          −        PS PWR      PS ANT     PS IRQ    PS DATA     PS DCLK PS SYS  Pinstate
                                                              AMP         SEL                                      CLK
021    PINFUNCSYSCLK     RW   R  0−−01000 PU         −        −           PFSYSCLK (4:0)                                   SYSCLK Pin
                                          SYSCLK                                                                           Function
022    PINFUNCDCLK       RW   R  00−−−100 PU DCLK    PI DCLK  −           −          −         PFDCLK (2:0)                DCLK Pin
                                                                                                                           Function
023    PINFUNCDATA       RW   R  10−−−111 PU DATA    PI DATA  −           −          −         PFDATA (2:0)                DATA Pin
                                                                                                                           Function
024    PINFUNCIRQ        RW   R  00−−−011 PU IRQ     PI IRQ   −           −          −         PFIRQ (2:0)                 IRQ Pin Function
025    PINFUNCANTSEL     RW   R  00−−−110 PU         PI       −           −          −         PFANTSEL (2:0)              ANTSEL Pin
                                          ANTSEL     ANTSEL                                                                Function
026    PINFUNCPWRAMP     RW   R  00−−0110 PU         PI       −           −          PFPWRAMP(3:0)                         PWRAMP Pin
                                          PWRAMP     PWRAMP                                                                Function
027    PWRAMP            RW   R  −−−−−−−0 −          −        −           −          −         −           −       PWRAMP  PWRAMP Control
FIFO
028    FIFOSTAT          R    R  0−−−−−−− FIFO       −        FIFO FREE   FIFO       FIFO      FIFO        FIFO    FIFO    FIFO Control
                                          AUTO                THR         CNT THR    OVER      UNDER       FULL    EMPTY
                                          COMMIT
                         W                           −        FIFOCMD (5:0)
029    FIFODATA          RW      −−−−−−−− FIFODATA (7:0)                  FIFO
                                                                          Data
02A    FIFOCOUNT1        R    R  −−−−−−−0 −          −        −           −          −         −           −       FIFO    Number of Words
                                                                                                                   COUNT   currently in FIFO
                                                                                                                   (8)
02B    FIFOCOUNT0        R    R  00000000 FIFOCOUNT (7:0)                                                                  Number of Words
                                                                                                                           currently in FIFO
02C    FIFOFREE1         R    R  −−−−−−−1 −          −        −           −          −         −           −       FIFO    Number of Words
                                                                                                                   FREE(8) that can be
                                                                                                                           written to FIFO
02D    FIFOFREE0         R    R  00000000 FIFOFREE (7:0)                                                                   Number of Words
                                                                                                                           that can be
                                                                                                                           written to FIFO
02E    FIFOTHRESH1       RW   R  −−−−−−−0 −          −        −           −          −         −           −       FIFO    FIFO Threshold
                                                                                                                   THRESH
                                                                                                                   (8)
02F    FIFOTHRESH0       RW   R  00000000 FIFOTHRESH (7:0)                                                                 FIFO Threshold
                                                          www.onsemi.com
                                                                  22
                                                        AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                    Bit
 Hex          Name    Dir  R   Reset      7          6        5      4         3          2       1          0      Description
Synthesizer
030     PLLLOOP      RW   R  0−−−1001 FREQB      −        −       −         DIRECT    FILT EN FLT (1:0)          PLL Loop Filter
                                                                                                                 Settings
031     PLLCPI       RW   R  00001000 PLLCPI                                                                     PLL Charge
                                                                                                                 Pump Current
                                                                                                                 (Boosted)
032     PLLVCODIV    RW   R  −000−000 −          VCOI     VCO2INT VCOSEL    −         RFDIV   REFDIV (1:0)       PLL Divider
                                                 MAN                                                             Settings
033     PLLRANGINGA  RW   R  00001000 STICKY     PLL LOCK RNGERR  RNG       VCORA (3:0)                          PLL Autoranging
                                      LOCK                        START
034     FREQA3       RW   R  00111001 FREQA (31:24)                                                              Synthesizer
                                                                                                                 Frequency
035     FREQA2       RW   R  00110100 FREQA (23:16)                                                              Synthesizer
                                                                                                                 Frequency
036     FREQA1       RW   R  11001100 FREQA (15:8)                                                               Synthesizer
                                                                                                                 Frequency
037     FREQA0       RW   R  11001101 FREQA (7:0)                                                                Synthesizer
                                                                                                                 Frequency
038     PLLLOOPBOOST RW   R  0−−−1011 FREQB      −        −       −         DIRECT    FILT EN FLT (1:0)          PLL Loop Filter
                                                                                                                 Settings
                                                                                                                 (Boosted)
039     PLLCPIBOOST  RW   R  11001000 PLLCPI                                                                     PLL Charge
                                                                                                                 Pump Current
03B     PLLRANGINGB  RW   R  00001000 STICKY     PLL LOCK RNGERR  RNG       VCORB (3:0)                          PLL Autoranging
                                      LOCK                        START
03C     FREQB3       RW   R  00111001 FREQB (31:24)                                                              Synthesizer
                                                                                                                 Frequency
03D     FREQB2       RW   R  00110100 FREQB (23:16)                                                              Synthesizer
                                                                                                                 Frequency
03E     FREQB1       RW   R  11001100 FREQB (15:8)                                                               Synthesizer
                                                                                                                 Frequency
03F     FREQB0       RW   R  11001101 FREQB (7:0)                                                                Synthesizer
                                                                                                                 Frequency
Signal Strength
040     RSSI         R    R  −−−−−−−− RSSI (7:0)                                                                 Received Signal
                                                                                                                 Strength Indicator
041     BGNDRSSI     RW   R  00000000 BGNDRSSI (7:0)                                                             Background RSSI
042     DIVERSITY    RW   R  −−−−−−00 −          −        −       −         −         −       ANT SEL    DIV ENA Antenna Diversity
                                                                                                                 Configuration
043     AGCCOUNTER   RW   R  −−−−−−−− AGCCOUNTER (7:0)                                                           AGC Current
                                                                                                                 Value
Receiver Tracking
045     TRKDATARATE2 R    R  −−−−−−−− TRKDATARATE (23:16)                                                        Datarate Tracking
046     TRKDATARATE1 R    R  −−−−−−−− TRKDATARATE (15:8)                                                         Datarate Tracking
047     TRKDATARATE0 R    R  −−−−−−−− TRKDATARATE (7:0)                                                          Datarate Tracking
048     TRKAMPL1     R    R  −−−−−−−− TRKAMPL (15:8)                                                             Amplitude
                                                                                                                 Tracking
049     TRKAMPL0     R    R  −−−−−−−− TRKAMPL (7:0)                                                              Amplitude
                                                                                                                 Tracking
04A     TRKPHASE1    R    R  −−−−−−−− −          −        −       −         TRKPHASE (11:8)                      Phase Tracking
04B     TRKPHASE0    R    R  −−−−−−−− TRKPHASE (7:0)                                                             Phase Tracking
                                                     www.onsemi.com
                                                             23
                                                             AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                               Bit
 Hex          Name         Dir  R   Reset      7          6           5       4           3         2    1 0    Description
Receiver Tracking
04D    TRKRFFREQ2         RW   R  −−−−−−−− −           −         −        −            TRRFKFREQ (19:16)     RF Frequency
                                                                                                             Tracking
04E    TRKRFFREQ1         RW   R  −−−−−−−− TRRFKFREQ (15:8)                                                  RF Frequency
                                                                                                             Tracking
04F    TRKRFFREQ0         RW   R  −−−−−−−− TRRFKFREQ (7:0)                                                   RF Frequency
                                                                                                             Tracking
050    TRKFREQ1           RW   R  −−−−−−−− TRKFREQ (15:8)                                                    Frequency
                                                                                                             Tracking
051    TRKFREQ0           RW   R  −−−−−−−− TRKFREQ (7:0)                                                     Frequency
                                                                                                             Tracking
052    TRKFSKDEMOD1       R    R  −−−−−−−− −           −         TRKFSKDEMOD (13:8)                          FSK Demodulator
                                                                                                             Tracking
053    TRKFSKDEMOD0       R    R  −−−−−−−− TRKFSKDEMOD (7:0)                                                 FSK Demodulator
                                                                                                             Tracking
Timer
059    TIMER2             R    −  −−−−−−−− TIMER (23:16)                                                     1 MHz Timer
05A    TIMER1             R    −  −−−−−−−− TIMER (15:8)                                                      1 MHz Timer
05B    TIMER0             R    −  −−−−−−−− TIMER (7:0)                                                       1 MHz Timer
Wakeup Timer
068    WAKEUPTIMER1       R    R  −−−−−−−− WAKEUPTIMER (15:8)                                                Wakeup Timer
069    WAKEUPTIMER0       R    R  −−−−−−−− WAKEUPTIMER (7:0)                                                 Wakeup Timer
06A    WAKEUP1            RW   R  00000000 WAKEUP (15:8)                                                     Wakeup Time
06B    WAKEUP0            RW   R  00000000 WAKEUP (7:0)                                                      Wakeup Time
06C    WAKEUPFREQ1        RW   R  00000000 WAKEUPFREQ (15:8)                                                 Wakeup
                                                                                                             Frequency
06D    WAKEUPFREQ0        RW   R  00000000 WAKEUPFREQ (7:0)                                                  Wakeup
                                                                                                             Frequency
06E    WAKEUPXOEARLY      RW   R  00000000 WAKEUPXOEARLY (7:0)                                               Wakeup Crystal
                                                                                                             Oscillator Early
Physical Layer Parameters
Receiver Parameters
100    IFFREQ1            RW   R  00010011 IFFREQ (15:8)                                                     2nd LO / IF
                                                                                                             Frequency
101    IFFREQ0            RW   R  00100111 IFFREQ (7:0)                                                      2nd LO / IF
                                                                                                             Frequency
102    DECIMATION         RW   R  −0001101 −           DECIMATION (6:0)                                      Decimation
                                                                                                             Factor
103    RXDATARATE2        RW   R  00000000 RXDATARATE (23:16)                                                Receiver Datarate
104    RXDATARATE1        RW   R  00111101 RXDATARATE (15:8)                                                 Receiver Datarate
105    RXDATARATE0        RW   R  10001010 RXDATARATE (7:0)                                                  Receiver Datarate
106    MAXDROFFSET2       RW   R  00000000 MAXDROFFSET (23:16)                                               Maximum
                                                                                                             Receiver Datarate
                                                                                                             Offset
107    MAXDROFFSET1       RW   R  00000000 MAXDROFFSET (15:8)                                                Maximum
                                                                                                             Receiver Datarate
                                                                                                             Offset
108    MAXDROFFSET0       RW   R  10011110 MAXDROFFSET (7:0)                                                 Maximum
                                                                                                             Receiver Datarate
                                                                                                             Offset
                                                          www.onsemi.com
                                                                     24
                                                            AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                               Bit
 Hex         Name         Dir  R   Reset      7           6         5        4            3           2         1       0     Description
Receiver Parameters
109    MAXRFOFFSET2      RW   R  0−−−0000 FREQ        −       −           −            MAXRFOFFSET (19:16)                Maximum
                                          OFFS                                                                            Receiver RF
                                          CORR                                                                            Offset
10A    MAXRFOFFSET1      RW   R  00010110 MAXRFOFFSET (15:8)                                                              Maximum
                                                                                                                          Receiver RF
                                                                                                                          Offset
10B    MAXRFOFFSET0      RW   R  10000111 MAXRFOFFSET (7:0)                                                               Maximum
                                                                                                                          Receiver RF
                                                                                                                          Offset
10C    FSKDMAX1          RW   R  00000000 FSKDEVMAX (15:8)                                                                Four FSK Rx
                                                                                                                          Deviation
10D    FSKDMAX0          RW   R  10000000 FSKDEVMAX (7:0)                                                                 Four FSK Rx
                                                                                                                          Deviation
10E    FSKDMIN1          RW   R  11111111 FSKDEVMIN (15:8)                                                                Four FSK Rx
                                                                                                                          Deviation
10F    FSKDMIN0          RW   R  10000000 FSKDEVMIN (7:0)                                                                 Four FSK Rx
                                                                                                                          Deviation
110    AFSKSPACE1        RW   R  −−−−0000 −           −       −           −            AFSKSPACE(11:8)                    AFSK Space (0)
                                                                                                                          Frequency
111    AFSKSPACE0        RW   R  01000000 AFSKSPACE (7:0)                                                                 AFSK Space (0)
                                                                                                                          Frequency
112    AFSKMARK1         RW   R  −−−−0000 −           −       −           −            AFSKMARK (11:8)                    AFSK Mark (1)
                                                                                                                          Frequency
113    AFSKMARK0         RW   R  01110101 AFSKMARK (7:0)                                                                  AFSK Mark (1)
                                                                                                                          Frequency
114    AFSKCTRL          RW   R  −−−00100 −           −       −           AFSKSHIFT0 (4:0)                                AFSK Control
115    AMPLFILTER        RW   R  −−−−0000 −           −       −           −            AMPLFILTER (3:0)                   Amplitude Filter
116    FREQUENCYLEAK     RW   R  −−−−0000 −           −       −           −            FREQUENCYLEAK (3:0)                Baseband
                                                                                                                          Frequency
                                                                                                                          Recovery Loop
                                                                                                                          Leakiness
117    RXPARAMSETS       RW   R  00000000 RXPS3 (1:0)         RXPS2 (1:0)              RXPS1 (1:0)          RXPS0 (1:0)   Receiver
                                                                                                                          Parameter Set
                                                                                                                          Indirection
118    RXPARAMCURSET     R    R  −−−−−−−− −           −       −           RXSI (2)     RXSN (1:0)           RXSI (1:0)    Receiver
                                                                                                                          Parameter
                                                                                                                          Current Set
Receiver Parameter Set 0
120    AGCGAIN0          RW   R  10110100 AGCDECAY0 (3:0)                              AGCATTACK0 (3:0)                   AGC Speed
121    AGCTARGET0        RW   R  01110110 AGCTARGET0 (7:0)                                                                AGC Target
122    AGCAHYST0         RW   R  −−−−−000 −           −       −           −            −           AGCAHYST0 (2:0)        AGC Digital
                                                                                                                          Threshold Range
123    AGCMINMAX0        RW   R  −000−000 −           AGCMAXDA0 (2:0)                  −           AGCMINDA0 (2:0)        AGC Digital
                                                                                                                          Minimum/
                                                                                                                          Maximum Set
                                                                                                                          Points
124    TIMEGAIN0         RW   R  11111000 TIMEGAIN0M (3:0)                             TIMEGAIN0E (3:0)                   Timing Gain
125    DRGAIN0           RW   R  11110010 DRGAIN0M (3:0)                               DRGAIN0E (3:0)                     Data Rate Gain
126    PHASEGAIN0        RW   R  11−−0011 FILTERIDX0 (1:0)    −           −            PHASEGAIN0 (3:0)                   Filter Index,
                                                                                                                          Phase Gain
127    FREQGAINA0        RW   R  00001111 FREQ        FREQ    FREQ        FREQ         FREQGAINA0 (3:0)                   Frequency Gain A
                                          LIM0        MODULO  HALFMOD     AMPL
                                                      0       0           GATE0
                                                          www.onsemi.com
                                                                   25
                                                            AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                        Bit
 Hex         Name         Dir  R   Reset      7           6       5      4         3           2       1  0     Description
Receiver Parameter Set 0
128    FREQGAINB0        RW   R  00−11111 FREQ      FREQ      −       FREQGAINB0 (4:0)                      Frequency Gain B
                                          FREEZE0   AVG0
129    FREQGAINC0        RW   R  −−−01010 −         −         −       FREQGAINC0 (4:0)                      Frequency Gain
                                                                                                            C
12A    FREQGAIND0        RW   R  0−−01010 RFFREQ    −         −       FREQGAIND0 (4:0)                      Frequency Gain
                                          FREEZE0                                                           D
12B    AMPLGAIN0         RW   R  01−−0110 AMPL      AMPL      −       −         AMPLGAIN0 (3:0)             Amplitude Gain
                                          AVG0      AGC0
12C    FREQDEV10         RW   R  −−−−0000 −         −         −       −         FREQDEV0 (11:8)             Receiver
                                                                                                            Frequency
                                                                                                            Deviation
12D    FREQDEV00         RW   R  00100000 FREQDEV0 (7:0)                                                    Receiver
                                                                                                            Frequency
                                                                                                            Deviation
12E    FOURFSK0          RW   R  −−−10110 −         −         −       DEV       DEVDECAY0 (3:0)             Four FSK Control
                                                                      UPDATE0
12F    BBOFFSRES0        RW   R  10001000 RESINTB0 (3:0)                        RESINTA0 (3:0)              Baseband Offset
                                                                                                            Compensation
                                                                                                            Resistors
Receiver Parameter Set 1
130    AGCGAIN1          RW   R  10110100 AGCDECAY1 (3:0)                       AGCATTACK1 (3:0)            AGC Speed
131    AGCTARGET1        RW   R  01110110 AGCTARGET1 (7:0)                                                  AGC Target
132    AGCAHYST1         RW   R  −−−−−000 −         −         −       −         −         AGCAHYST1 (2:0)   AGC Digital
                                                                                                            Threshold Range
133    AGCMINMAX1        RW   R  −000−000 −         AGCMAXDA1 (2:0)             −         AGCMINDA1 (2:0)   AGC Digital
                                                                                                            Minimum/
                                                                                                            Maximum Set
                                                                                                            Points
134    TIMEGAIN1         RW   R  11110110 TIMEGAIN1M (3:0)                      TIMEGAIN1E (3:0)            Timing Gain
135    DRGAIN1           RW   R  11110001 DRGAIN1M (3:0)                        DRGAIN1E (3:0)              Data Rate Gain
136    PHASEGAIN1        RW   R  11−−0011 FILTERIDX1 (1:0)    −       −         PHASEGAIN1 (3:0)            Filter Index,
                                                                                                            Phase Gain
137    FREQGAINA1        RW   R  00001111 FREQ      FREQ      FREQ    FREQ      FREQGAINA1 (3:0)            Frequency Gain A
                                          LIM1      MODULO    HALFMOD AMPL
                                                    1         1       GATE1
138    FREQGAINB1        RW   R  00−11111 FREQ      FREQ      −       FREQGAINB1 (4:0)                      Frequency Gain B
                                          FREEZE1   AVG1
139    FREQGAINC1        RW   R  −−−01011 −         −         −       FREQGAINC1 (4:0)                      Frequency Gain
                                                                                                            C
13A    FREQGAIND1        RW   R  0−−01011 RFFREQ    −         −       FREQGAIND1 (4:0)                      Frequency Gain
                                          FREEZE1                                                           D
13B    AMPLGAIN1         RW   R  01−−0110 AMPL      AMPL1     −       −         AMPLGAIN1 (3:0)             Amplitude Gain
                                          AVG1      AGC1
13C    FREQDEV11         RW   R  −−−−0000 −         −         −       −         FREQDEV1 (11:8)             Receiver
                                                                                                            Frequency
                                                                                                            Deviation
13D    FREQDEV01         RW   R  00100000 FREQDEV1 (7:0)                                                    Receiver
                                                                                                            Frequency
                                                                                                            Deviation
                                                          www.onsemi.com
                                                                 26
                                                            AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                        Bit
 Hex         Name         Dir  R   Reset      7           6       5      4         3           2       1  0     Description
Receiver Parameter Set 1
13E    FOURFSK1          RW   R  −−−11000 −         −         −       DEV       DEVDECAY1 (3:0)             Four FSK Control
                                                                      UPDATE1
13F    BBOFFSRES1        RW   R  10001000 RESINTB1 (3:0)                        RESINTA1 (3:0)              Baseband Offset
                                                                                                            Compensation
                                                                                                            Resistors
Receiver Parameter Set 2
140    AGCGAIN2          RW   R  11111111 AGCDECAY2 (3:0)                       AGCATTACK2 (3:0)            AGC Speed
141    AGCTARGET2        RW   R  01110110 AGCTARGET2 (7:0)                                                  AGC Target
142    AGCAHYST2         RW   R  −−−−−000 −         −         −       −         −         AGCAHYST2 (2:0)   AGC Digital
                                                                                                            Threshold Range
143    AGCMINMAX2        RW   R  −000−000 −         AGCMAXDA2(2:0)              −         AGCMINDA2 (2:0)   AGC Digital
                                                                                                            Minimum/
                                                                                                            Maximum Set
                                                                                                            Points
144    TIMEGAIN2         RW   R  11110101 TIMEGAIN2M (3:0)                      TIMEGAIN2E (3:0)            Timing Gain
145    DRGAIN2           RW   R  11110000 DRGAIN2M (3:0)                        DRGAIN2E (3:0)              Data Rate Gain
146    PHASEGAIN2        RW   R  11−−0011 FILTERIDX2 (1:0)    −       −         PHASEGAIN2 (3:0)            Filter Index,
                                                                                                            Phase Gain
147    FREQGAINA2        RW   R  00001111 FREQ      FREQ      FREQ    FREQ      FREQGAINA2 (3:0)            Frequency Gain A
                                          LIM2      MODULO    HALFMOD AMPL
                                                    2         2       GATE2
148    FREQGAINB2        RW   R  00−11111 FREQ      FREQ      −       FREQGAINB2 (4:0)                      Frequency Gain B
                                          FREEZE2   AVG2
149    FREQGAINC2        RW   R  −−−01101 −         −         −       FREQGAINC2 (4:0)                      Frequency Gain
                                                                                                            C
14A    FREQGAIND2        RW   R  0−−01101 RFFREQ    −         −       FREQGAIND2 (4:0)                      Frequency Gain
                                          FREEZE2                                                           D
14B    AMPLGAIN2         RW   R  01−−0110 AMPL      AMPL      −       −         AMPLGAIN2 (3:0)             Amplitude Gain
                                          AVG2      AGC2
14C    FREQDEV12         RW   R  −−−−0000 −         −         −       −         FREQDEV2 (11:8)             Receiver
                                                                                                            Frequency
                                                                                                            Deviation
14D    FREQDEV02         RW   R  00100000 FREQDEV2 (7:0)                                                    Receiver
                                                                                                            Frequency
                                                                                                            Deviation
14E    FOURFSK2          RW   R  −−−11010 −         −         −       DEV       DEVDECAY2 (3:0)             Four FSK Control
                                                                      UPDATE2
14F    BBOFFSRES2        RW   R  10001000 RESINTB2 (3:0)                        RESINTA2 (3:0)              Baseband Offset
                                                                                                            Compensation
                                                                                                            Resistors
Receiver Parameter Set 3
150    AGCGAIN3          RW   R  11111111 AGCDECAY3 (3:0)                       AGCATTACK3 (3:0)            AGC Speed
151    AGCTARGET3        RW   R  01110110 AGCTARGET3 (7:0)                                                  AGC Target
152    AGCAHYST3         RW   R  −−−−−000 −         −         −       −         −         AGCAHYST3 (2:0)   AGC Digital
                                                                                                            Threshold Range
153    AGCMINMAX3        RW   R  −000−000 −         AGCMAXDA3 (2:0)             −         AGCMINDA3 (2:0)   AGC Digital
                                                                                                            Minimum/
                                                                                                            Maximum Set
                                                                                                            Points
154    TIMEGAIN3         RW   R  11110101 TIMEGAIN3M (3:0)                      TIMEGAIN3E (3:0)            Timing Gain
155    DRGAIN3           RW   R  11110000 DRGAIN3M (3:0)                        DRGAIN3E (3:0)              Data Rate Gain
                                                          www.onsemi.com
                                                                 27
                                                            AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                           Bit
 Hex          Name        Dir  R   Reset      7           6       5          4        3           2    1         0       Description
Receiver Parameter Set 3
156    PHASEGAIN3        RW   R  11−−0011 FILTERIDX3 (1:0)    −         −          PHASEGAIN3 (3:0)                  Filter Index,
                                                                                                                     Phase Gain
157    FREQGAINA3        RW   R  00001111 FREQ       FREQ     FREQ      FREQ       FREQGAINA3 (3:0)                  Frequency Gain A
                                          LIM3       MODULO   HALFMOD   AMPL
                                                     3        3         GATE3
158    FREQGAINB3        RW   R  00−11111 FREQ       FREQ     −         FREQGAINB3 (4:0)                             Frequency Gain B
                                          FREEZE3    AVG3
159    FREQGAINC3        RW   R  −−−01101 −          −        −         FREQGAINC3 (4:0)                             Frequency Gain
                                                                                                                     C
15A    FREQGAIND3        RW   R  0−−01101 RFFREQ     −        −         FREQGAIND3 (4:0)                             Frequency Gain
                                          FREEZE3                                                                    D
15B    AMPLGAIN3         RW   R  01−−0110 AMPL       AMPL     −         −          AMPLGAIN3 (3:0)                   Amplitude Gain
                                          AVG3       AGC3
15C    FREQDEV13         RW   R  −−−−0000 −          −        −         −          FREQDEV3 (11:8)                   Receiver
                                                                                                                     Frequency
                                                                                                                     Deviation
15D    FREQDEV03         RW   R  00100000 FREQDEV3 (7:0)                                                             Receiver
                                                                                                                     Frequency
                                                                                                                     Deviation
15E    FOURFSK3          RW   R  −−−11010 −          −        −         DEV        DEVDECAY3 (3:0)                   Four FSK Control
                                                                        UPDATE3
15F    BBOFFSRES3        RW   R  10001000 RESINTB3 (3:0)                           RESINTA3 (3:0)                    Baseband Offset
                                                                                                                     Compensation
                                                                                                                     Resistors
Transmitter Parameters
160    MODCFGF           RW   R  −−−−−−00 −          −        −         −          −         −      FREQ SHAPE (1:0) Modulator
                                                                                                                     Configuration F
161    FSKDEV2           RW   R  00000000 FSKDEV (23:16)                                                             FSK Frequency
                                                                                                                     Deviation
162    FSKDEV1           RW   R  00001010 FSKDEV (15:8)                                                              FSK Frequency
                                                                                                                     Deviation
163    FSKDEV0           RW   R  00111101 FSKDEV (7:0)                                                               FSK Frequency
                                                                                                                     Deviation
164    MODCFGA           RW   R  0000−101 BROWN      PTTLCK   SLOW RAMP (1:0)      −         AMPL   TX SE    TX DIFF Modulator
                                          GATE       GATE                                    SHAPE                   Configuration A
165    TXRATE2           RW   R  00000000 TXRATE (23:16)                                                             Transmitter
                                                                                                                     Bitrate
166    TXRATE1           RW   R  00101000 TXRATE (15:8)                                                              Transmitter
                                                                                                                     Bitrate
167    TXRATE0           RW   R  11110110 TXRATE (7:0)                                                               Transmitter
                                                                                                                     Bitrate
168    TXPWRCOEFFA1      RW   R  00000000 TXPWRCOEFFA (15:8)                                                         Transmitter
                                                                                                                     Predistortion
                                                                                                                     Coefficient A
169    TXPWRCOEFFA0      RW   R  00000000 TXPWRCOEFFA (7:0)                                                          Transmitter
                                                                                                                     Predistortion
                                                                                                                     Coefficient A
16A    TXPWRCOEFFB1      RW   R  00001111 TXPWRCOEFFB (15:8)                                                         Transmitter
                                                                                                                     Predistortion
                                                                                                                     Coefficient B
16B    TXPWRCOEFFB0      RW   R  11111111 TXPWRCOEFFB (7:0)                                                          Transmitter
                                                                                                                     Predistortion
                                                                                                                     Coefficient B
                                                          www.onsemi.com
                                                                 28
                                                          AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                             Bit
 Hex           Name     Dir  R   Reset      7          6            5         4         3           2           1       0      Description
Transmitter Parameters
16C     TXPWRCOEFFC1   RW   R  00000000 TXPWRCOEFFC (15:8)                                                                  Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient C
16D     TXPWRCOEFFC0   RW   R  00000000 TXPWRCOEFFC (7:0)                                                                   Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient C
16E     TXPWRCOEFFD1   RW   R  00000000 TXPWRCOEFFD (15:8)                                                                  Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient D
16F     TXPWRCOEFFD0   RW   R  00000000 TXPWRCOEFFD (7:0)                                                                   Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient D
170     TXPWRCOEFFE1   RW   R  00000000 TXPWRCOEFFE (15:8)                                                                  Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient E
171     TXPWRCOEFFE0   RW   R  00000000 TXPWRCOEFFE (7:0)                                                                   Transmitter
                                                                                                                            Predistortion
                                                                                                                            Coefficient E
PLL Parameters
180     PLLVCOI        RW   R  0−010010 VCOIE      −           VCOI (5:0)                                                   VCO Current
181     PLLVCOIR       RW   R  −−−−−−−− −          −           VCOIR (5:0)                                                  VCO Current
                                                                                                                            Readback
182     PLLLOCKDET     RW   R  −−−−−011 LOCKDETDLYR (1:0)      −           −         −          LOCK       LOCKDETDLY (1:0) PLL Lock Detect
                                                                                                DET                         Delay
                                                                                                DLYM
183     PLLRNGCLK      RW   R  −−−−−011 −          −           −           −         −          PLLRNGCLK (2:0)             PLL Ranging
                                                                                                                            Clock
Crystal Oscillator
184     XTALCAP        RW   R  00000000 XTALCAP (7:0)                                                                       Crystal Oscillator
                                                                                                                            Load Capacitance
                                                                                                                            Configuration
Baseband
188     BBTUNE         RW   R  −−−01001 −          −           −           BB TUNE   BBTUNE (3:0)                           Baseband Tuning
                                                                           RUN
189     BBOFFSCAP      RW   R  −111−111 −          CAP INT B (2:0)                   −          CAP INT A (2:0)             Baseband Offset
                                                                                                                            Compensation
                                                                                                                            Capacitors
MAC Layer Parameters
Packet Format
200     PKTADDRCFG     RW   R  001−0000 MSB        CRC SKIP    FEC SYNC    −         ADDR POS (3:0)                         Packet Address
                                        FIRST      FIRST       DIS                                                          Config
201     PKTLENCFG      RW   R  00000000 LEN BITS (3:0)                               LEN POS (3:0)                          Packet Length
                                                                                                                            Config
202     PKTLENOFFSET   RW   R  00000000 LEN OFFSET (7:0)                                                                    Packet Length
                                                                                                                            Offset
203     PKTMAXLEN      RW   R  00000000 MAX LEN (7:0)                                                                       Packet Maximum
                                                                                                                            Length
204     PKTADDR3       RW   R  00000000 ADDR (31:24)                                                                        Packet Address 3
205     PKTADDR2       RW   R  00000000 ADDR (23:16)                                                                        Packet Address 2
206     PKTADDR1       RW   R  00000000 ADDR (15:8)                                                                         Packet Address 1
207     PKTADDR0       RW   R  00000000 ADDR (7:0)                                                                          Packet Address 0
                                                       www.onsemi.com
                                                                   29
                                                        AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                  Bit
 Hex          Name    Dir  R   Reset     7          6        5     4          3         2 1 0    Description
Packet Format
208     PKTADDRMASK3 RW   R  00000000 ADDRMASK (31:24)                                        Packet Address
                                                                                              Mask 3
209     PKTADDRMASK2 RW   R  00000000 ADDRMASK (23:16)                                        Packet Address
                                                                                              Mask 2
20A     PKTADDRMASK1 RW   R  00000000 ADDRMASK (15:8)                                         Packet Address
                                                                                              Mask 1
20B     PKTADDRMASK0 RW   R  00000000 ADDRMASK (7:0)                                          Packet Address
                                                                                              Mask 0
Pattern Match
210     MATCH0PAT3   RW   R  00000000 MATCH0PAT (31:24)                                       Pattern Match
                                                                                              Unit 0, Pattern
211     MATCH0PAT2   RW   R  00000000 MATCH0PAT (23:16)                                       Pattern Match
                                                                                              Unit 0, Pattern
212     MATCH0PAT1   RW   R  00000000 MATCH0PAT (15:8)                                        Pattern Match
                                                                                              Unit 0, Pattern
213     MATCH0PAT0   RW   R  00000000 MATCH0PAT (7:0)                                         Pattern Match
                                                                                              Unit 0, Pattern
214     MATCH0LEN    RW   R  0−−00000 MATCH0   −          −     MATCH0LEN (4:0)               Pattern Match
                                      RAW                                                     Unit 0, Pattern
                                                                                              Length
215     MATCH0MIN    RW   R  −−−00000 −        −          −     MATCH0MIN (4:0)               Pattern Match
                                                                                              Unit 0, Minimum
                                                                                              Match
216     MATCH0MAX    RW   R  −−−11111 −        −          −     MATCH0MAX (4:0)               Pattern Match
                                                                                              Unit 0, Maximum
                                                                                              Match
218     MATCH1PAT1   RW   R  00000000 MATCH1PAT (15:8)                                        Pattern Match
                                                                                              Unit 1, Pattern
219     MATCH1PAT0   RW   R  00000000 MATCH1PAT (7:0)                                         Pattern Match
                                                                                              Unit 1, Pattern
21C     MATCH1LEN    RW   R  0−−−0000 MATCH1   −          −     −         MATCH1LEN (3:0)     Pattern Match
                                      RAW                                                     Unit 1, Pattern
                                                                                              Length
21D     MATCH1MIN    RW   R  −−−−0000 −        −          −     −         MATCH1MIN (3:0)     Pattern Match
                                                                                              Unit 1, Minimum
                                                                                              Match
21E     MATCH1MAX    RW   R  −−−−1111 −        −          −     −         MATCH1MAX (3:0)     Pattern Match
                                                                                              Unit 1, Maximum
                                                                                              Match
Packet Controller
220     TMGTXBOOST   RW   R  00110010 TMGTXBOOSTE (2:0)         TMGTXBOOSTM (4:0)             Transmit PLL
                                                                                              Boost Time
221     TMGTXSETTLE  RW   R  00001010 TMGTXSETTLEE (2:0)        TMGTXSETTLEM (4:0)            Transmit PLL
                                                                                              (post Boost)
                                                                                              Settling Time
223     TMGRXBOOST   RW   R  00110010 TMGRXBOOSTE (2:0)         TMGRXBOOSTM (4:0)             Receive PLL
                                                                                              Boost Time
224     TMGRXSETTLE  RW   R  00010100 TMGRXSETTLEE (2:0)        TMGRXSETTLEM (4:0)            Receive PLL
                                                                                              (post Boost)
                                                                                              Settling Time
225     TMGRXOFFSACQ RW   R  01110011 TMGRXOFFSACQE (2:0)       TMGRXOFFSACQM (4:0)           Receive
                                                                                              Baseband DC
                                                                                              Offset Acquisition
                                                                                              Time
                                                    www.onsemi.com
                                                            30
                                                                AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                                Bit
 Hex          Name            Dir  R   Reset     7          6         5         4           3       2          1        0        Description
Packet Controller
226     TMGRXCOARSEA        RW    R  00111001 TMGRXCOARSEAGCE (2:0)         TMGRXCOARSEAGCM (4:0)                             Receive Coarse
        GC                                                                                                                    AGC Time
227     TMGRXAGC            RW    R  00000000 TMGRXAGCE (2:0)               TMGRXAGCM (4:0)                                   Receiver AGC
                                                                                                                              Settling Time
228     TMGRXRSSI           RW    R  00000000 TMGRXRSSIE (2:0)              TMGRXRSSIM (4:0)                                  Receiver RSSI
                                                                                                                              Settling Time
229     TMGRXPREAMBLE       RW    R  00000000 TMGRXPREAMBLE1E (2:0)         TMGRXPREAMBLE1M (4:0)                             Receiver
        1                                                                                                                     Preamble 1
                                                                                                                              Timeout
22A     TMGRXPREAMBLE       RW    R  00000000 TMGRXPREAMBLE2E (2:0)         TMGRXPREAMBLE2M (4:0)                             Receiver
        2                                                                                                                     Preamble 2
                                                                                                                              Timeout
22B     TMGRXPREAMBLE       RW    R  00000000 TMGRXPREAMBLE3E (2:0)         TMGRXPREAMBLE3M (4:0)                             Receiver
        3                                                                                                                     Preamble 3
                                                                                                                              Timeout
22C     RSSIREFERENCE       RW    R  00000000 RSSIREFERENCE (7:0)                                                             RSSI Offset
22D     RSSIABSTHR          RW    R  00000000 RSSIABSTHR (7:0)                                                                RSSI Absolute
                                                                                                                              Threshold
22E     BGNDRSSIGAIN        RW    R  −−−−0000 −        −          −         −           BGNDRSSIGAIN (3:0)                    Background RSSI
                                                                                                                              Averaging Time
                                                                                                                              Constant
22F     BGNDRSSITHR         RW    R  −−000000 −        −          BGNDRSSITHR (5:0)                                           Background RSSI
                                                                                                                              Relative
                                                                                                                              Threshold
230     PKTCHUNKSIZE        RW    R  −−−−0000 −        −          −         −           PKTCHUNKSIZE (3:0)                    Packet Chunk
                                                                                                                              Size
231     PKTMISCFLAGS        RW    R  −−−00000 −        −          −         WOR         AGC      BGND      RXAGC    RXRSSI    Packet Controller
                                                                            MULTI       SETTL    RSSI      CLK      CLK       Miscellaneous
                                                                            PKT         DET                                   Flags
232     PKTSTOREFLAGS       RW    R  −0000000 −        ST ANT     ST CRCB   ST RSSI     ST DR    ST        ST       ST        Packet Controller
                                                       RSSI                                      RFOFFS    FOFFS    TIMER     Store Flags
233     PKTACCEPTFLAG       RW    R  −−000000 −        −          ACCPT     ACCPT       ACCPT    ACCPT     ACCPT    ACCPT     Packet Controller
        S                                                         LRGP      SZF         ADDRF    CRCF      ABRT     RESIDUE   Accept Flags
Special Functions
General Purpose ADC
300     GPADCCTRL           RW    R  −−000000 BUSY     −          0         0           0        GPADC1    CONT     CH ISOL   General Purpose
                                                                                                 3                            ADC Control
301     GPADCPERIOD         RW    R  00111111 GPADCPERIOD (7:0)                                                               GPADC Sampling
                                                                                                                              Period
308     GPADC13VALUE1       R        −−−−−−−− −        −          −         −           −        −         GPADC13VALUE (9:8) GPADC13 Value
309     GPADC13VALUE0       R        −−−−−−−− GPADC13VALUE (7:0)                                                              GPADC13 Value
Low Power Oscillator Calibration
310     LPOSCCONFIG         RW    R  00000000 LPOSC    LPOSC      LPOSC     LPOSC       LPOSC    LPOSC     LPOSC    LPOSC     Low Power
                                              OSC      OSC        CALIBR    CALIBF      IRQR     IRQF      FAST     ENA       Oscillator
                                              INVERT   DOUBLE                                                                 Configuration
311     LPOSCSTATUS         R     R  −−−−−−−− −        −          −         −           −        −         LPOSC    LPOSC     Low Power
                                                                                                           IRQ      EDGE      Oscillator Status
312     LPOSCKFILT1         RW    R  00100000 LPOSCKFILT (15:8)                                                               Low Power
                                                                                                                              Oscillator
                                                                                                                              Calibration Filter
                                                                                                                              Constant
                                                            www.onsemi.com
                                                                     31
                                                               AND9347/D
Table 22. CONTROL REGISTER MAP(continued)
Addr                                                                         Bit
 Hex         Name             Dir  R   Reset     7           6      5      4        3           2   1   0    Description
Low Power Oscillator Calibration
313    LPOSCKFILT0          RW    R  11000100 LPOSCKFILT (7:0)                                            Low Power
                                                                                                          Oscillator
                                                                                                          Calibration Filter
                                                                                                          Constant
314    LPOSCREF1            RW    R  01100001 LPOSCREF (15:8)                                             Low Power
                                                                                                          Oscillator
                                                                                                          Calibration
                                                                                                          Reference
315    LPOSCREF0            RW    R  10101000 LPOSCREF (7:0)                                              Low Power
                                                                                                          Oscillator
                                                                                                          Calibration
                                                                                                          Reference
316    LPOSCFREQ1           RW    R  00000000 LPOSCFREQ (9:2)                                             Low Power
                                                                                                          Oscillator
                                                                                                          Calibration
                                                                                                          Frequency
317    LPOSCFREQ0           RW    R  0000−−−− LPOSCFREQ (1:−2)                   −         −      −   −   Low Power
                                                                                                          Oscillator
                                                                                                          Calibration
                                                                                                          Frequency
318    LPOSCPER1            RW       −−−−−−−− LPOSCPER (15:8)                                             Low Power
                                                                                                          Oscillator
                                                                                                          Calibration Period
319    LPOSCPER0            RW       −−−−−−−− LPOSCPER (7:0)                                              Low Power
                                                                                                          Oscillator
                                                                                                          Calibration Period
DAC
330    DACVALUE1            RW    R  −−−−0000 −        −         −       −       DACVALUE (11:8)          DAC Value
331    DACVALUE0            RW    R  00000000 DACVALUE (7:0)                                              DAC Value
332    DACCONFIG            RW    R  00−−0000 DAC      DAC CLK   −       −       DACINPUT (3:0)           DAC
                                              PWM      X2                                                 Configuration
Performance Tuning Registers
F00−   PERFTUNE             RW       −−−−−−−−                                                             Performance
FFF                                                                                                       Tuning Registers
                                                             www.onsemi.com
                                                                   32
                                                             AND9347/D
REGISTER DETAILS
Revision and Interface Probing
REVISION
 Table 23. REVISION
           Name                    Bits        R/W          Reset                                     Description
 REVISION                           7:0          R        01010001      Silicon Revision
SCRATCH
 Table 24. SCRATCH
           Name                    Bits        R/W          Reset                                     Description
 SCRATCH                            7:0          R        11000101      Scratch Register
  The SCRATCH register does not affect the function of the
chip in any way. It is intended for the Microcontroller to test
communication to the AX5043.
Operating Mode
PWRMODE
 Table 25. PWRMODE
           Name                    Bits        R/W          Reset                                     Description
 PWRMODE                            3:0         RW          0000        See Table 26: PWRMODE Bit Value
 WDS                                 4           R            −         Wakeup from Deep Sleep
 REFEN                               5          RW            1         Reference Enable; set to 1 to power the internal reference
                                                                        circuitry
 XOEN                                6          RW            1         Crystal Oscillator Enable
 RST                                 7          RW            0         Reset; setting this bit to 1 resets the whole chip. This bit does not
                                                                        auto-reset − the chip remains in reset state until this bit is cleared.
 Table 26. PWRMODE BIT VALUES
         Bits                               Meaning
         0000            Powerdown; all circuits powered down
         0001            Deep Sleep Mode; Chip is fully powered
                         down until SEL is lowered again; looses all
                         register contents
         0101            Crystal Oscillator enabled
         0111            FIFO enabled
         1000            Synthesizer running, Receive Mode
         1001            Receiver Running
         1011            Receiver Wake-on-Radio Mode
         1100            Synthesizer running, Transmit Mode
         1101            Transmitter Running
                                                           www.onsemi.com
                                                                     33
                                    AND9347/D
Power Management
POWSTAT
 Table 27. POWSTAT
           Name          Bits R/W  Reset                                Description
 SVIO                     0    R     −      IO Voltage Large Enough (not Brownout)
 SBEVMODEM                1    R     −      Modem Domain Voltage Brownout Error
                                            (Inverted; 0 = Brownout, 1 = Power OK)
 SBEVANA                  2    R     −      Analog Domain Voltage Brownout Error
                                            (Inverted; 0 = Brownout, 1 = Power OK)
 SVMODEM                  3    R     −      Modem Domain Voltage Regulator Ready
 SVANA                    4    R     −      Analog Domain Voltage Regulator Ready
 SVREF                    5    R     −      Reference Voltage Regulator Ready
 SREF                     6    R     −      Reference Ready
 SSUM                     7    R     −      Summary Ready Status (one when all unmasked POWIRQMASK
                                            power sources are ready)
POWSTICKYSTAT
 Table 28. POWSTICKYSTAT
           Name          Bits R/W  Reset                                Description
 SSUM                     7    R     −      Summary Ready Status (one when all unmasked POWIRQMASK
                                            power sources are ready)
 SSVIO                    0    R     −      Sticky IO Voltage Large Enough (not Brownout)
 SSBEVMODEM               1    R     −      Sticky Modem Domain Voltage Brownout Error
                                            (Inverted; 0 = Brownout detected, 1 = Power OK)
 SSBEVANA                 2    R     −      Sticky Analog Domain Voltage Brownout Error
                                            (Inverted; 0 = Brownout detected, 1 = Power OK)
 SSVMODEM                 3    R     −      Sticky Modem Domain Voltage Regulator Ready
 SSVANA                   4    R     −      Sticky Analog Domain Voltage Regulator Ready
 SSVREF                   5    R     −      Sticky Reference Voltage Regulator Ready
 SSREF                    6    R     −      Sticky Reference Ready
 SSSUM                    7    R     −      Sticky Summary Ready Status (zero when any unmasked
                                            POWIRQMASK power sources is not ready)
POWIRQMASK
 Table 29. POWIRQMASK
           Name          Bits R/W  Reset                                Description
 MSVIO                    0   RW     0      IO Voltage Large Enough (not Brownout) Interrupt Mask
 MSBEVMODEM               1   RW     0      Modem Domain Voltage Brownout Error Interrupt Mask
 MSBEVANA                 2   RW     0      Analog Domain Voltage Brownout Error Interrupt Mask
 MSVMODEM                 3   RW     0      Modem Domain Voltage Regulator Ready Interrupt Mask
 MSVANA                   4   RW     0      Analog Domain Voltage Regulator Ready Interrupt Mask
 MSVREF                   5   RW     0      Reference Voltage Regulator Ready Interrupt Mask
 MSREF                    6   RW     0      Reference Ready Interrupt Mask
 MPWRGOOD                 7   RW     0      If 0, interrupt whenever one of the unmasked power sources fail
                                            (clear interrupt by reading POWSTICKYSTAT);
                                            if 1, interrupt when all unmasked power sources are good
                                  www.onsemi.com
                                         34
                                                       AND9347/D
Interrupt Control
IRQMASK1, IRQMASK0
 Table 30. IRQMASK1, IRQMASK0
           Name                Bits       R/W         Reset                                   Description
 IRQMFIFONOTEMPTY                0        RW            0        FIFO not empty interrupt enable
 IRQMFIFONOTFULL                 1        RW            0        FIFO not full interrupt enable
 IRQMFIFOTHRCNT                  2        RW            0        FIFO count > threshold interrupt enable
 IRQMFIFOTHRFREE                 3        RW            0        FIFO free > threshold interrupt enable
 IRQMFIFOERROR                   4        RW            0        FIFO error interrupt enable
 IRQMPLLUNLOCK                   5        RW            0        PLL lock lost interrupt enable
 IRQMRADIOCTRL                   6        RW            0        Radio Controller interrupt enable
 IRQMPOWER                       7        RW            0        Power interrupt enable
 IRQMXTALREADY                   8        RW            0        Crystal Oscillator Ready interrupt enable
 IRQMWAKEUPTIMER                 9        RW            0        Wakeup Timer interrupt enable
 IRQMLPOSC                      10        RW            0        Low Power Oscillator interrupt enable
 IRQMGPADC                      11        RW            0        GPADC interrupt enable
 IRQMPLLRNGDONE                 12        RW            0        PLL autoranging done interrupt enable
   Zero disables the corresponding interrupt, while one enables it.
RADIOEVENTMASK1, RADIOEVENTMASK0
 Table 31. RADIOEVENTMASK1, RADIOEVENTMASK0
           Name                Bits       R/W         Reset                                   Description
 REVMDONE                       0         RW            0        Transmit or Receive Done Radio Event Enable
 REVMSETTLED                    1         RW            0        PLL Settled Radio Event Enable
 REVMRADIOSTATECHG              2         RW            0        Radio State Changed Event Enable
 REVMRXPARAMSETCHG              3         RW            0        Receiver Parameter Set Changed Event Enable
 REVMFRAMECLK                   4         RW            0        Frame Clock Event Enable
IRQINVERSION1, IRQINVERSION0
 Table 32. IRQINVERSION1, IRQINVERSION0
           Name                Bits       R/W         Reset                                   Description
 IRQINVFIFONOTEMPTY             0         RW            0        FIFO not empty interrupt inversion
 IRQINVFIFONOTFULL              1         RW            0        FIFO not full interrupt inversion
 IRQINVFIFOTHRCNT               2         RW            0        FIFO count > threshold interrupt inversion
 IRQINVFIFOTHRFREE              3         RW            0        FIFO free > threshold interrupt inversion
 IRQINVFIFOERROR                4         RW            0        FIFO error interrupt inversion
 IRQINVPLLUNLOCK                5         RW            0        PLL lock lost interrupt inversion
 IRQINVRADIOCTRL                6         RW            0        Radio Controller interrupt inversion
 IRQINVPOWER                    7         RW            0        Power interrupt inversion
 IRQINVXTALREADY                8         RW            0        Crystal Oscillator Ready interrupt inversion
 IRQINVWAKEUPTIMER              9         RW            0        Wakeup Timer interrupt inversion
 IRQINVLPOSC                    10        RW            0        Low Power Oscillator interrupt inversion
 IRQINVGPADC                    11        RW            0        GPADC interrupt inversion
 IRQINVPLLRNGDONE               12        RW            0        PLL autoranging done interrupt inversion
                                                     www.onsemi.com
                                                             35
                                                          AND9347/D
IRQREQUEST1, IRQREQUEST0
 Table 33. IRQREQUEST1, IRQREQUEST0
            Name                  Bits       R/W        Reset                                     Description
 IRQRQFIFONOTEMPTY                  0          R           −         FIFO not empty interrupt pending
 IRQRQFIFONOTFULL                   1          R           −         FIFO not full interrupt pending
 IRQRFIFOTHRCNT                     2          R           −         FIFO count > threshold interrupt pending
 IRQRFIFOTHRFREE                    3          R           −         FIFO free > threshold interrupt pending
 IRQRFIFOERROR                      4          R           −         FIFO error interrupt pending
 IRQRQPLLUNLOCK                     5          R           −         PLL lock lost interrupt pending
 IRQRRADIOCTRL                      6          R           −         Radio Controller interrupt pending
 IRQRPOWER                          7          R           −         Power interrupt pending
 IRQRXTALREADY                      8          R           −         Crystal Oscillator Ready interrupt pending
 IRQRWAKEUPTIMER                    9          R           −         Wakeup Timer interrupt pending
 IRQRLPOSC                         10          R           −         Low Power Oscillator interrupt pending
 IRQRGPADC                         11          R           −         GPADC interrupt pending
 IRQRQPLLRNGDONE                   12          R           −         PLL autoranging done interrupt pending
RADIOEVENTREQ1, RADIOEVENTREQ0
 Table 34. RADIOEVENTREQ1, RADIOEVENTREQ0
            Name                  Bits       R/W        Reset                                     Description
 REVRDONE                           0         RC           −         Transmit or Receive Done Radio Event Pending
 REVRSETTLED                        1         RC           −         PLL Settled Radio Event Pending
 REVRRADIOSTATECHG                  2         RC           −         Radio State Changed Event Pending
 REVRRXPARAMSETCHG                  3         RC           −         Receiver Parameter Set Changed Event Pending
 REVRFRAMECLK                       4         RC           −         Frame Clock Event Pending
   The bits in this register are cleared upon reading this register.
Modulation and Framing
MODULATION
 Table 35. MODULATION
            Name                  Bits       R/W        Reset                                     Description
 REVRDONE                           0         RC           −         Transmit or Receive Done Radio Event Pending
 MODULATION                        3:0       RW          1000        See table 36: Modulation Bit Values
 RX HALFSPEED                       4        RW            0         If set, halves the receive bitrate
 Table 36. MODULATION BIT VALUES
        Bits                           Inputs                            Transmitter amplitude shaping is set using the
        0000                             ASK
                                                                      MODCFGA register, and frequency shaping is set using the
                                                                      MODCFGF register.
        0001                        ASK Coherent
        0100                             PSK
        0110                            OQSK
        0111                            MSK
        1000                             FSK
        1001                           4−FSK
        1010                            AFSK
        1011                             FM
                                                       www.onsemi.com
                                                                36
                                                             AND9347/D
ENCODING
 Table 37. ENCODING
           Name                    Bits         R/W          Reset                                   Description
 ENC INV                             0           RW             0         Invert data if set to 1
 ENC DIFF                            1           RW             1         Differential Encode/Decode data if set to 1
 ENC SCRAM                           2           RW             0         Enable Scrambler/Descrambler if set to 1
 ENC MANCH                           3           RW             0         Enable manchester encoding/decoding. FM0/FM1 may be
                                                                          achieved by also appropriately setting ENC DIFF and ENC INV
 ENC NOSYNC                          4           RW             0         Disable Dibit synchronisation in 4−FSK mode
                            0    1     2   3   4                 5   6    7    8    9 10 11 12 13 14 15 16
                                            Figure 17. Scrambler Schematic Diagram
                      0   1    2    3    4   5   6   7    8  9 10 11                      12 13 14 15 16
                                           Figure 18. Descrambler Schematic Diagram
  The intention of the scrambler is the removal of tones                    ENC NOSYNC should normally be set to zero, unless the
contained in the transmit data, i.e. to randomize the transmit           chip is either in the RXFRAMING or TXFRAMING mode
spectrum. The scrambler polynomial is 1 + X12 + X17, it is               and PWRUP is not used as a synchronisation signal.
therefore compatible to the K9NG/G3RUH Satellite                            Figure 19 shows a few well known encodinf formats used
Modems.                                                                  in telecom.
  Figure 17 and Figure 18 show schematic diagrams of the
scrambler and the descrambler operation. The numbered
boxes represent delays by one bit.
                                                      1     1       0       0      1       0
                                               NRZ
                                              NRZI
                                               FM1
                                   (Biphase Mark)
                                               FM0
                                  (Biphase Space)
                                        Manchester
                                                    Figure 19. Customary Encodings
 Table 38. CUSTOMARY ENCODING MODES DESCRIPTION
       Name                    Bits                                                      Description
 NRZ                 INV = 0, DIFF = 0,         NRZ represents 1 as a high signal level, 0 as a low signal level. NRZ performs no change.
                     SCRAM = 0,
                     MANCH = 0
 NRZI                INV = 1, DIFF =1,          NRZI represents 1 as no change in the signal level, and 0 as a change in the signal level.
                     SCRAM = 0,                 NRZI is recommended for HDLC [1]. The HDLC bit stuffing ensures that there are periodic
                     MANCH = 0                  zeros and thus transitions, and the encoding is inversion invariant.
                                                          www.onsemi.com
                                                                    37
                                                              AND9347/D
 Table 38. CUSTOMARY ENCODING MODES DESCRIPTION(continued)
       Name                    Bits                                                       Description
 FM1                 INV = 1, DIFF = 1,        FM1 (Biphase Mark) always ensures transitions at bit edges. It encodes 1 as a transition
                     SCRAM = 0,                at the bit center, and 0 as no transition at the bit center.
                     MANCH = 1
 FM0                 INV = 0, DIFF = 1,        FM0 (Biphase Space) always ensures transitions at bit edges. It encodes 1 as no
                     SCRAM = 0,                transition at the bit center, and 0 as a transition at the bit center.
                     MANCH = 1
 Manchester          INV = 0, DIFF = 0,        Manchester encodes 1 as a 10 pattern, and 0 as a 01 pattern. Manchester is not inversion
                     SCRAM = 0,                invariant.
                     MANCH = 1
  Guidelines:
• Manchester, FM0, and FM1 are not recommended for                        • In Raw modes, the choice depends on the legacy
  new systems, as they double the bitrate.                                    system to be implemented.
• In HDLC [1] mode, use NRZI, NRZI + Scrambler, or
  NRZ + Scrambler.
FRAMING
 Table 39. FRAMING
            Name                   Bits         R/W            Reset                                    Description
 FABORT                              0           S               0         Write 1 to abort current HDLC [1] packet / pattern match
 FRMMODE                            3:1         RW              000        See Table 40: FRMMODE Bit Values
 CRCMODE                            6:4         RW              000        See Table 41: CRCMODE Bit Values
 FRMRX                               7           R               −         Packet start detected, receiver running; this bit is set when a flag
                                                                           is detected in HDLC [1] mode or when the preamble matches in
                                                                           Raw Pattern Match mode. Cleared by writing 1 to FABORT.
 Table 40. FRMMODE BIT VALUES                                               Table 41. CRCMODE BIT VALUES
     Bits                           Meaning                                        Bits                              Meaning
     000                               Raw                                         000                                  Off
     001                         Raw, Soft Bits                                    001                            CCITT (16 bit)
     010                            HDLC [1]                                       010                                CRC−16
      011                     Raw, Pattern Match                                   011                             DNP (16 bit)
     100                        Wireless M-Bus                                     110                                CRC−32
     101                Wireless M-Bus, 4-to-6 Encoding
NOTE: The wireless M-Bus definition of “Manchester”                       NOTE: If FRMMODE is set to Raw, Soft Bits, register
          is inverse to the definition used by the AX5043.                            F72 must be set to 0x06. Otherwise, it should be
          AX5043 defines “Manchester” as the                                          left or set to 0x00.
          transmission of the data bit followed by the
          transmission of the inverted data bit. Wireless
          M-Bus defines it the other way around. In order
          to avoid having to enable inversion in the
          ENCODING register, the AX5043 inverts
          normal data bits when FRMMODE is set to
          Wireless M-Bus.
                                                           www.onsemi.com
                                                                      38
                                                          AND9347/D
CRCINIT3, CRCINIT2, CRCINIT1, CRCINIT0
 Table 42. CRCINIT3, CRCINIT2, CRCINIT1, CRCINIT0
              Name                Bits       R/W             Reset                                Description
 CRCINIT                          31:0       RW          0xFFFFFFFF       CRC Reset Value; normally all ones
Forward Error Correction
FEC
 Table 43. FEC
              Name                Bits       R/W             Reset                                Description
 FECENA                            0         RW                 0         Enable FEC (Convolutional Encoder)
 FECINPSHIFT                      3:1        RW               000         Attenuate soft Rx Data by 2-FECINPSHIFT
 FECPOS                            4         RW                 0         Enable noninverted Interleaver Synchronisation
 FECNEG                            5         RW                 0         Enable inverted Interleaver Synchronisation
 RSTVITERBI                        6         RW                 0         Reset Viterbi Decoder
 SHORTMEM                          7         RW                 0         Shorten Backtrack Memory
                                                                                                                      g1
                          D Q            D Q              D Q              D Q
                           Q'             Q'               Q'                Q'
                                                                                                                      g2
                               Figure 20. Schematic Diagram of the Convolutional Encoder
  FECENA enables the Forward Error Correction and the                   In the Transmitter, HDLC [1] flags are aligned (by
Interleaver.                                                         inserting zero bits) to the interleaver. In the Receiver,
  The Interleaver is a 4 x 4 matrix interleaver, i.e. transmit       a convolver to the encoded/interleaved flag sequence
bits are filled in row-wise and read out column-wise.                establishes deinterleaver synchronisation and inversion
  The Convolutional Code is a nonsystematic Rate 1⁄2 code              detection. That means, that FEC only works with HDLC
with the generators g1 = 1 + D3 + D4 and g2 = 1 + D + D2 +           framing.
D4. It has a minimum free distance of dfree = 7. Figure 20              The Viterbi decoder uses soft metric.
shows a schematic diagram of the convolutional encoder.
FECSYNC
 Table 44. FECSYNC
              Name               Bits        R/W           Reset                                 Description
 FECSYNC                          7:0        RW          01100010     Interleaver Synchronisation Threshold
FECSTATUS
 Table 45. FECSTATUS
              Name               Bits        R/W           Reset                                 Description
 MAXMETRIC                        6:0         R               −       Metric increment of the survivor path
 FEC INV                           7          R               −       Inverted Synchronisation Sequence received
                                                        www.onsemi.com
                                                                  39
                                                  AND9347/D
Status
RADIOSTATE
 Table 46. RADIOSTATE
            Name           Bits        R/W         Reset                                Description
 RADIO STATE               3:0           R          0000    See Table 47: Radio Controller State Bit Values
 Table 47. RADIOSTATE BIT VALUES
         Bits                     Meaning
        0000                        Idle
        0001                     Powerdown
        0100                   Tx PLL Settings
         0110                        Tx
         0111                      Tx Tail
        1000                   Rx PLL Settings
        1001                Rx Antenna Selection
         1100                  Rx Preamble 1
         1101                  Rx Preamble 2
         1110                  Rx Preamble 3
         1111                        Rx
XTALSTATUS
 Table 48. XTALSTATUS
            Name           Bits        R/W         Reset                                Description
 XTAL RUN                    0           R           −      1 indicates crystal oscillator running and stable
Pin Configuration
PINSTATE
 Table 49. PINSTATE
            Name           Bits        R/W         Reset                                Description
 PSSYSCLK                    0           R           −      Signal Level on Pin SYSCLK
 PSDCLK                      1           R           −      Signal Level on Pin DCLK
 PSDATA                      2           R           −      Signal Level on Pin DATA
 PSIRQ                       3           R           −      Signal Level on Pin IRQ
 PSANTSEL                    4           R           −      Signal Level on Pin ANTSEL
 PSPWRAMP                    5           R           −      Signal Level on Pin PWRAMP
PINFUNCSYSCLK
 Table 50. PINFUNCSYSCLK
            Name           Bits        R/W         Reset                                Description
 PFSYSCLK                  4:0          RW         01000    See Table 51: PFSYSCLK Bit Values
 PUSYSCLK                   7           RW           0      SYSCLK weak Pullup enable
 Table 51. PFSYSCLK BIT VALUES
         Bits                     Meaning
        0000                        Idle
        00000                SYSCLK Output ‘0’
        00001                SYSCLK Output ‘1’
                                                 www.onsemi.com
                                                         40
                                                         AND9347/D
 Table 51. PFSYSCLK BIT VALUES (continued)
        00010                  SYSCLK Output ‘Z’
        00011            SYSCLK Output inverted fXTAL
        00100                 SYSCLK Output fXTAL
        00101                                      p XTAL
                                 SYSCLK Output
                                                      2
        00110                                      p XTAL
                                 SYSCLK Output
                                                       4
        00111                                      p XTAL
                                 SYSCLK Output
                                                       8
        01000                                      p XTAL
                                 SYSCLK Output
                                                      16
        01001                                      p XTAL
                                 SYSCLK Output
                                                      32
        01010                                      p XTAL
                                 SYSCLK Output
                                                     64
        01011                                      p XTAL
                                 SYSCLK Output
                                                     128
        01100                                      p XTAL
                                 SYSCLK Output
                                                     256
        01101                                       p XTAL
                                 SYSCLK Output
                                                     512
        01110                                      p XTAL
                                 SYSCLK Output
                                                    1024
        01111       SYSCLK Output Low Power (LP) Oscillator
        11111           SYSCLK Output Test Observation
PINFUNCDCLK
 Table 52. PINFUNCDCLK
            Name             Bits          R/W           Reset                           Description
 PFDCLK                       2:0           RW             100    See Table 53: PFDCLK Bit Values
 PIDCLK                        6            RW              0     DCLK inversion
 PUDCLK                        7            RW              0     DCLK weak Pullup enable
 Table 53. PFDCLK BIT VALUES
         Bits                        Meaning
         000                     DCLK Output ‘0’
         001                     DCLK Output ‘1’
         010                     DCLK Output ‘Z’
         011       DCLK Output Modem Data Clock Input; use
                     when inputting/outputting framing data on
                                        DATA
         100         DCLK Output Modem Data Clock Output;
                    use when observing modem data on DATA
         101         DCLK Output Modem Data Clock Output;
                    use when inputting/outputting framing data
                    on DATA, and you do not want to generate
                                  a clock yourself
         110                           invalid
         111             DCLK Output Test Observation
                                                       www.onsemi.com
                                                               41
                                                     AND9347/D
PINFUNCDATA
 Table 54. PINFUNCDATA
             Name            Bits        R/W         Reset                             Description
 PFDATA                      3:0          RW          0111    See Table 55: PFDCLK Bit Values
 PIDATA                       6           RW           0      DATA inversion
 PUDATA                       7           RW           1      DATA weak Pullup enable
 Table 55. PFDATA BIT VALUES
         Bits                       Meaning
         0000                   DATA Output ‘0’
         0001                   DATA Output ‘1’
         0010                   DATA Output ‘Z’
         0011           DATA Input/Output Framing Data
         0100           DATA Input/Output Modem Data
         0101         DATA Input/Output Async Modem Data
         0110                        Invalid
         0111              DATA Output Modem Data
         1111            DATA Output Test Observation
  In Asynchronous Wire Mode, the maximum bitrate is
limited to .
PINFUNCIRQ
 Table 56. PINFUNCIRQ
             Name            Bits        R/W         Reset                             Description
 PFIRQ                       2:0          RW          011     See Table 57: PFIRQ Bit Values
 PIIRQ                        6           RW           0      IRQ inversion
 PUIRQ                        7           RW           0      IRQ weak Pullup enable
 Table 57. PFIRQ BIT VALUES
         Bits                       Meaning
          000                     IRQ Output ‘0’
          001                     IRQ Output ‘1’
          010                     IRQ Output ‘Z’
          011            IRQ Output Interrupt Request
          111             IRQ Output Test Observation
PINFUNCANTSEL
 Table 58. PINFUNCANTSEL
             Name            Bits        R/W         Reset                             Description
 PFANTSEL                    2:0          RW          110     See Table 59: PFANTSEL Bit Values
 PIANTSEL                     6           RW           0      ANTSEL inversion
 PUANTSEL                     7           RW           0      ANTSEL weak Pullup enable
 Table 59. PFANTSEL BIT VALUES
         Bits                       Meaning
          000                  ANTSEL Output ‘0’
                                                  www.onsemi.com
                                                           42
                                                      AND9347/D
 Table 59. PFANTSEL BIT VALUES (continued)
         001                    ANTSEL Output ‘1’
         010                   ANTSEL Output ‘Z’
         011          ANTSEL Output Baseband Tune Clock
         100         ANTSEL Output External TCXO Enable
         101                  ANTSEL Output DAC
         110        ANTSEL Output Diversity Antenna Select
         111             ANTSEL Output Test Observation
PINFUNCPWRAMP
 Table 60. PINFUNCPWRAMP
           Name            Bits        R/W           Reset                               Description
 PFPWRAMP                  3:0         RW            0110       See Table 61: PFPWRAMP Bit Values
 PIPWRAMP                   6          RW              0        PWRAMP inversion
 PUPWRAMP                   7          RW              0        PWRAMP weak Pullup enable
 Table 61. PFPWRAMP BIT VALUES
         Bits                       Meaning
        0000                  PWRAMP Output ‘0’
        0001                  PWRAMP Output ‘1’
        0010                  PWRAMP Output ‘Z’
        0011           PWRAMP Input DiBit Synchronisation
                      (4−FSK); use when inputting/outputting
                          4−FSK framing data on DATA
        0100         PWRAMP Output DiBit Synchronisation
                       (4−FSK); use when observing 4−FSK
                              modem data on DATA
        0101                 PWRAMP Output DAC
        0110        PWRAMP Output Power Amplifier Control
        0111         PWRAMP Output External TCXO Enable
         1111           PWRAMP Output Test Observation
PWRAMP
 Table 62. PWRAMP
            Name             Bits        R/W          Reset                               Description
 PWRAMP                        0         RW               0      Power Amplifier Control
  The PWRAMP bit may be output on the PWRAMP pin.
This signal may be used to control an external power
amplifier.
                                                   www.onsemi.com
                                                             43
                                                      AND9347/D
FIFO Registers
FIFOSTAT
 Table 63. FIFOSTAT
            Name              Bits         R/W        Reset                                Description
 FIFO EMPTY                     0           R           1      FIFO is empty if 1. This bit is dangerous to use when
                                                               PWRMODE is set to Receiver Wake-on-Radio mode. In this
                                                               mode, the FIFO and thus the FIFOSTAT register is only powered
                                                               up while the FIFO is not empty, and powered down immediately
                                                               when the FIFO becomes empty. When powered down, reading
                                                               FIFOSTAT returns zero, indicating a non-empty FIFO while in
                                                               reality the FIFO is empty. In Wake-on-Radio mode, it is
                                                               recommended to use the IRQRQFIFONOTEMPTY bit of
                                                               Register IRQREQUEST0. This bit will work in all cases, even
                                                               when the interrupt is masked.
 FIFO FULL                      1           R           0      FIFO is full if 1
 FIFO UNDER                     2           R           0      FIFO underrun occured since last read of FIFOSTAT when 1
 FIFO OVER                      3           R           0      FIFO overrun occured since last read of FIFOSTAT when 1
 FIFO CNT THR                   4           R           0      1 if the FIFO count is > FIFOTHRESH
 FIFO FREE THR                  5           R           0      1 if the FIFO free space is > FIFOTHRESH
 FIFOCMD                       5:0          W           −      See Table 64: FIFOCMD Bit Values
 FIFO AUTO COMMIT               7          RW           0      If one, FIFO write bytes are automatically commited on every
                                                               write
 Table 64. FIFOCMD BIT VALUES
         Bits                        Meaning
        000000                     No Operation
        000001                     ASK Coherent
        000010         Clear FIFO Error (OVER and UNDER)
                                       Flags
        000011              Clear FIFO Data and Flags
        000100                       Commit
        000101                       Rollback
        000110                        Invalid
        000111                        Invalid
       001XXX                         Invalid
       01XXXX                         Invalid
       1XXXXX                         Invalid
FIFODATA
 Table 65. FIFODATA
            Name              Bits         R/W        Reset                                Description
 FIFODATA                      7:0         RW           −      FIFO access register
  Note that when accessing this register, the SPI address
pointer is not incremented, allowing for efficient burst
accesses.
                                                   www.onsemi.com
                                                            44
                                                           AND9347/D
FIFOCOUNT1, FIFOCOUNT0
 Table 66. FIFOCOUNT1, FIFOCOUNT0
             Name                   Bits         R/W           Reset                             Description
 FIFOCOUNT                          8:0            R             −      Current number of committed FIFO Words
FIFOFREE1, FIFOFREE0
 Table 67. FIFOFREE1, FIFOFREE0
            Name                  Bits          R/W          Reset                               Description
 FIFOFREE                          8:0           R             −       Current number of empty FIFO Words
FIFOTHRESH1, FIFOTHRESH0
 Table 68. FIFOTHRESH1, FIFOTHRESH0
            Name                  Bits          R/W          Reset                               Description
 FIFOFRESH                         8:0           R        000000000    FIFO Threshold
Synthesizer
PLLLOOP, PLLLOOPBOOST
  The PLLLOOP and PLLLOOPBOOST select PLL Loop                       mode. All fields in this register are separate, except for
Filter configuration for both normal mode and boosted                FREQSEL, which is common to both registers.
 Table 69. PLLLOOP, PLLLOOPBOOST
            Name                  Bits          R/W         Reset                               Description
 FLT                               1:0          RW            01     See Table 70: FLT and FLTBOOST Bit Values
 FLTBOOST                                                     11
 FILTEN                             2           RW            0      Enable External Filter Pin
 FILTENBOOST                                                  0
 DIRECT                             3           RW            1      Bypass External Filter Pin
 DIRECTBOOST                                                  1
 FREQSEL                            7           RW            0      Frequency Register Selection; 0 = use FREQA, 1 = use FREQB
 Table 70. FLT AND FLTBOOST BIT VALUES
         Bits                             Meaning
          00                        External Loop Filter
          01              Internal Loop Filter, BW = 100 kHz for
                                         ICP = 68 A
          10            Internal Loop Filter x2, BW = 200 kHz for
                                       ICP = 272 mA
          11            Internal Loop Filter x5, BW = 500 kHz for
                                       ICP = 1.7 mA
PLLCPI, PLLCPIBOOST
 Table 71. PLLCPI, PLLCPIBOOST
            Name                  Bits          R/W         Reset                               Description
 PLLCPI                            7:0          RW        00001000   Charge pump current in multiples of 8.5μA
 PLLCPIBOOST                                              11001000
                                                         www.onsemi.com
                                                                  45
                                                         AND9347/D
PLLVCODIV
 Table 72. PLLVCODIV
            Name                Bits        R/W         Reset                                   Description
 REFDIV                          1:0         RW           00      See Table 73: REFDIV Bit Value
 RFDIV                            2          RW            0      RF divider: 0 = no RF divider, 1 = divide RF by 2
 VCOSEL                           4          RW            0      0 = fully internal VCO1, 1 = internal VCO2 with external inductor
                                                                  or external VCO, depending on VCO2INT
 VCO2INT                          5          RW            0      1 = internal VCO2 with external Inductor, 0 = external VCO
 Table 73. REFDIV BIT VALUES
          Bits                          Meaning
           00                          p PD + p XTAL
           01                                 p XTAL
                                       p PD +
                                                 2
           10                                 p XTAL
                                       p PD +
                                                 4
           11                                 p XTAL
                                       p PD +
                                                 8
PLLRANGINGA, PLLRANGINGB
 Table 74. PLLRANGINGA, PLLRANGINGB
             Name                Bits        R/W         Reset                                   Description
 VCORA                            3:0         RW          1000     VCO Range; depending on bit FREQSEL of PLLLOOP, VCORA
                                                                   or VCORB is used
 VCORB                                                    1000
 RNG START                         4          RS            0      PLL Autoranging; Write 1 to start autoranging, bit clears when
                                                                   autoranging done. Autoranging always applies to the VCOR
                                                                   selected by FREQSEL of PLLLOOP.
 RNGERR                            5           R            −      Ranging Error; Set when RNG START transitions from 1 to 0
                                                                   and the programmed frequency cannot be achieved
 PLL LOCK                          6           R            −      PLL is locked if 1
 STICKY LOCK                       7           R            −      if 0, PLL lost lock after last read of PLLRANGINGA or
                                                                   PLLRANGINGB register
FREQA3, FREQA2, FREQA1, FREQA0
 Table 75. FREQA3, FREQA2, FREQA1, FREQA0
             Name                Bits         R/W           Reset                                  Description
 FREQA                           31:0         RW        0x3934CCCD
                                                                                Frequency;          FREQA +   ƪp CARRIER
                                                                                                                  p XTAL
                                                                                                                           2 24 )
                                                                                                                                  1
                                                                                                                                  2
                                                                                                                                    ƫ
  It is not recommended to use an RF frequency that is an             It is strongly recommended to always set bit 0 to avoid
integer multiple of the reference frequency, due to stray RF      spectral tones.
desensitizing the receiver.
FREQB3, FREQB2, FREQB1, FREQB0
 Table 76. FREQB3, FREQB2, FREQB1, FREQB0
             Name                Bits         R/W           Reset                                  Description
            FREQB                31:0         RW        0x3934CCCD
                                                                                Frequency;          FREQB +   ƪ p CARRIER
                                                                                                                  p XTAL
                                                                                                                           2 24 )
                                                                                                                                  1
                                                                                                                                  2
                                                                                                                                    ƫ
  See notes of FREQA register.
                                                      www.onsemi.com
                                                               46
                                                        AND9347/D
Signal Strength
RSSI
 Table 77. RSSI
           Name                   Bits       R/W        Reset                               Description
 RSSI                             7:0         R            −      Received Signal Strength, in dB
BGNDRSSI
 Table 78. BGNDRSSI
           Name                   Bits       R/W        Reset                               Description
 BGNDRSSI                         7:0        RW       00000000    Background Noise (RSSI)
DIVERSITY
 Table 79. DIVERSITY
           Name                   Bits       R/W        Reset                               Description
 DIVENA                            0         RW            0      Antenna Diversity Enable
 ANTSEL                            1         RW            0      Antenna Select
  DIVENA enables the internal antenna diversity logic.             The ANTSEL bit may be output on pin ANTSEL, and this
                                                                 signal may be used to control an external antenna switch.
AGCCOUNTER
 Table 80. AGCCOUNTER
           Name                   Bits       R/W        Reset                               Description
 AGCCOUNTER                       7:0         R            −      Current AGC Gain, in 0.75 dB steps
Receiver Tracking
TRKDATARATE2, TRKDATARATE1, TRKDATARATE0
 Table 81. TRKDATARATE2, TRKDATARATE1, TRKDATARATE0
           Name                  Bits       R/W        Reset                                Description
 TRKDATARATE                     23:0        R            −      Current datarate tracking value
TRKAMPL1, TRKAMPL0
 Table 82. TRKAMPL1, TRKAMPL0
           Name                   Bits       R/W        Reset                               Description
 TRKAMPL                          15:0        R             −     Current amplitude tracking value
TRKPHASE1, TRKPHASE0
 Table 83. TRKPHASE1, TRKPHASE0
           Name                   Bits       R/W        Reset                               Description
 TRKPHASE                         11:0        R             −     Current phase tracking value
TRKRFFREQ2, TRKRFFREQ1, TRKRFFREQ0
 Table 84. TRKRFFREQ2, TRKRFFREQ1, TRKRFFREQ0
           Name                   Bits       R/W        Reset                               Description
 TRKRFFREQ                        19:0       RW             −     Current RF frequency tracking value
  This Register is reset to zero when the demodulator is not     demodulator and the microcontroller with undefined results,
running. In order to avoid write collisions between the          TRKFREQ should be frozen before attempting to write to.
                                                    www.onsemi.com
                                                              47
                                                         AND9347/D
To freeze, set the RFFREQFREEZE bit in the appropriate                                                                 1
                                                                  FREQGAIND3 register, then wait for            4   BAUDRATE
                                                                                                                               for
FREQGAIND0,          FREQGAIND1,FREQGAIND2,                or
                                                                  the freeze to take effect.
TRKFREQ1, TRKFREQ0
 Table 85. TRKFREQ1, TRKFREQ0
            Name                  Bits      R/W           Reset                               Description
 TRKFREQ                          15:0       RW              −     Current frequency tracking value
  The     current     frequency      offset   estimate      is    TRKFREQ should be frozen before attempting to write to.
                    TRKFREQ                                       To freeze, set the FREQFREEZE bit in the appropriate
              Dp +               BITRATE
                        2 16                                      FREQGAINB0,             FREQGAINB1,FREQGAINB2,                or
  This Register is reset to zero when the demodulator is not                                                           1
                                                                  FREQGAINB3 register, then wait for            4   BAUDRATE
                                                                                                                               for
running. In order to avoid write collisions between the
demodulator and the microcontroller with undefined results,       the freeze to take effect.
TRKFSKDEMOD1, TRKFSKDEMOD0
 Table 86. TRKFSKDEMOD1, TRKFSKDEMOD0
            Name                  Bits      R/W           Reset                               Description
 TRKFSKDEMOD                      13:0        R              −     Current FSK demodulator value
TRKAFSKDEMOD1, TRKAFSKDEMOD0
 Table 87. TRKAFSKDEMOD1, TRKAFSKDEMOD0
            Name                  Bits      R/W           Reset                               Description
 TRKAFSKDEMOD                     15:0        R              −     Current AFSK demodulator value
Tracking Register Resets
  Writes to TRKAMPL1, TRKAMPL0, TRKPHASE1,
TRKPHASE0, TRKDATARATE2, TRKDATARATE1,
TRKDATARATE0 cause the following action:
 Table 88. TRACKING REGISTER RESET
            Name                  Bits      R/W          Reset                                Description
 DTRKRESET                         3         W              −      Writing 1 clears the Datarate Tracking Register
 ATRKRESET                         4         W              −      Writing 1 clears the Amplitude Tracking Register
 PTRKRESET                         5         W              −      Writing 1 clears the Phase Tracking Register
 RTRKRESET                         6         W              −      Writing 1 clears the RF Frequency Tracking Register
 FTRKRESET                         7         W              −      Writing 1 clears the Frequency Tracking Register
Timer
TIMER2, TIMER1, TIMER0
  The main purpose of the fast μs Timer is to enable the          snapshot of this timer at packet start can be written to the
microcontroller to exactly determine the packet start time. A     FIFO.
 Table 89. TIMER2, TIMER1, TIMER0
            Name                  Bits      R/W          Reset                                Description
 TIMER                            23:0        R              −     1 MHz (fXTAL / 16) Counter; starts counting as soon as modem
                                                                   voltage regulator and Crystal Oscillator running
                                                       www.onsemi.com
                                                               48
                                                        AND9347/D
Wakeup Timer                                                     counting frequency can be set to 640 Hz or 10.24 kHz
   The wakeup timer is a low power timer that can generate       (register LPOSCCONFIG).
periodic events. It can generate a microcontroller interrupt        Whenever the WAKEUPTIMER register matches the
(register IRQMASK1) or start the receiver in wake-on-radio       WAKEUP register, an event is signalled, and the
mode (register PWRMODE). The interrupt can be cleared            WAKEUPFREQ register is added to the WAKEUP register,
by reading or writing any wakeup timer register.                 to prepare for the next wakeup event.
   The wakeup timer is driven by the low power oscillator.          Since crystals often take a significant amount of time to
At every low power oscillator clock edge, the                    start up, the crystal oscillator may be started early using the
WAKEUPTIMER register is incremented by 1. The                    WAKEUPXOEARLY register.
WAKEUPTIMER1, WAKEUPTIMER0
 Table 90. WAKEUPTIMER1, WAKEUPTIMER0
            Name                 Bits       R/W          Reset                                Description
 WAKEUPTIMER                     15:0        R             −      Wakeup Timer
WAKEUP1, WAKEUP0
 Table 91. WAKEUP1, WAKEUP0
            Name                 Bits       R/W          Reset                                Description
 WAKEUP                          15:0       RW          0x0000    Wakeup Time
WAKEUPFREQ1, WAKEUPFREQ0
 Table 92. WAKEUPFREQ1, WAKEUPFREQ0
            Name                 Bits       R/W          Reset                                Description
 WAKEUPFREQ                      15:0       RW          0x0000    Wakeup Frequency; Zero disables Wakeup
WAKEUPXOEARLY
 Table 93. WAKEUPXOEARLY
            Name                 Bits       R/W          Reset                                Description
 WAKEUPXOEARLY                    7:0       RW           0x00     Number of LPOSC clock cycles by which the Crystal Oscillator
                                                                  is woken up before the main receiver
Receiver Parameters
IFFREQ1, IFFREQ0
 Table 94. IFFREQ1, IFFREQ0
            Name                 Bits       R/W          Reset                                Description
 IFFREQ                          15:0       RW          0x1327
                                                                  IF Frequency;       IFFREQ +     ƪp IF    p XTALDIV
                                                                                                          p XTAL
                                                                                                                      2 20 )
                                                                                                                             1
                                                                                                                             2
                                                                                                                               ƫ
   Please use the AX_RadioLab software to calculate the
optimum IF frequency for given physical layer parameters.
DECIMATION
 Table 95. DECIMATION
            Name                 Bits       R/W          Reset                                Description
 DECIMATION                       6:0       RW         0001101    Filter Decimation factor; Filter Output runs at
                                                                                                   p XTAL
                                                                     p BASEBAND + 4
                                                                                     2    p XTALDIV      DECIMATION
                                                                  The value 0 is illegal.
                                                     www.onsemi.com
                                                              49
                                                             AND9347/D
RXDATARATE2, RXDATARATE1, RXDATARATE0
 Table 96. RXDATARATE2, RXDATARATE1, RXDATARATE0
           Name                   Bits        R/W        Reset                                     Description
 RXDATARATE                       23:0        RW       0x003D8A
                                                                   RXDATARATE +       ƪ p XTALDIV
                                                                                                         27
                                                                                                       BITRATE
                                                                                                                 p XTAL
                                                                                                                        DECIMATION
                                                                                                                                       )
                                                                                                                                          1
                                                                                                                                          2
                                                                                                                                            ƫ
  RXDATARATE - TIMEGAINx ≥ 212 should be ensured                       this may cause instability due to asymmetric timing
when programming. Otherwise, the hardware does it, but                 correction.
MAXDROFFSET2, MAXDROFFSET1, MAXDROFFSET0
 Table 97. MAXDROFFSET2, MAXDROFFSET1, MAXDROFFSET0
           Name                   Bits        R/W         Reset                                    Description
 MAXDROFFSET                      23:0        RW        0x00009E
                                                                    MAXDROFFSET +        ƪ p XTALDIV
                                                                                                    27    p XTAL
                                                                                                         BITRATE 2
                                                                                                                       DBITRATE
                                                                                                                          DECIMATION
                                                                                                                                          )
                                                                                                                                              1
                                                                                                                                              2
                                                                                                                                                ƫ
  The maximum bitrate offset the receiver is able to tolerate          BITRATE should only be chosen as large as the
can be specified by the parameter BITRATE. The receiver               transmitters require. If the bitrate offset is less than
will be able to tolerate a data rate within the range BITRATE          approximately ±1%, receiver bitrate tracking should be
± BITRATE. The downside of increasing BITRATE is                     switched off completely by setting MAXDROFFSET to
that the required preamble length increases. Therefore,                zero, to ensure minimum preamble length.
MAXRFOFFSET2, MAXRFOFFSET1, MAXRFOFFSET0
 Table 98. MAXRFOFFSET2, MAXRFOFFSET1, MAXRFOFFSET0
            Name                    Bits        R/W         Reset                                   Description
 MAXRFOFFSET                        19:0        RW         0x01687
                                                                      MAXRFOFFSET +         ƪ p CARRIER
                                                                                                p XTAL
                                                                                                            2 24 )
                                                                                                                     1
                                                                                                                     2
                                                                                                                       ƫ
 FREQOFFSCORR                        23         RW            0       Correct frequency offset at the first LO if this bit is one; at the
                                                                      second LO if this bit is zero
  This register sets the maximum frequency offset the                  through the receiver channel filter. This limits the practically
built-in Automatic Frequency Correction (AFC) should                   usable range for the AFC circuit to approximately ±1/4 of the
handle. Set it to the maximum frequency offset between                 Filter Bandwidth. The acquisition and tracking range can be
Transmitter and Receiver. Enlarging this register increases            increased by increasing the Receiver Channel Filter
the time needed for the AFC to achieve lock. The AFC can               Bandwidth, at the expense of slightly reducing the
only achieve lock if the transmit signal partially passes              Sensitivity.
FSKDMAX1, FSKDMAX0
 Table 99. FSKDMAX1, FSKDMAX0
            Name                     Bits        R/W          Reset                                  Description
 FSKDEVMAX                           15:0        RW          0x0080      Current FSK Demodulator Max Deviation
                                                     p DEVIATION
  In manual mode, it should be set to     3   512
                                                    BAUDRATE
                                                                 .
FSKDMIN1, FSKDMIN0
 Table 100. FSKDMIN1, FSKDMIN0
            Name                     Bits        R/W          Reset                                  Description
 FSKDEVMIN                           15:0        RW          0xFF80      Current FSK Demodulator Min Deviation
                                                          www.onsemi.com
                                                                   50
                                                                  AND9347/D
  In     manual      mode,       it     should        be     set    to
              p DEVIATION
*3      512
              BAUDRATE
                           .
AFSKSPACE1, AFSKSPACE0
 Table 101. AFSKSPACE1, AFSKSPACE0
            Name                     Bits           R/W          Reset                                     Description
 AFSKSPACE                          15:0            RW          0x0040        AFSK Space (0-Bit encoding) Frequency
  For receive, the register should be computed as follows:
AFSKSPACE +     ƪ p AFSKSPACE     DECIMATION
                                          p XTAL
                                                        p XTALDIV    2 16
                                                                          )
                                                                             1
                                                                             2
                                                                               ƫ
  For transmit, the register has a slightly different
definition: AFSKSPACE +      ƪ p AFSKSPACE
                                      p XTAL
                                                 2 18
                                                      )
                                                         1
                                                         2
                                                           ƫ
AFSKMARK1, AFSKMARK0
 Table 102. AFSKMARK1, AFSKMARK0
            Name                     Bits           R/W          Reset                                     Description
 AFSKMARK                           15:0            RW          0x0075        AFSK Mark (1-Bit encoding) Frequency
  For receive, the register should be computed as follows:
AFSKMARK +     ƪ p AFSKMARK     DECIMATION
                                         p XTAL
                                                      p XTALDIV    2 16
                                                                        )
                                                                           1
                                                                           2
                                                                             ƫ
  For transmit, the register has a slightly different
definition: AFSKMARK +       ƪp AFSKMARK
                                     p XTAL
                                               2 18
                                                    )
                                                       1
                                                       2
                                                         ƫ
AFSKCTRL
 Table 103. AFSKCTRL
            Name                    Bits          R/W          Reset                                      Description
 AFSKSHIFT                          4:0            RW          00100       AFSK Detector Bandwidth;
                                                                             2    ƪlog 2( 5
                                                                                         2     BITRATE
                                                                                                             p XTAL
                                                                                                            p XTALDIV  DECIMATION
                                                                                                                                       )ƫ
                                                                           3dB corner frequency of the AFSK detector filter
                                                                           is:                      p XTAL                        (k 2 ) 2k * 2
                                                                             pc + 5                                        arccos                )
                                                                                   2     p    p XTALDIV    DECIMATION              2     (k * 1)
                                                                                           ƪAFSKSHIFT
                                                                                                2
                                                                                                     ƫ
                                                                                 k + 2*
                                                                           with
                                                               www.onsemi.com
                                                                          51
                                  AND9347/D
AMPLFILTER
 Table 104. AMPLFILTER
          Name         Bits R/W Reset                               Description
 AMPLFILTER            3:0  RW  0000   3dB corner frequency of the Amplitude (Magnitude)
                                       Lowpass Filter;
                                                              p XTAL                        (k 2 ) 2k * 2
                                       pc +                                          arccos               )
                                              25    p   p XTALDIV    DECIMATION              2    (k * 1)
                                                      AMPLFILTER
                                       with k + 2*
                                       0000: Filter bypassed
                                www.onsemi.com
                                      52
                                                                AND9347/D
FREQUENCYLEAK
 Table 105. FREQUENCYLEAK
              Name                   Bits         R/W           Reset                                 Description
 FREQUENCYLEAK                        3:0         RW            0000        Leakiness of the Baseband Frequency Recovery Loop
                                                                            (0000 = off)
RXPARAMSETS
 Table 106. RXPARAMSETS
              Name                   Bits         R/W           Reset                                Description
 RXPS0                                1:0         RW              00        RX Parameter Set Number to be used for initial settling
 RXPS1                                3:2         RW              00        RX Parameter Set Number to be used after Pattern 1 matched
                                                                            and before Pattern 0 match
 RXPS2                                5:4         RW              00        RX Parameter Set Number to be used after Pattern 0 matched
 RXPS3                                7:6         RW              00        RX Parameter Set Number to be used after a packet start has
                                                                            been detected
RXPARAMCURSET
 Table 107. RXPARAMCURSET
              Name                   Bits         R/W           Reset                                Description
 RXSI                                 1:0           R              −        RX Parameter Set Index (determines which RXPS is used)
 RXSN                                 3:2           R              −        RX Parameter Set Number (=RXPS[RXSI (1:0)])
 RXSI                                  4            R              −        Rx Parameter Set Index (special function bit), See Table 108
 Table 108. RX PARMETERS SET INDEX BIT VALUES
       RXSI Bits                            Meaning
          0XX                 Normal Function (indirection via RXPS)
           1X0                             Coarse AGC
           1X1                    Baseband Offset Acquisition
AGCGAIN0, AGCGAIN1, AGCGAIN2, AGCGAIN3
 Table 109. AGCGAIN0, AGCGAIN1, AGCGAIN2, AGCGAIN3
              Name                   Bits         R/W           Reset                                Description
 AGCATTACK0                           3:0         RW            0100        AGC gain reduction speed
 AGCATTACK1                                                     0100
 AGCATTACK2                                                      1111       AGC gain reduction speed
 AGCATTACK3                                                      1111
 AGCDECAY0                            7:4         RW            1011        AGC gain increase speed
 AGCDECAY1                                                      1011
 AGCDECAY2                                                       1111
 AGCDECAY3                                                       1111
   The 3dB corner frequency of the AGC loop is:
p 3dB +
         25    p
                p XTAL
                    p XTALDIV
                                arccos ǒ             2 ) 2 1*ACG{ATTACK|DECAY}x
                                                                               {
                                         2 ) 2 1*AGC{ATTACK|DECAY} * 2 *2AGC ATTACK|DECAY}x   Ǔ
         p XTAL                                              AGC {ATTACK|DECAY}x)
≅                         (2 *AGC{ATTACK|DECAY}x * 2 *1*2
  25    p    p XTALDIV
   The AGC{ATTACK|DECAY}x values can be computed
from the 3dB corner frequency f3dB as follows:
                                                             www.onsemi.com
                                                                      53
                                                   AND9347/D
c + cos ǒ 25   p  p XTALDIV
                 p XTALDIV
                             p 3dB
                                  Ǔ
 AGC{ATTACK|DECAY}x + * log 2(1 * c ) Ǹc 2 * 4  c ) 3))
         ǒ
≅ * log 2 1 * Ǹ1 *
                    26   p  p XTALDIV
                            p XTAL
                                      p 3bD
                                            Ǔ
                                                                A value of 0xF in the AGC{ATTACK|DECAY}x
  The recommended AGCATTACK setting is                       disables AGC update. Thus, setting the AGCGAI
f3dB ≅ ΒΙΤRΑΤΕ/10 for ASK, and f3dB ≅ ΒΙΤRΑΤΕ for            N0/AGCGAIN1/AGCGAIN2/AGCGAIN3 register to
(G)FSK.                                                      0xFF completely freezes the AGC.
  The recommended AGCDECAY setting is
f3dB ≅ ΒΙΤRΑΤΕ/100 for ASK, and f3dB ≅ ΒΙΤRΑΤΕ/10 for
(G)FSK.
AGCTARGET0, AGCTARGET1, AGCTARGET2, AGCTARGET3
 Table 110. AGCTARGET0, AGCTARGET1, AGCTARGET2, AGCTARGET3
             Name                Bits       R/W     Reset                                  Description
 AGCTARGET0                       7:0        RW   01110110    The target ADC output average magnitude is
 AGCTARGET1                                                        AGCTARGETx
                                                                 2     16
 AGCTARGET2
                                                              Note that the ADC can produce magnitudes from 0...29-1.
 AGCTARGET3
AGCAHYST0, AGCAHYST1, AGCAHYST2, AGCAHYST3
 Table 111. AGCAHYST0, AGCAHYST1, AGCAHYST2, AGCAHYST3
             Name                Bits       R/W     Reset                                  Description
 AGCAHYST0                        2:0        RW      000      This field specifies Digital Threshold Range. It is
 AGCAHYST1                                                    (AGCAHYSTx+1) 3 dB; If set to zero, the analog AGC always
                                                              follows immediately. Increasing this value gives the AGC
 AGCAHYST2
                                                              controller more leeway delay analog AGC following.
 AGCAHYST3
AGCMINMAX0, AGCMINMAX1, AGCMINMAX2, AGCMINMAX3
 Table 112. AGCMINMAX0, AGCMINMAX1, AGCMINMAX2, AGCMINMAX3
             Name                Bits       R/W     Reset                                  Description
 AGCMAXDA0                        6:4        RW      000      When the digital AGC attenuation exceeds its maximum value, it
 AGCMAXDA1                                                    is reset to the value given in AGCMAXDAx, and the analog AGC
                                                              gain is recomputed accordingly. This value is given in 3 dB
 AGCMAXDA2
                                                              steps. Setting it to AGCAHYSTx causes “drag” AGC behaviour
 AGCMAXDA3                                                    with minimum analog AGC steps (probably desirable);
                                                              decreasing it causes less frequent but larger analog AGC steps
 AGCMINDA0                        2:0        RW      000      When the digital AGC attenuation exceeds its minimum value, it
 AGCMINDA1                                                    is reset to the value given in AGCMINDAx, and the analog AGC
                                                              gain is recomputed accordingly. This value is given in 3 dB
 AGCMINDA2
                                                              steps. Setting it to 000 causes “drag” AGC behaviour with
 AGCMINDA3                                                    minimum analog AGC steps (probably desirable); increasing it
                                                              causes less frequent but larger analog AGC steps
TIMEGAIN0, TIMEGAIN1, TIMEGAIN2, TIMEGAIN3
 Table 113. TIMEGAIN0, TIMEGAIN1, TIMEGAIN2, TIMEGAIN3
             Name                Bits       R/W     Reset                                  Description
 TIMEGAIN0E                       3:0        RW     1000      Gain of the timing recovery loop; this is the exponent
 TIMEGAIN1E                                         0110
 TIMEGAIN2E                                         0101
 TIMEGAIN3E                                         0101
                                                 www.onsemi.com
                                                          54
                                                             AND9347/D
 Table 113. TIMEGAIN0, TIMEGAIN1, TIMEGAIN2, TIMEGAIN3 (continued)
            Name                 Bits         R/W             Reset                              Description
 TIMEGAIN0M                       7:4         RW               1111    Gain of the timing recovery loop; this is the mantissa
 TIMEGAIN1M
 TIMEGAIN2M
 TIMEGAIN3M
                     TIMEGAINxM, TIMEGAINxE + arg min          ŤTMGCORRFRACx
                                                                 RXDATARATE
                                                                                * TIMEGAINxM         2 TIMEGAINxE  Ť
                                                  TIMEGAINxM, E
  TMGCORRFRAC should be chosen at least 4. Larger
values result in less sampling time jitter, but slower timing
lock-in.
DRGAIN0, DRGAIN1, DRGAIN2, DRGAIN3
 Table 114. DRGAIN0, DRGAIN1, DRGAIN2, DRGAIN3
            Name                 Bits         R/W             Reset                              Description
         DRGAIN0E                 3:0         RW               0010    Gain of the datarate recovery loop; this is the exponent
         DRGAIN1E                                              0001
         DRGAIN2E                                              0000
         DRGAIN3E                                              0000
         DRGAIN0M                 7:4         RW               1111    Gain of the datarate recovery loop; this is the mantissa
         DRGAIN1M                                              1111
         DRGAIN2M                                              1111
         DRGAIN3M                                              1111
                         DRGAINxM, DRGAINxE + arg min          ŤDRGCORRFRACx
                                                                 RXDATARATE
                                                                                * DRGAINxM        2 DRGAINxE  Ť
                                                    DRGAINxM, E
  DRGCORRFRAC should be chosen at least 64. Larger
values result in less estimated datarate jitter, but slower
datarate acquisition.
PHASEGAIN0, PHASEGAIN1, PHASEGAIN2, PHASEGAIN3
 Table 115. PHASEGAIN0, PHASEGAIN1, PHASEGAIN2, PHASEGAIN3
            Name                 Bits         R/W             Reset                              Description
 PHASEGAIN0                       3:0         RW               0011    Gain of the phase recovery loop
 PHASEGAIN1
 PHASEGAIN2
 PHASEGAIN3
 FILTERIDX0                       7:6         RW                11     Decimation Filter Fractional Bandwidth, see the table below
 FILTERIDX1
 FILTERIDX2
 FILTERIDX3
  This register does not normally need to be changed.
                                                          www.onsemi.com
                                                                    55
                                                        AND9347/D
 Table 116. RELATIVE BANDWIDTH
                                                                p XTAL
                                                                                       Hz
                            Relative Bandwidth    2 16  p XTALDIV    DECIMATION
       FILTERIDXx                   −3dB BW                nominal BW                    −10dB BW                     −40dB BW
             00                     0.121399                0.150000                      0.174805                     0.256653
             01                     0.149475                0.177845                      0.202759                     0.284729
             10                     0.182373                0.210858                      0.235718                     0.317566
             11                     0.221497                0.250000                      0.274780                     0.356812
NOTE: 1. Fractional Filter Bandwidth
  The relative bandwidths in the table above need to be
                                p XTAL
multiplied with                                  to get the
                   2 16  p XTALDIV    DECIMATION
bandwidth in Hz.
FREQGAINA0, FREQGAINA1, FREQGAINA2, FREQGAINA3
 Table 117. FREQGAINA0, FREQGAINA1, FREQGAINA2, FREQGAINA3
             Name                  Bits      R/W         Reset                                   Description
 FREQGAINA0                         3:0       RW          1111       Gain of the baseband frequency recovery loop; the frequency
                                                                     error is measured with the phase detector
 FREQGAINA1                                               1111
 FREQGAINA2                                               1111
 FREQGAINA3                                               1111
 FREQAMPLGATE0                       4        RW            0        If set to 1, only update the frequency offset recovery loops if the
                                                                     amplitude of the signal is larger than half the maximum (or larger
 FREQAMPLGATE1                                              0        than the average amplitude)
 FREQAMPLGATE2                                              0
 FREQAMPLGATE3                                              0
 FREQHALFMOD0                        5        RW            0        If 1, the Frequency offset wraps around from 0x1fff to − 0x2000,
                                                                     and vice versa.
 FREQHALFMOD1                                               0
 FREQHALFMOD2                                               0
 FREQHALFMOD3                                               0
 FREQMODULO0                         6        RW            0        If 1, the Frequency offset wraps around from 0x3fff to − 0x4000,
                                                                     and vice versa.
 FREQMODULO1                                                0
 FREQMODULO2                                                0
 FREQMODULO3                                                0
 FREQLIM0                            7        RW            0        If 1, limit Frequency Offset to − 0x4000...0x3fff
 FREQLIM1                                                   0
 FREQLIM2                                                   0
 FREQLIM3                                                   0
  Set FREQGAINA0 = 15 and FREQGAINB0 = 31 to
completely disable the baseband frequency recovery loop,
setting its output to zero.
                                                       www.onsemi.com
                                                               56
                                                      AND9347/D
FREQGAINB0, FREQGAINB1, FREQGAINB2, FREQGAINB3
 Table 118. FREQGAINB0, FREQGAINB1, FREQGAINB2, FREQGAINB3
             Name              Bits      R/W          Reset                              Description
 FREQGAINB0                     4:0       RW          11111    Gain of the baseband frequency recovery loop; the frequency
                                                               error is measured with the frequency detector
 FREQGAINB1
 FREQGAINB2
 FREQGAINB3
 FREQAVG0                        6        RW             0     Average the frequency offset of two consecutive bits; this is
                                                               useful for 0101 preambles in FSK mode
 FREQAVG1
 FREQAVG2
 FREQAVG3
 FREQFREEZE0                     7        RW             0     Freeze the baseband frequency recovery loop if set
 FREQFREEZE1
 FREQFREEZE2
 FREQFREEZE3
   Set FREQGAINA0 = 15 and FREQGAINB0 = 31 to
completely disable the baseband frequency recovery loop,
FREQGAINC0, FREQGAINC1, FREQGAINC2, FREQGAINC3
 Table 119. FREQGAINC0, FREQGAINC1, FREQGAINC2, FREQGAINC3
             Name              Bits      R/W          Reset                              Description
 FREQGAINC0                     4:0       RW          01010    Gain of the RF frequency recovery loop; the frequency error is
                                                               measured with the phase detector
 FREQGAINC1                                           01011
 FREQGAINC2                                           01101
 FREQGAINC3                                           01101
   Set FREQGAINC0 = 31 and FREQGAIND0 = 31 to
completely disable the RF frequency recovery loop, setting
its output to zero.
FREQGAIND0, FREQGAIND1, FREQGAIND2, FREQGAIND3
 Table 120. FREQGAIND0, FREQGAIND1, FREQGAIND2, FREQGAIND3
             Name              Bits      R/W          Reset                              Description
 FREQGAIND0                    4:0        RW          01010    Gain of the RF frequency recovery loop; the frequency error is
                                                               measured with the frequency detector
 FREQGAIND1                                           01011
 FREQGAIND2                                           01101
 FREQGAIND3                                           01101
 RFFREQFREEZE0                   7        RW             0     Freeze the RF frequency recovery loop if set
 RFFREQFREEZE1
 RFFREQFREEZE2
 RFFREQFREEZE3
   Set FREQGAINC0 = 31 and FREQGAIND0 = 31 to
completely disable the RF frequency recovery loop, setting
its output to zero.
                                                   www.onsemi.com
                                                            57
                                                        AND9347/D
AMPLGAIN0, AMPLGAIN1, AMPLGAIN2, AMPLGAIN3
 Table 121. AMPLGAIN0, AMPLGAIN1, AMPLGAIN2, AMPLGAIN3
            Name                 Bits       R/W         Reset                                   Description
 AMPLGAIN0                       3:0        RW           0110     Gain of the amplitude recovery loop
 AMPLGAIN1
 AMPLGAIN2
 AMPLGAIN3
 AMPLAGC0                         6         RW             1      if 1, try to correct the amplitude register when AGC jumps. This
                                                                  is not perfect, though
 AMPLAGC1
 AMPLAGC2
 AMPLAGC3
 AMPLAVG0                         7         RW             0      if 0, the amplitude is recovered by a peak detector with decay;
                                                                  if 1, the amplitude is recovered by averaging
 AMPLAVG1
 AMPLAVG2
 AMPLAVG3
   This register does not normally need to be changed.
FREQDEV10, FREQDEV00, FREQDEV11, FREQDEV01, FREQDEV12, FREQDEV02, FREQDEV13, FREQDEV03
 Table 122. FREQDEVx VALUES
            Name                 Bits       R/W         Reset                                   Description
 FREQDEV0                        11:0        RW         0x020      Receiver Frequency Deviation;
 FREQDEV1
 FREQDEV2
                                                        0x020
                                                        0x020
                                                                      FREQDEVx +         ƪp DEVIATION
                                                                                                 BITRATE
                                                                                                        28    k SF
                                                                                                                   )
                                                                                                                     1
                                                                                                                     2
                                                                                                                       ƫ
                                                                   is kSF transmitter shaping and receiver filtering dependent
 FREQDEV3                                               0x020
                                                                   constant. It is usually around ksf ≅ 0.8
   Enabling this feature (FREQDEVx 0 0) can lead the             offset estimator is close to the correct offset (i.e.
frequency offset estimator to lock at the wrong offset. It is    FREQDEV0 = 0).
therefore recommended to enable it only after the frequency
FOURFSK0, FOURFSK1, FOURFSK2, FOURFSK3
 Table 123. FOURFSK0, FOURFSK1, FOURFSK2, FOURFSK3
            Name                 Bits       R/W         Reset                                   Description
 DEVDECAY0                       3:0        RW           0110     Deviation Decay
 DEVDECAY1                                               1000
 DEVDECAY2                                               1010
 DEVDECAY3                                               1010
 DEVUPDATE0                       4         RW             1      Enable Deviation Update
 DEVUPDATE1
 DEVUPDATE2
 DEVUPDATE3
                                                     www.onsemi.com
                                                              58
                                                          AND9347/D
                                                                     DCLK
                                                                   PWRUP
                                                                     DATA       M0       L0      M1       L1      M2       L2
                                                                            Figure 22. Wiremode Timing Diagram
                                                                     Wiremode is also available in 4−FSK mode, see Figure 22.
                                                                  The two bits that encode one symbol are serialized on the
           Figure 21. 4−FSK Frequency Diagram                     DATA pin. The PWRUP pin can be used as a
                                                                  synchronisation pin to allow symbol (dibit) boundaries to be
   In 4−FSK mode, two bits are transmitted together during        reconstructed. DCLK is approximately but not exactly
each symbol, by using four frequencies instead of two.            square. Gray encoding is used to reduce the number of bit
Figure 21 depicts the frequencies used.                           errors in case of a wrong decision. The two bits encode the
                                                                  following frequencies:
 Table 124. 4−FSK BIT TO FREQUENCY MAPPING
                    Mx                                         Lx                                     Frequency
                     0                                         0                               fCARRIER * 3 V fDEVIATION
                     0                                         1                                 fCARRIER * fDEVIATION
                     1                                         1                                 fCARRIER + fDEVIATION
                     1                                         0                               fCARRIER + 3 V fDEVIATION
   In framing mode, unless ENC NOSYNC in the                      boundaries. The shift register shifts right, so the bits end up
ENCODING register is set, the shift register is synchronized      in the FIFO word as follows:
to the dibit boundaries, and the pattern matches only at dibit
 Table 125.
        7               6                5              4              3               2                1                0
       Ln+3           Mn+3             Ln+2           Mn+2            Ln+1           Mn+1               Ln               Mn
   In 4−FSK mode, it is no longer sufficient to compare the       mode can be selected, but if the frequency deviation of the
actual frequency with the center frequency and just record        transmitter is exactly known at the receiver, manual mode
the sign. The frequency deviation of the transmitter must be      can result in slightly better performance.
known in order to choose the correct decision thresholds.            In automatic mode, FSKDMAX1, FSKDMAX0,
This is the purpose of the FSKDMAX1, FSKDMAX0,                    FSKDMIN1 and FSKDMIN0 record the maximal and the
FSKDMIN1 and FSKDMIN0 registers. These registers can              minimal frequency seen at the receiver. “Leakage” or
either be set manually or recover the frequency deviation         “gravity to zero” is added such that if these registers are
automatically. DEVUPDATE selects automatic mode if set            disturbed by noise spikes, the effect decays. The amount of
to one, and manual mode if set to zero. Normally, automatic       leakage is controlled by DEVDECAY.
 Table 126. AMOUNT OF LEAKAGE
               Bits                          Meaning
               0000                              0
               0001                              1
               0010                              2
               0011                              5
               0100                             11
               0101                             22
               0110                             44
                                                      www.onsemi.com
                                                               59
                                                          AND9347/D
 Table 126. AMOUNT OF LEAKAGE (continued)
               0111                              88
               1000                              177
               1001                              355
               1010                              709
               1011                             1419
               1100                             2839
               1101                             5678
               1110                            11356
               1111                            22713
BBOFFSRES0, BBOFFSRES1, BBOFFSRES2, BBOFFSRES3
 Table 127. BBOFFSRES0, BBOFFSRES1, BBOFFSRES2, BBOFFSRES3
             Name                 Bits        R/W         Reset                           Description
 RESINTA0                         3:0         RW           1000    Baseband Gain Block A Offset Compensation Resistors
 RESINTA1
 RESINTA2
 RESINTA3
 RESINTB0                         7:4         RW           1000    Baseband Gain Block B Offset Compensation Resistors
 RESINTB1
 RESINTB2
 RESINTB3
Transmitter Parameters
MODCFGF
   This register selects the frequency shaping mode of the
transmitter.
 Table 128. MODCFGF
             Name                 Bits        R/W         Reset                           Description
 FREQSHAPE                        1:0         RW            00     See Table129: FREQSHAPE Bit Value
 Table 129. FREQSHAPE BIT VALUES
         Bits                           Meaning
          01                             Invalid
          00                       External Loop Filter
          10                        Gaussian BT = 0.3
          11                        Gaussian BT = 0.5
FSKDEV2, FSKDEV1, FSKDEV0
 Table 130. FSKDEV2, FSKDEV1, FSKDEV0
             Name                 Bits        R/W          Reset                          Description
 FSKDEV                           23:0         RW        0x000A3D  (G)FSK Frequency
                                                                   Deviation; FSKDEV +  ƪp DEVIATION
                                                                                            p XTAL
                                                                                                      2 24 )
                                                                                                             1
                                                                                                             2
                                                                                                               ƫ
                                                        www.onsemi.com
                                                                60
                                                           AND9347/D
   Note that fDEV IATION is actually half the deviation. The               In AFSK mode, the register has a slightly different
mark frequency is
fCARRIER + fDEVIATION, the space frequency is fCARRIER − fDEV          definition: FSKDEV +        ƪ 0.858785     p DEVIATION
                                                                                                              p XTAL
                                                                                                                                2 24 )
                                                                                                                                       1
                                                                                                                                       2
                                                                                                                                         ƫ
IATION.                                                                    In FM mode, the register has a different definition. It
               h                                                       defines the conditioning of the ADC values prior to applying
p DEVIATION  +    BITRATE
               2
                                                                       them to the transmit amplitude or the frequency deviation.
 Table 131. FMSHIFT, FMINPUT, FMSEXT, FMOFFS
             Name             Bits    R/W      Reset                                      Description
           FMSHIFT            2:0     RW        101         These Bits Scale the ADC Value, See Table 132
           FMINPUT            9:8     RW         10         Input Selection, See Table 133
           FMSEXT              14     RW         0          ADC Sign Extension
           FMOFFS              15     RW         0          ADC Offset Subtract
 Table 132. FMSHIFT BIT VALUES                                           Table 133. FMINPUT BIT VALUES
         Bits                         Meaning                                     Bits                              Meaning
          000                             ) ADCFS      p XTAL                      00                              GPADC13
                      FM: p DEVIATION +
                                                 2 15                              01                               GPADC1
          001                             ) ADCFS      p XTAL                      10                               GPADC2
                      FM: p DEVIATION +           2 14                             11                               GPADC3
          010                             ) ADCFS      p XTAL
                      FM: p DEVIATION +
                                                  2 13
                                                                       MODCFGA
          011                             ) ADCFS      p XTAL              This register selects the amplitude shaping mode of the
                      FM: p DEVIATION +
                                                  2 12                 transmitter. Amplitude shaping is used even for constant
          100                             ) ADCFS      p XTAL          modulus modulation such as FSK, to ramp up and down the
                      FM: p DEVIATION +           2 11                 transmitter at the beginning and the end of the transmission.
          101                             ) ADCFS      p XTAL
                      FM: p DEVIATION +           2 10
          110                             ) ADCFS      p XTAL
                      FM: p DEVIATION +           29
          111                             ) ADCFS      p XTAL
                      FM: p DEVIATION +
                                                  28
 Table 134. MODCFGA
             Name                 Bits       R/W            Reset                                     Description
 TXDIFF                             0         RW              1         Enable Differential Transmitter
 TXSE                               1         RW              0         Enable Single Ended Transmitter
 AMPLSHAPE                          2         RW              1         See Table 135
 SLOWRAMP                          5:4        RW              00        See Table136
 PTTLCK GATE                        6         RW              0         If 1, disable transmitter if PLL looses lock
 BROWN GATE                         7         RW              0         If 1, disable transmitter if Brown Out is detected
 Table 135. AMPLSHAPE BIT VALUES                                         Table 136. SLOWRAMP BIT VALUES
         Bits                         Meaning                                     Bits                              Meaning
           0                          Unshaped                                     00                     Normal Startup (1 Bit Time)
           1                       Raised Cosine                                   01                          2 Bit Time Startup
                                                                                   10                          4 Bit Time Startup
                                                                                   11                          8 Bit Time Startup
                                                        www.onsemi.com
                                                                  61
                                                              AND9347/D
   If BROWN GATE is set, the transmitter is disabled                   In order for this to work, the user must read the
whenever one (or more) of the SSVIO, SSBEVMODEM or                     POWSTICKYSTAT after setting the PWRMODE register
SSBEVANA bits of the POWSTICKYSTAT register is zero.                   for transmission.
TXRATE2, TXRATE1, TXRATE0
 Table 137. TXRATE2, TXRATE1, TXRATE0
             Name                        Bits         R/W      Reset                              Description
 TXRATE                                  23:0         RW     0x0028F6
                                                                        Transmit Bitrate, TXRATE +   ƪ BITRATE
                                                                                                         p XTAL
                                                                                                                  2 24 )
                                                                                                                         1
                                                                                                                         2
                                                                                                                           ƫ
                                                     p XTAL
   In asynchronous wire mode,           BITRATE t
                                                         32
TXPWRCOEFFA1, TXPWRCOEFFA0
 Table 138. TXPWRCOEFFA1, TXPWRCOEFFA0
             Name                        Bits         R/W      Reset                              Description
 TXPWRCOEFFA                             15:0         RW      0x0000
                                                                        Transmit Predistortion, TXPWRCOEFFA + a 0 ƪ       2 12 )
                                                                                                                                  1
                                                                                                                                  2
                                                                                                                                    ƫ
   See TXPWRCOEFFB0 for an explanation.
TXPWRCOEFFB1, TXPWRCOEFFB0
 Table 139. TXPWRCOEFFB1, TXPWRCOEFFB0
             Name                        Bits         R/W      Reset                              Description
 TXPWRCOEFFB                             15:0         RW      0x0FFF
                                                                        Transmit Predistortion, TXPWRCOEFFB + a 1ƪ       2 12 )
                                                                                                                                 1
                                                                                                                                 2
                                                                                                                                   ƫ
   The transmit predistortion circuit applies the following            (0 means no output power, 1 means maximum output
function to the output of the raised cosine amplitude                  power).
shaping:                                                                 For conventional (non-predistorted output), α0 = α2 = α3
p(x) + a 4 @ x 4 ) a 3 @ x 3 ) a 2 @ x 2 ) a 1 @ x ) a 0               = α4 = 0 and 0 ≤ α1 ≤ 1 controls the output power. If hard
x is the input from the raised cosine shaping circuit                  amplitude shaping is selected, both the raised cosine
(0 ≤ x ≤ 1), and the output f(x) drives the power amplifier            amplitude shaper and the predistortion is bypassed, and α1
                                                                       used.
TXPWRCOEFFC1, TXPWRCOEFFC0
 Table 140. TXPWRCOEFFC1, TXPWRCOEFFC0
             Name                        Bits         R/W      Reset                              Description
 TXPWRCOEFFC                             15:0         RW      0x0000
                                                                        Transmit Predistortion, TXPWRCOEFFB + a 2ƪ       2 12 )
                                                                                                                                 1
                                                                                                                                 2
                                                                                                                                   ƫ
   See TXPWRCOEFFB0 for an explanation.
TXPWRCOEFFD1, TXPWRCOEFFD0
 Table 141. TXPWRCOEFFD1, TXPWRCOEFFD0
             Name                        Bits         R/W      Reset                              Description
 TXPWRCOEFFD                             15:0         RW      0x0000
                                                                        Transmit Predistortion,TXPWRCOEFFB + a 3ƪ       2 12 )
                                                                                                                                1
                                                                                                                                2
                                                                                                                                  ƫ
   See TXPWRCOEFFB0 for an explanation.
                                                            www.onsemi.com
                                                                    62
                                                  AND9347/D
TXPWRCOEFFE1, TXPWRCOEFFE0
 Table 142. TXPWRCOEFFE1, TXPWRCOEFFE0
           Name            Bits        R/W         Reset                                 Description
 TXPWRCOEFFE               15:0        RW         0x0000
                                                             Transmit Predistortion, TXPWRCOEFFB + a 4    ƪ       2 12 )
                                                                                                                         1
                                                                                                                         2
                                                                                                                           ƫ
  See TXPWRCOEFFB0 for an explanation.
PLL Parameters
PLLVCOI
 Table 143. PLLVCOI
           Name            Bits       R/W          Reset                                Description
 VCOI                      5:0         RW         010010    This field sets the bias current for both VCOs. The increment is
                                                            50 μA for VCO1 and 10 μA for VCO2.
 VCOIE                      7          RW            0      Enable manual VCOI
PLLVCOIR
 Table 144. PLLVCOIR
           Name            Bits       R/W          Reset                                Description
 VCOIR                     5:0          R            −      This field reflects the actual VCO current selected. If VCOIE
                                                            (Register PLLVCOI) is selected, this field reads the same as
                                                            VCOI (also Register PLLVCOI). Otherwise, the value reflects the
                                                            automatic setting.
PLLLOCKDET
 Table 145. PLLLOCKDET
           Name            Bits       R/W          Reset                                Description
 LOCKDETDLY                1:0         RW           11      See Table 146: LOCKDETDLY Bit Values
 LOCKDETDLYM                2          RW            0      0 = Automatic Lock Delay (determined by the currently active
                                                            frequency register);
                                                            1 = Manual Lock Delay (Bits LOCKDETDLY)
 LOCKDETDLYR               7:6          R            −      Lock Detect Read Back (not valid in power down mode)
 Table 146. LOCKDETDLY BIT VALUES
        Bits                     Meaning
         00               Lock Detector Delay 6ns
         01               Lock Detector Delay 9ns
         10              Lock Detector Delay 12ns
         11              Lock Detector Delay 14ns
PLLRNGCLK
 Table 147. PLLRNGCLK
           Name            Bits       R/W          Reset                                Description
 PLLRNGCLK                 2:0         RW           011     See Table 148: PLLRNGCLK Bit Values
                                                www.onsemi.com
                                                         63
                                                       AND9347/D
 Table 148. PLLRNGCLK BIT VALUES
        Bits                     Meaning                          fPLLRNG should be less than one tenth of the loop filter
        000                                      p XTAL
                                                                bandwidth, to allow enough settling time.
                   PLL Ranging Clock: p PLLRNG +   28
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG +    29
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG +   28
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG + 2 11
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG + 2 12
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG + 2 13
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG + 2 14
        000                                      p XTAL
                   PLL Ranging Clock: p PLLRNG + 2 15
Crystal Oscillator
XTALCAP
 Table 149. XTALCAP
            Name             Bits          R/W         Reset                             Description
 XTALCAP                      7:0          RW        00000000    Load Capacitance Configuration, See Table 150
 Table 150. LOCKDETDLY BIT VALUES
        Bits                     Meaning                          For values XTALCAP(5:0) ≠ 0, CL = 8 pF + 0.5 pF ⋅
      000000                       3 pF
                                                                XTALCAP (5:0).
      000001                      8.5 pF
      000010                       9 pF
         ...                          ...
      110111                      36 pF
         ...                          ...
       111111                     40 pF
Baseband
BBTUNE
 Table 151. BBTUNE
            Name             Bits          R/W         Reset                             Description
 BBTUNE                       3:0          RW          1001      Baseband Tuning Value
 BBTUNERUN                     4           RW            0       Baseband Tuning Start
BBOFFSCAP
 Table 152. BBOFFSCAP
            Name             Bits          R/W         Reset                             Description
 CAPINTA                      2:0          RW           111      Baseband Gain Block A Offset Compensation Capacitors
 CAPINTB                      6:4          RW           111      Baseband Gain Block B Offset Compensation Capacitors
                                                    www.onsemi.com
                                                             64
                                                             AND9347/D
Packet Format
PKTADDRCFG
 Table 153. PKTADDRCFG
             Name                    Bits        R/W         Reset                                 Description
 ADDR POS                            3:0         RW           0000     Position of the address bytes
 FEC SYNC DIS                         5          RW             1      When set, disable FEC sync search during packet reception
 CRC SKIP FIRST                       6          RW             0      When set, the first byte of the packet is not included in the CRC
                                                                       calculation
 MSB FIRST                            7          RW             0      When set, each byte is sent MSB first; when cleared, each byte
                                                                       is sent LSB first
PKTLENCFG
 Table 154. PKTLENCFG
             Name                    Bits        R/W         Reset                                 Description
 LEN POS                             3:0         RW           0000     Position of the length byte
 LEN BITS                            7:4         RW           0000     Number of significant bits in the length byte
  The built-in packet length logic can support up to 255 byte         • Register PKTLENCFG LEN BITS (bits 7:4) = 1111
packets. It is still possible to receive larger packets if packet     • Register PKTMAXLEN = 0xFF
length and, unless using HDLC, CRC is handled in the
                                                                      • Register PKTACCEPTFLAGS ACCPT LRGP (bit 5)
microprocessor firmware. In order to enable reception of
                                                                          =1
arbitrary length packets, the following settings must be
made:
PKTLENOFFSET
 Table 155. PKTLENOFFSET
             Name                    Bits        R/W         Reset                                 Description
 LEN OFFSET                          7:0         RW           0x00     Packet Length Offset
  The receiver adds LEN OFFSET to the length byte. The                    Mode specific Framing        0x03    B1      B2      B3    CRC
value of (length byte + LEN OFFSET) counts every byte in
the packet after the synchronization pattern, up to and                  With PKTLENCFG = 0x00 and PKTLENOFFSET =
excluding the CRC bytes, but including the length byte.               0x03 the receiver will correctly receive the following packet
  For example with PKTLENCFG = 0x80 and                               without length byte
PKTLENOFFSET = 0x00 the receiver will correctly receive                     Mode specific Framing           B1       B2      B3      CRC
the following packet (b1, b2 and b3 being data bytes).
                                                                         The length offset is treated as a signed value; LEN
   Mode specific Framing       0x04     B1    B2     B3    CRC
                                                                      OFFSET 0xff means the length offset is −1.
  With PKTLENCFG = 0x80 and PKTLENOFFSET =
0x01 the receiver will correctly receive the following packet
PKTMAXLEN
 Table 156. PKTMAXLEN
             Name                    Bits        R/W          Reset                                Description
 MAX LEN                              7:0        RW           0x00      Packet Maximum Length
PKTADDR3, PKTADDR2, PKTADDR1, PKTADDR0
 Table 157. PKTADDR3, PKTADDR2, PKTADDR1, PKTADDR0
             Name                    Bits        R/W          Reset                                Description
 ADDR                                31:0        RW        0x00000000   Packet Address
                                                           www.onsemi.com
                                                                   65
                                           AND9347/D
PKTADDRMASK3, PKTADDRMASK2, PKTADDRMASK1, PKTADDRMASK0
 Table 158. PKTADDRMASK3, PKTADDRMASK2, PKTADDRMASK1, PKTADDRMASK0
           Name           Bits     R/W      Reset                                Description
 ADDRMASK                 31:0     RW    0x00000000   Packet Address Mask
Pattern Match
MATCH0PAT3, MATCH0PAT2, MATCH0PAT1, MATCH0PAT0
 Table 159. MATCH0PAT3, MATCH0PAT2, MATCH0PAT1, MATCH0PAT0
           Name           Bits     R/W      Reset                                Description
 MATCH0PAT                31:0     RW    0x00000000   Pattern for Match Unit 0; LSB is received first; patterns of length
                                                      less than 32 must be MSB aligned
MATCH0LEN
 Table 160. MATCH0LEN
           Name           Bits     R/W      Reset                                Description
 MATCH0LEN                 4:0     RW       00000     Pattern Length for Match Unit 0; The length in bits of the pattern
                                                      is MATCH0LEN + 1
 MATCH0RAW                  7      RW         0       Select whether Match Unit 0 operates on decoded (after
                                                      Manchester, Descrambler etc.) (if 0), or on raw received bits (if
                                                      1)
MATCH0MIN
 Table 161. MATCH0MIN
           Name           Bits     R/W      Reset                                Description
 MATCH0MIN                 4:0     RW       00000     A match is signalled if the received bitstream matches the
                                                      pattern in less than MATCH0MIN positions. This can be used to
                                                      detect inverted sequences.
MATCH0MAX
 Table 162. MATCH0MAX
           Name           Bits     R/W      Reset                                Description
 MATCH0MAX                 4:0     RW       11111     A match is signalled if the received bitstream matches the
                                                      pattern in more than MATCH0MAX positions.
MATCH1PAT1, MATCH1PAT0
 Table 163. MATCH1PAT1, MATCH1PAT0
           Name           Bits     R/W      Reset                                Description
 MATCH1PAT                15:0     RW      0x0000     Pattern for Match Unit 1; LSB is received first; patterns of length
                                                      less than 16 must be MSB aligned
MATCH1LEN
 Table 164. MATCH1LEN
          Name            Bits     R/W     Reset                                 Description
 MATCH1LEN                 3:0     RW       0000     Pattern Length for Match Unit 1; The length in bits of the pattern
                                                     is MATCH1LEN + 1
 MATCH1RAW                  7      RW         0      Select whether Match Unit 1 operates on decoded (after
                                                     Manchester, Descrambler etc.) (if 0), or on raw received bits (if
                                                     1)
                                         www.onsemi.com
                                                  66
                                             AND9347/D
MATCH1MIN
 Table 165. MATCH1MIN
          Name             Bits     R/W      Reset                                Description
 MATCH1MIN                  3:0     RW       0000     A match is signalled if the received bitstream matches the
                                                      pattern in less than MATCH1MIN positions. This can be used to
                                                      detect inverted sequences.
MATCH1MAX
 Table 166. MATCH1MAX
          Name             Bits     R/W      Reset                                Description
 MATCH1MAX                  3:0     RW        1111    A match is signalled if the received bitstream matches the
                                                      pattern in more than MATCH1MAX positions.
Packet Controller
TMGTXBOOST
 Table 167. TMGTXBOOST
          Name             Bits     R/W      Reset                                Description
 TMGTXBOOSTM                4:0     RW       10010    Transmit PLL Boost Time Mantissa
 TMGTXBOOSTE                7:5     RW        001     Transmit PLL Boost Time Exponent
  The Transmit PLL Boost Time is TMGTXBOOSTM ⋅
2TMGTXBOOSTE μs.
TMGTXSETTLE
 Table 168. TMGTXSETTLE
          Name             Bits     R/W      Reset                                Description
 TMGTXSETTLEM               4:0     RW       01010    Transmit PLL (post Boost) Settling Time Mantissa
 TMGTXSETTLEE               7:5     RW        000     Transmit PLL (post Boost) Settling Time Exponent
  The Transmit PLL (post Boost) Settling Time is
TMGTXSETTLEM ⋅ 2TMGTXSETTLEE μs.
TMGRXBOOST
 Table 169. TMGRXBOOST
          Name             Bits     R/W      Reset                                Description
 TMGRXBOOSTM                4:0     RW       10010    Receive PLL Boost Time Mantissa
 TMGRXBOOSTE                7:5     RW        001     Receive PLL Boost Time Exponent
  The Receive PLL Boost Time is TMGRXBOOSTM ⋅
2TMGRXBOOSTE μs.
TMGRXSETTLE
 Table 170. TMGRXSETTLE
          Name             Bits     R/W      Reset                                Description
 TMGRXSETTLEM               4:0     RW       10100    Receive PLL (post Boost) Settling Time Mantissa
 TMGRXSETTLEE               7:5     RW        000     Receive PLL (post Boost) Settling Time Exponent
  The Receive PLL (post Boost) Settling Time is
TMGRXSETTLEM ⋅ 2TMGRXSETTLEE μs.
                                           www.onsemi.com
                                                   67
                                                      AND9347/D
TMGRXOFFSACQ
 Table 171. TMGRXOFFSACQ
          Name                 Bits       R/W          Reset                              Description
 TMGRXOFFSACQM                  4:0       RW           10011     Baseband DC Offset Acquisiton Time Mantissa
 TMGRXOFFSACQE                  7:5       RW            011      Baseband DC Offset Acquisiton Time Exponent
  The Baseband DC Offset Acquisition Time is
TMGRXOFFSACQM ⋅ 2TMGRXOFFSACQE μs.
TMGRXCOARSEAGC
 Table 172. TMGRXCOARSEAGC
          Name                 Bits       R/W          Reset                              Description
 TMGRXCOARSEAGCM                4:0       RW           11001     Receive Coarse AGC Time Mantissa
 TMGRXCOARSEAGCE                7:5       RW            001      Receive Coarse AGC Time Exponent
  The     Receive      Coarse       AGC       Time       is
TMGRXCOARSEAGCM ⋅ 2TMGRXCOARSEAGCE μs.
TMGRXAGC
 Table 173. TMGRXAGC
          Name                 Bits       R/W          Reset                              Description
 TMGRXAGCM                      4:0       RW           00000     Receiver AGC Settling Time Mantissa
 TMGRXAGCE                      7:5       RW            000      Receiver AGC Settling Time Exponent
  The Receiver AGC Settling Time is TMGRXAGCM ⋅                 determined by bit           RXAGC      CLK   in register
2TMGRXAGCE. Whether this time is measured in Bits or μs is      PKTMISCFLAGS.
TMGRXRSSI
 Table 174. TMGRXRSSI
          Name                 Bits       R/W          Reset                              Description
 TMGRXRSSIM                     4:0       RW           00000     Receiver RSSI Settling Time Mantissa
 TMGRXRSSIE                     7:5       RW            000      Receiver RSSI Settling Time Exponent
  The Receiver RSSI Settling Time is TMGRXRSSIM ⋅               determined by bit           RXRSSI     CLK   in register
2TMGRXRSSIE. Whether this time is measured in Bits or μs is     PKTMISCFLAGS.
TMGRXPREAMBLE1
 Table 175. TMGRXPREAMBLE1
          Name                 Bits       R/W          Reset                              Description
 TMGRXPREAMBLE1M                4:0       RW           00000     Receiver Preamble 1 Timeout Mantissa
 TMGRXPREAMBLE1E                7:5       RW            000      Receiver Preamble 1 Timeout Exponent
  The     Receiver     Preamble      1     Timeout       is
TMGRXPREAMBLE1M ⋅ 2TMGRXPREAMBLE1E Bits.
                                                    www.onsemi.com
                                                             68
                                                         AND9347/D
TMGRXPREAMBLE2
 Table 176. TMGRXPREAMBLE2
             Name                 Bits         R/W       Reset                             Description
 TMGRXPREAMBLE2M                  4:0          RW        00000     Receiver Preamble 2 Timeout Mantissa
 TMGRXPREAMBLE2E                  7:5          RW         000      Receiver Preamble 2 Timeout Exponent
   The      Receiver      Preamble       2      Timeout    is
TMGRXPREAMBLE2M ⋅ 2TMGRXPREAMBLE2E Bits.
TMGRXPREAMBLE3
 Table 177. TMGRXPREAMBLE3
             Name                 Bits         R/W       Reset                             Description
 TMGRXPREAMBLE3M                  4:0          RW        00000     Receiver Preamble 3 Timeout Mantissa
 TMGRXPREAMBLE3E                  7:5          RW         000      Receiver Preamble 3 Timeout Exponent
   The      Receiver      Preamble       3      Timeout    is
TMGRXPREAMBLE3M ⋅ 2TMGRXPREAMBLE3E Bits.
RSSIREFERENCE
 Table 178. RSSIREFERENCE
             Name                 Bits         R/W       Reset                             Description
 RSSIREFERENCE                    7:0          RW         0x00     RSSI Offset
   This register adds a constant offset to the computed RSSI
value. It is used to compensate for board effects.
RSSIABSTHR
 Table 179. RSSIABSTHR
             Name                 Bits         R/W       Reset                             Description
 RSSIABSTHR                       7:0          RW         0x00     RSSI Absolute Threshold
   RSSI levels above this threshold indicate a busy channel.
BGNDRSSIGAIN
 Table 180. BGNDRSSIGAIN
             Name                 Bits         R/W       Reset                             Description
 BGNDRSSIGAIN                     3:0          RW        0000      Background RSSI Averaging Time Constant
   The background RSSI estimate BGNDRSSI is updated                 The update is performed as follows:
after antenna RSSI measurement. Antenna RSSI                      BGNDRSSI = BGNDRSSI + (RSSI − BGNDRSSI) ⋅
measurement is performed in state RSSI in the Receiver            2−BGNDRSSIGAIN
Timing Diagram Figure 12. The background RSSI estimate
is updated only once if antenna selection is performed.
BGNDRSSITHR
 Table 181. BGNDRSSITHR
             Name                 Bits         R/W       Reset                             Description
 BGNDRSSITHR                      5:0          RW       000000     Background RSSI Relative Threshold
                                                       www.onsemi.com
                                                               69
                                                AND9347/D
  RSSI levels more than BGNDRSSITHR above the
background RSSI level indicate a busy channel.
PKTCHUNKSIZE
 Table 182. PKTCHUNKSIZE
            Name              Bits         R/W   Reset                                  Description
 PKTCHUNKSIZE                  3:0         RW    0000      Maximum Packet Chunk Size, See Table 183
 Table 183. PKTCHUNKSIZE BIT VALUES
        Bits                      Meaning                     The PKTCHUNKSIZE limits the maximum chunk size in
       0000                        invalid
                                                          the FIFO. This number includes the flags byte and all data
                                                          bytes, but not the chunk header and the chunk length byte.
       0001                           1
                                                          Packets larger than PKTCHUNKSIZE - 1 are split into
       0010                           2                   multiple chunks.
       0011                           4
       0100                           8
       0101                          16
       0110                          32
       0111                          64
       1000                          96
       1001                          128
       1010                          160
       1011                          192
       1100                          224
       1101                          240
       1110                        invalid
        1111                       invalid
PKTMISCFLAGS
 Table 184. PKTMISCFLAGS
            Name              Bits         R/W   Reset                                  Description
 RXRSSI CLK                     0          RW      0       Clock source for RSSI settling timeout: 0 = 1 μs, 1 = Bit clock
 RXAGC CLK                      1          RW      0       Clock source for AGC settling timeout: 0 = 1 μs, 1 = Bit clock
 BGND RSSI                      2          RW      0       If 1, enable the calculation of the background noise/RSSI level
 AGC SETTL DET                  3          RW      0       If 1, if AGC settling is detected, terminate settling before timeout
 WOR MULTI PKT                  4          RW      0       If 1, the receiver continues to be on after a packet is received in
                                                           wake-on-radio mode; otherwise, it is shut down
PKTSTOREFLAGS
 Table 185. PKTSTOREFLAGS
            Name              Bits         R/W   Reset                                  Description
 ST TIMER                       0          RW      0       Store Timer value when a delimiter is detected
 ST FOFFS                       1          RW      0       Store Frequency offset at end of packet
 ST RFOFFS                      2          RW      0       Store RF Frequency offset at end of packet
 ST DR                          3          RW      0       Store Datarate offset at end of packet
 ST RSSI                        4          RW      0       Store RSSI at end of packet
                                               www.onsemi.com
                                                       70
                                                      AND9347/D
 Table 185. PKTSTOREFLAGS (continued)
          Name                   Bits     R/W         Reset                              Description
 ST CRCB                          5       RW            0      Store CRC Bytes. Normally, CRC bytes are discarded after
                                                               checking. In HDLC [1] mode, CRC bytes are always stored,
                                                               regardless of this bit.
 ST ANT RSSI                      6       RW            0      Store RSSI and Background Noise Estimate at antenna
                                                               selection time
PKTACCEPTFLAGS
 Table 186. PKTACCEPTFLAGS
          Name                   Bits     R/W         Reset                              Description
 ACCPT RESIDUE                    0       RW            0      Accept Packets with a nonintegral number of Bytes (HDLC [1]
                                                               only)
 ACCPT ABRT                       1       RW            0      Accept aborted Packets
 ACCPT CRCF                       2       RW            0      Accept Packets that fail CRC check
 ACCPT ADDRF                      3       RW            0      Accept Packets that fail Address check
 ACCPT SZF                        4       RW            0      Accept Packets that are too long
 ACCPT LRGP                       5       RW            0      Accept Packets that span multiple FIFO chunks
General Purpose ADC
GPADCCTRL
 Table 187. GPADCCTRL
          Name                   Bits     R/W         Reset                              Description
 CH ISOL                          0       RW            0      Isolate Channels by sampling common mode between channels
 CONT                             1       RW            0      Enable Continuous Sampling (period according to
                                                               GPADCPERIOD)
 GPADC13                          2       RW            0      Enable Sampling GPADC1−GPADC3
 BUSY                             7       RS            0      Conversion ongoing when 1; when writing 1, a single conversion
                                                               is started
GPADCPERIOD
 Table 188. GPADCPERIOD
          Name                   Bits     R/W         Reset                              Description
 GPADCPERIOD                     7:0      RW         00111111  GPADC Sampling Period,
                                                                                 p XTAL
                                                                 p SR +
                                                                         32   GPADCPERIOD
GPADC13VALUE1, GPADC13VALUE0
 Table 189. GPADC13VALUE1, GPADC13VALUE0
          Name                   Bits     R/W         Reset                              Description
 GPADC13VALUE                    9:0       R            −      GPADC13 Value
                                                        −
  Reading this register clears the GPADC Interrupt.
                                                    www.onsemi.com
                                                            71
                                                           AND9347/D
Low Power Oscillator Calibration
LPOSCCONFIG
 Table 190. LPOSCCONFIG
            Name                  Bits        R/W          Reset                                Description
 LPOSC ENA                         0          RW             0       Enable the Low Power Oscillator. If 0, it is disabled.
 LPOSC FAST                        1          RW             0       Select the Frequency of the Low Power Oscillator. 0 = 640 Hz,
                                                                     1 = 10.24 kHz
 LPOSC IRQR                        2          RW             0       Enable LP Oscillator Interrupt on the Rising Edge
 LPOSC IRQF                        3          RW             0       Enable LP Oscillator Interrupt on the Falling Edge
 LPOSC CALIBF                      4          RW             0       Enable LP Oscillator Calibration on the Falling Edge
 LPOSC CALIBR                      5          RW             0       Enable LP Oscillator Calibration on the Rising Edge
 LPOSC OSC DOUBLE                  6          RW             0       Enable LP Oscillator Calibration Reference Oscillator Doubling
 LPOSC OSC INVERT                  7          RW             0       Invert LP Oscillator Clock
LPOSCSTATUS
 Table 191. LPOSCSTATUS
            Name                  Bits        R/W          Reset                                Description
 LPOSC EDGE                        0            R            −       Enabled Low Power Oscillator Edge detected
 LPOSC IRQ                         1            R            −       Low Power Oscillator Interrupt Active
   The EDGE and IRQ flags can be cleared by reading either
the LPOSCCONFIG, LPOSCSTATUS, LPOSCPER1 or
LPOSCPER0 register.
LPOSCKFILT1, LPOSCKFILT0
 Table 192. LPOSCKFILT1, LPOSCKFILT0
            Name                  Bits         R/W          Reset                               Description
 LPOSCKFILT                       15:0         RW          0x20C4     kFILT (Low Power Oscillator Calibration Filter Constant)
   The maximum value of kFILT, that results in quickest                Smaller values of kFILT result in longer calibration, but
calibration (single cycle), but no jitter suppression, is:          increased jitter suppression.
k FILT + ƪ21333Hz
              p XTAL
                     2 20 ƫ
LPOSCREF1, LPOSCREF0
 Table 193. LPOSCREF1, LPOSCREF0
            Name                  Bits         R/W          Reset                               Description
 LPOSCREF                         15:0         RW          0x61A8                                                           p XTAL
                                                                      LP Oscillator Reference Frequency Divider; set to
                                                                                                                            640Hz
LPOSCFREQ1, LPOSCFREQ0
 Table 194. LPOSCFREQ1, LPOSCFREQ0
            Name                  Bits        R/W          Reset                                Description
 LPOSCFREQ                        9:-2        RW           0x000     LP Oscillator Frequency Tune Value; in 1/32 %.
LPOSCPER1, LPOSCPER0
 Table 195. LPOSCPER1, LPOSCPER0
            Name                  Bits         R/W          Reset                               Description
 LPOSCPER                         15:0          R             −       Last measured LP Oscillator Period
                                                        www.onsemi.com
                                                                 72
                                                        AND9347/D
DAC
DACVALUE1, DACVALUE0
 Table 196. DACVALUE1, DACVALUE0
            Name            Bits          R/W            Reset                                  Description
 DACVALUE                   11:0           RW            0x000      DAC Value (signed) (if DACINPUT = 0000)
 DACSHIFT                    3:0           RW             0x0       DAC Input Shift (if DACINPUT ! = 0000)
DACCONFIG
 Table 197. DACCONFIG
            Name            Bits          R/W           Reset                                   Description
 DACINPUT                    3:0          RW             0000       DAC Input Multiplexer, See Table 198
 DACCLKX2                     6           RW               0        Enable DAC Clock Doubler if set to 1
 DACPWM                       7           RW               0        Select PWM mode if 1, otherwise ΣΔ mode
 Table 198. DACINPUT BIT VALUES
        Bits                    Meaning                               Note that in ΣΔ mode, the output range is limited to the
       0000                   DACVALUER
                                                                   range 1⁄4...3⁄4 ⋅ VDDIO, to ensure modulator stability. The
                                                                   input value −211 results in 1⁄4 ⋅ VDDIO, the input value 211 −
       0001                TRKAMPLITUDE
                                                                   1 results in 3⁄4 ⋅ VDDIO. In PWM mode, the output voltage
       0010               TRKRFFREQUENCY                           range is 0...VDDIO.
       0011                TRKFREQUENCY
                                                                   Performance Tuning Registers
       0100                   FSKDEMOD
                                                                      Registers with Addresses from 0xF00 to 0xFFF are
       0101                  AFSKDEMOD                             performance tuning registers. Their optimum values are
       0110                  RXSOFTDATA                            computed by AX_RadioLab; this section only gives a rough
       0111                        RSSI                            overview of how they should be set. Do not read or write
       1000                 SAMPLE_ROT_I                           addresses not listed in the table below.
       1001                SAMPLE_ROT_Q
       1100                     GPADC13
       1101                       invalid
       1110                       invalid
        1111                      invalid
 Table 199. REGISTER MAP
    Addr         RX/TX                                                    Description
     F00         RX/TX    Set to 0x0F
     F0C         RX/TX    Keep the default 0x00
     F0D         RX/TX    Set to 0x03
     F10         RX/TX    Set to 0x04 if a TCXO is used. If a crystal is used, set to 0x0D if the reference frequency (crystal or
                          TCXO) is more than 43 MHz, or to 0x03 otherwise
     F11         RX/TX    Set to 0x07 if a crystal is connected to CLK16P/CLK16N, or 0x00 if a TCXO is used
     F1C         RX/TX    Set to 0x07
     F21          RX      Set to 0x5C
     F22          RX      Set to 0x53
     F23          RX      Set to 0x76
     F26          RX      Set to 0x92
                                                      www.onsemi.com
                                                              73
                                                     AND9347/D
Table 199. REGISTER MAP (continued)
   Addr         RX/TX                                                  Description
    F30          RX     This register should be reset between WOR wake-ups. The reset value is the value read after
                        successful packet reception or 0x3F if no packet has been received yet.
    F31          RX     This register should be reset between WOR wake-ups. The reset value is the value read after
                        successful packet reception or 0xF0 if no packet has been received yet.
    F32          RX     This register should be reset between WOR wake-ups. The reset value is the value read after
                        successful packet reception or 0x3F if no packet has been received yet.
    F33          RX     This register should be reset between WOR wake-ups. The reset value is the value read after
                        successful packet reception or 0xF0 if no packet has been received yet.
    F34        RX/TX    Set to 0x28 if RFDIV in register PLLVCODIV is set, or to 0x08 otherwise
    F35        RX/TX    Set to 0x10 for reference frequencies (crystal or TCXO) less than 24.8 MHz (fXTALDIV = 1), or to 0x11
                        otherwise (fXTALDIV = 2)
    F44        RX/TX    Set to 0x24
    F72          RX     Set to 0x06 if the framing mode is set to “Raw, Soft Bits” (register FRAMING), or to 0x00 otherwise
                                                  www.onsemi.com
                                                           74
                                                                                        AND9347/D
REFERENCES
[1] Wikipedia. High-Level Data Link Control. see http://en.wikipedia.org/wiki/HDLC.
[2] ON Semiconductor. AX5043 Datasheet. see http://www.onsemi.com
[3] Ross N. Williams. A Painless Guide to CRC Error Detection Algorithms. http://www.ross.net/crc/download/crc_v3.txt
   ON Semiconductor and            are trademarks of Semiconductor Components Industries, LLC dba ON Semiconductor or its subsidiaries in the United States and/or other countries.
   ON Semiconductor owns the rights to a number of patents, trademarks, copyrights, trade secrets, and other intellectual property. A listing of ON Semiconductor’s product/patent
   coverage may be accessed at www.onsemi.com/site/pdf/Patent−Marking.pdf. ON Semiconductor reserves the right to make changes without further notice to any products herein.
   ON Semiconductor makes no warranty, representation or guarantee regarding the suitability of its products for any particular purpose, nor does ON Semiconductor assume any liability
   arising out of the application or use of any product or circuit, and specifically disclaims any and all liability, including without limitation special, consequential or incidental damages.
   Buyer is responsible for its products and applications using ON Semiconductor products, including compliance with all laws, regulations and safety requirements or standards,
   regardless of any support or applications information provided by ON Semiconductor. “Typical” parameters which may be provided in ON Semiconductor data sheets and/or
   specifications can and do vary in different applications and actual performance may vary over time. All operating parameters, including “Typicals” must be validated for each customer
   application by customer’s technical experts. ON Semiconductor does not convey any license under its patent rights nor the rights of others. ON Semiconductor products are not
   designed, intended, or authorized for use as a critical component in life support systems or any FDA Class 3 medical devices or medical devices with a same or similar classification
   in a foreign jurisdiction or any devices intended for implantation in the human body. Should Buyer purchase or use ON Semiconductor products for any such unintended or unauthorized
   application, Buyer shall indemnify and hold ON Semiconductor and its officers, employees, subsidiaries, affiliates, and distributors harmless against all claims, costs, damages, and
   expenses, and reasonable attorney fees arising out of, directly or indirectly, any claim of personal injury or death associated with such unintended or unauthorized use, even if such
   claim alleges that ON Semiconductor was negligent regarding the design or manufacture of the part. ON Semiconductor is an Equal Opportunity/Affirmative Action Employer. This
   literature is subject to all applicable copyright laws and is not for resale in any manner.
PUBLICATION ORDERING INFORMATION
 LITERATURE FULFILLMENT:                                                     N. American Technical Support: 800−282−9855 Toll Free               ON Semiconductor Website: www.onsemi.com
  Literature Distribution Center for ON Semiconductor                         USA/Canada
  19521 E. 32nd Pkwy, Aurora, Colorado 80011 USA                             Europe, Middle East and Africa Technical Support:                   Order Literature: http://www.onsemi.com/orderlit
  Phone: 303−675−2175 or 800−344−3860 Toll Free USA/Canada                    Phone: 421 33 790 2910
  Fax: 303−675−2176 or 800−344−3867 Toll Free USA/Canada                     Japan Customer Focus Center                                         For additional information, please contact your local
  Email: orderlit@onsemi.com                                                  Phone: 81−3−5817−1050                                              Sales Representative
  ◊                                                                                 www.onsemi.com                                                                                AND9347/D
                                                                                                75
